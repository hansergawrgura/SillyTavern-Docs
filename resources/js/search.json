[[{"l":"\uD83C\uDF7B 什么是 SillyTavern？","p":["SillyTavern - 面向高阶用户的LLM前端界面","SillyTavern（简称 ST）是一款本地安装的用户界面，可让您与文本生成大语言模型（LLM）、图像生成引擎及 TTS 语音模型互动。我们的目标是为用户提供强大的功能和对 LLM 提示词的极致控制，将陡峭的学习曲线视为乐趣的一部分。","SillyTavern 是由热情的 LLM 爱好者社区倾心打造的项目，永远免费开源。自 2023 年 2 月从 TavernAI 1.2.8 分叉而来，SillyTavern 现已汇聚 200 多位贡献者，历经 2 年独立开发，持续为资深 AI 爱好者提供领先软件体验。"]},{"l":"界面预览 \uD83D\uDDBC️","p":["API 连接","聊天界面","高级格式化","世界背景设定"]},{"l":"安装要求 ⚙️","p":["硬件要求极低：可运行 NodeJS 18 及以上版本的设备皆可。若需本地运行 LLM 推理，推荐使用显存至少 6GB 的英伟达 3000 系列显卡。","按平台查看安装指南：","Windows\uD83E\uDE9F","Linux 和 Mac\uD83D\uDC27\uD83C\uDF4E","Android\uD83E\uDD16","Docker\uD83D\uDC33"]},{"l":"分支说明 \uD83C\uDF3F","p":["SillyTavern 采用双分支开发模式，确保所有用户获得流畅体验。","release- \uD83C\uDF1F 推荐大多数用户使用。 最稳定的推荐分支，仅在有重大发布时更新。适合绝大多数用户。通常每月更新一次。","staging- ⚠️ 不推荐日常使用。 此分支包含最新功能，但请注意它可能随时出现故障。仅面向高阶用户和爱好者。每日更新数次。"]},{"l":"还需准备什么？ \uD83D\uDD0C","p":["SillyTavern 仅是一个界面，您需要接入一个 LLM 后端来提供推理能力。您可使用 AI Horde 实现开箱即用的聊天体验。此外，我们还支持许多其他本地及云端 LLM 后端：OpenAI 兼容 API、KoboldAI、Tabby 等。更多支持的 API 请参阅 API 连接 章节。"]},{"l":"角色卡片 \uD83C\uDCCF","p":["SillyTavern 围绕“角色卡片”概念构建。角色卡片是一组设定 LLM 行为的提示词集合，是在 SillyTavern 中进行持续性对话所必需的。其功能类似于 ChatGPT 的 GPTs 或 Poe 的 bots。角色卡片的内容可以是任何事物：抽象场景、为特定任务定制的助手、名人或虚构角色。","若想快速对话而无需选择角色卡片，或仅测试 LLM 连接，只需在打开 SillyTavern 后的 欢迎屏幕 上的输入栏中输入您的提示词。这将创建一个空的“助手”角色卡片，您之后可进行自定义。","要了解如何定义角色卡片，可参考默认角色 (Seraphina) 或从“下载扩展与资源”菜单中获取精选的社区制作卡片。","您也可以从头创建自己的角色卡片。更多信息请参阅 角色设计 指南。"]},{"l":"核心特性 ✨","p":["高级 文本生成设置，包含众多社区制作的预设","世界背景信息支持：创建丰富的背景故事或为角色卡片节省 Token","群聊功能：多机器人房间，让角色与您和/或彼此交谈","丰富的 UI 自定义选项：主题颜色、背景图像、自定义 CSS 等","用户人设：让 AI 了解您的一些信息以增强沉浸感","内置 RAG 支持：向聊天中添加文档供 AI 参考","广泛的 聊天命令 子系统及自有 脚本引擎"]},{"l":"扩展功能 \uD83D\uDD0C","p":["SillyTavern 支持功能扩展。","角色情绪表情（立绘）","聊天历史自动摘要","自动 UI 及 聊天翻译","Stable Diffusion/FLUX/DALL-E 图像生成","AI 回复消息的文本转语音（通过 ElevenLabs、Silero 或操作系统系统 TTS）","网络搜索功能，为您的提示词添加额外真实世界上下文","更多扩展可从“下载扩展与资源”菜单中获取。"]},{"l":"如何直接联系开发者？ \uD83D\uDCDE","p":["Discord: cohee, rossascends, wolfsblvt","Reddit: /u/RossAscends, /u/sillylossy, u/Wolfsblvt","提交 GitHub Issue"]},{"l":"我喜欢你们的项目！如何贡献？ \uD83E\uDD1D","p":["我们欢迎 Pull Requests！请遵循 贡献指南 开始贡献。","我们也欢迎使用 GitHub 提供模板的有益且详实的错误报告。","我们不接受针对项目本身的货币捐赠。"]},{"l":"个人捐赠 \uD83D\uDE4F","p":["感谢您对个人贡献者的支持，但这不会影响 SillyTavern 的整体开发方向。","RossAscends 拥有个人 Patreon 和 Kofi 页面。"]},{"l":"许可证 \uD83D\uDCC4","p":["SillyTavern 是一个免费开源项目，基于 AGPL-3.0 许可证 发布。"]}],[{"l":"\uD83D\uDCE6 安装指南","p":["请根据您的平台选择对应的安装指南：","\uD83E\uDE9F Windows 系统","\uD83D\uDC27 Linux 和 \uD83C\uDF4E macOS 系统","\uD83D\uDCF1 Android 系统","\uD83D\uDC33 Docker 容器"]},{"l":"\uD83C\uDF3F 分支说明","p":["SillyTavern 采用双分支开发模式，确保所有用户都能获得流畅的使用体验。","release- \uD83C\uDF1F 推荐大多数用户使用。最稳定的推荐分支，仅在重大发布时更新。适合绝大多数用户。通常每月更新一次。","staging- ⚠️ 不推荐日常使用。此分支包含最新功能，但请注意可能随时出现故障。仅适合高级用户和爱好者。每日更新多次。"]},{"l":"\uD83C\uDF0D 全局模式 / 独立模式","p":["SillyTavern 有两种运行模式，区别在于配置和数据路径的处理方式：","独立模式（默认）- 使用服务器目录中的 config.yaml 文件和 data 目录。所有数据将限制在安装路径内。推荐大多数用户使用此模式。","全局模式- 使用系统范围的配置和数据路径。适用于将 SillyTavern 作为软件包安装，或希望在多个安装间共享相同配置和数据的情况。","使用 官方 npm 包（例如 npx sillytavern@latest）进行的安装默认使用全局模式。"]},{"l":"数据路径说明","p":["独立模式 路径相对于 SillyTavern 安装目录：","配置路径: ./config.yaml","数据根目录: ./data/","全局模式 路径取决于操作系统：","Linux: ~/.local/share/SillyTavern/config.yaml（或 $XDG_DATA_HOME/SillyTavern/config.yaml）和 ~/.local/share/SillyTavern/data/（或 $XDG_DATA_HOME/SillyTavern/data/）","Windows: %APPDATA%\\SillyTavern\\config.yaml 和 %APPDATA%\\SillyTavern\\data\\","macOS: ~/Library/Application Support/SillyTavern/config.yaml 和 ~/Library/Application Support/SillyTavern/data/"]},{"l":"如何运行全局模式","p":["在全局模式下运行时，无法通过 CLI 参数 或 config.yaml 覆盖 dataRoot 和 configPath。","向服务器启动命令传递 --global 参数（例如 node server.js --global）","向 shell 启动脚本传递 --global 参数（例如 Start.bat --global 或 ./start.sh --global）","使用 package.json 文件中的 start:global 脚本（例如 npm run start:global）"]}],[{"l":"\uD83E\uDE9F Windows 系统安装指南","p":["请勿安装在任何受 Windows 保护的文件夹内（如 Program Files、System32 等）","切勿使用管理员权限运行 Start.bat","Windows 7 无法运行 NodeJS 18.16，故不支持安装"]},{"l":"\uD83D\uDCE6 通过 Git 安装","p":["安装 NodeJS（推荐最新 LTS 版本）","安装 Git for Windows","打开文件资源管理器（ Win+E）","浏览或创建一个不受 Windows 管控的文件夹（例如： C:\\MySpecialFolder\\)","点击顶部地址栏，输入 cmd 并按回车，在该文件夹内打开命令提示符","在命令提示符窗口中输入以下命令之一并按回车：","发布分支： git clone https://github.com/SillyTavern/SillyTavern -b release","开发分支： git clone https://github.com/SillyTavern/SillyTavern -b staging","克隆完成后，双击 Start.bat，NodeJS 将自动安装依赖","服务器启动后，SillyTavern 将在浏览器中打开"]},{"l":"\uD83D\uDE80 通过启动器安装","p":["按下 Win + R 打开运行对话框，执行以下命令安装 Git：","按下 Win + E 打开文件资源管理器，进入目标安装文件夹，在地址栏输入 cmd 并按回车，然后执行："]},{"l":"\uD83D\uDDA5️ 通过 GitHub Desktop 安装","p":["（此方法仅限在 GitHub Desktop 中使用 Git。如需在命令行使用 Git，仍需安装 Git for Windows）","安装 NodeJS（推荐最新 LTS 版本）","安装 GitHub Desktop","安装后点击 Clone a repository from the internet...（无需 GitHub 账户） 步骤1","选择 URL 标签页，输入 https://github.com/SillyTavern/SillyTavern 并点击 Clone。可修改本地路径调整安装位置 步骤2","通过文件资源管理器进入克隆的仓库目录（默认路径： C:\\Users\\[用户名]\\Documents\\GitHub\\SillyTavern）","双击 Start.bat 文件（若系统隐藏扩展名，则显示为\"Start\"） 步骤3","命令提示符窗口将打开并自动安装依赖","安装完成后，命令窗口将显示如下界面，浏览器自动打开 SillyTavern： 步骤4","连接任意 支持的 API 即可开始聊天！"]}],[{"l":"\uD83D\uDC27 Linux & \uD83C\uDF4E macOS 安装指南"},{"l":"\uD83D\uDCE6 手动 Git 安装","p":["以下操作均需在终端中完成（\uD83C\uDF4E macOS / \uD83D\uDC27 Linux 系统）。","安装 git 和 NodeJS（安装方法因操作系统而异）","克隆代码库：","发布分支： git clone https://github.com/SillyTavern/SillyTavern -b release","开发分支： git clone https://github.com/SillyTavern/SillyTavern -b staging","使用 cd SillyTavern 进入安装目录","通过以下任一命令运行 start.sh 脚本：","./start.sh","bash start.sh"]},{"l":"\uD83D\uDE80 SillyTavern 启动器安装"},{"l":"\uD83D\uDC27 Linux 用户","p":["打开终端并安装 git","下载启动器： git clone https://github.com/SillyTavern/SillyTavern-Launcher.git","进入目录： cd SillyTavern-Launcher","运行安装脚本： chmod +x install.sh ./install.sh 并选择需要安装的内容","安装完成后启动： chmod +x launcher.sh ./launcher.sh"]},{"l":"\uD83C\uDF4E macOS 用户","p":["打开终端，通过以下命令安装 Homebrew：/bin/bash -c $(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)","安装 git： brew install git","下载启动器： git clone https://github.com/SillyTavern/SillyTavern-Launcher.git","进入目录： cd SillyTavern-Launcher","运行安装脚本： chmod +x install.sh ./install.sh 并选择需要安装的内容","安装完成后启动： chmod +x launcher.sh ./launcher.sh"]}],[{"l":"\uD83D\uDCF1 Android (Termux) 安装指南","p":["SillyTavern 可通过 Termux 在 Android 设备上原生运行。"]},{"l":"\uD83D\uDD27 安装 Termux","p":["请避免从 Google Play 商店安装 Termux，该版本已停止维护。 建议从 F-Droid（推荐）或 GitHub releases 获取最新版本。","从 F-Droid 或 GitHub releases 下载 Termux","安装下载的 APK 文件","打开 Termux 并运行第一条命令：","选择「Mirror group」并选择最近的服务器。可通过触摸屏幕或使用 Unexpected Keyboard 的手势操作","更新 Termux："]},{"l":"\uD83D\uDCE6 安装依赖项","p":["安装所需软件包：","若您运行的是 32 位 Android 系统，请参阅下方的 常见错误 章节获取额外步骤。"]},{"l":"\uD83D\uDE80 安装 SillyTavern","p":["克隆 SillyTavern 代码库（ 如何选择分支）：","发布分支：","开发分支："]},{"l":"⚡ 运行 SillyTavern","p":["运行 SillyTavern 请进入克隆目录并执行启动脚本：","更新 SillyTavern 请进入目录并执行：","可参阅下方的 别名设置 章节创建快捷命令简化此过程。"]},{"l":"❌ 常见错误"},{"l":"平台不支持：android arm LEtime-web","p":["32 位 Android 系统需要无法通过 npm 安装的外部依赖。","使用以下命令安装：","然后继续执行上述安装步骤。"]},{"l":"\uD83C\uDFAF 可选：创建别名","p":["您可为常用命令创建快捷方式以简化操作流程。","打开编辑器修改 .bashrc 文件：","添加以下行创建别名：","保存文件并退出编辑器（在 nano 中按 CTRL + X，然后按 Y，最后按 Enter）","运行以下命令使更改生效：","现在您可以使用以下命令：","st 启动 SillyTavern","stup 更新 SillyTavern","pkgup 更新 Termux 软件包"]},{"l":"\uD83D\uDCDA 扩展阅读","p":["以下指南并非由 SillyTavern 团队维护。","ArroganceComplex#2659 提供的 Termux 使用指南： https://rentry.org/STAI-Termux","使用 Material Files 访问 Termux 文件： https://www.learntermux.tech/2020/10/Termux-File-Manager.html","防止 Termux 进程深度休眠： https://wiki.termux.com/wiki/Termux-wake-lock"]}],[{"l":"\uD83D\uDC33 Docker 安装指南","p":["本指南假设您已安装 Docker，能够通过命令行安装容器，并熟悉其基本操作。"]},{"l":"\uD83D\uDCE5 使用 GitHub 容器镜像库","p":["使用预构建镜像是通过 Docker 运行 SillyTavern 最快捷简便的方式。您可以从 GitHub 容器镜像库拉取最新镜像。"]},{"l":"Docker Compose（推荐方式）","p":["从 GitHub 代码库 下载 docker-compose.yml 文件，并在该文件所在目录运行以下命令。这将从 GitHub 容器镜像库拉取最新的发布版本镜像并启动容器，自动创建必要的卷。","您可以编辑该文件并根据需求进行自定义配置：","默认端口为 8000，可通过修改 ports 部分更改","如需使用开发分支而非稳定版，可将 image 标签改为 staging","如需通过环境变量调整服务器配置，请查阅 环境变量 页面"]},{"l":"Docker CLI（高级用法）","p":["您需要两个必需的目录映射和一个端口映射才能使 SillyTavern 正常运行。在命令中替换以下位置的内容："]},{"l":"容器变量"},{"l":"卷映射","p":["CONFIG_PATH- SillyTavern 配置文件在主机上的存储目录","DATA_PATH- SillyTavern 用户数据（包括角色）在主机上的存储目录","PLUGINS_PATH- （可选）SillyTavern 服务器插件在主机上的存储目录","EXTENSIONS_PATH- （可选）全局 UI 扩展在主机上的存储目录"]},{"l":"端口映射","p":["PUBLIC_PORT- 对外暴露流量的端口。此为必需项，因为您需要从虚拟机容器外部访问实例。在没有实施额外安全服务的情况下，请勿将此端口暴露给互联网。"]},{"l":"附加设置","p":["SILLYTAVERN_VERSION- 在本 GitHub 页面右侧可以看到 \"Packages\"。选择 \"sillytavern\" 包即可查看镜像版本。\"latest\" 镜像标签将保持与当前发布版本同步。您也可以使用 \"staging\" 标签指向相应分支的每日构建镜像。"]},{"l":"运行容器","p":["打开命令行","在要存储配置和数据文件的文件夹中运行以下命令：","默认情况下容器将在前台运行。如需在后台运行，请在 docker run 命令中添加 -d 标志。"]},{"l":"\uD83D\uDD28 构建 Docker 镜像","p":["以下部分假设您在非 root（非管理员）文件夹中安装了 SillyTavern。如果在 root 文件夹中安装，可能需要使用管理员权限运行部分命令 [sudo, doas, 命令提示符（管理员）]。","如需自行构建 Docker 镜像，可按照以下步骤操作。这对于自定义镜像或用于开发目的非常有用。"]},{"l":"\uD83D\uDC27 Linux 系统","p":["Arch Linux (Manjaro/EndeavourOS 等)","Debian (Ubuntu/Pop! OS 等)","Fedora, Red Hat Enterprise Linux (RHEL) 等","享受吧！:D","使用 sudo 打开 nano 并运行以下命令","使用包管理器安装 Git","克隆 SillyTavern 代码库","发布版（稳定分支）","在 127.0.0.1 下方添加新行，并输入从 Docker 复制的 IP。完成后应类似以下内容","在 Docker 文件夹内运行以下命令执行 docker compose","在 nano 中，转到 whitelist。您应该看到类似以下内容","复制 Gateway 中看到的 IP，这很重要","开发版（开发分支）","您应该会收到类似以下的输出","打开新浏览器并访问 http://localhost:8000。片刻后应能看到 SillyTavern 加载","执行以下 Docker 命令获取 SillyTavern Docker 容器的 IP","按 Ctrl+S 保存文件，然后按 Ctrl+X 退出 nano","按照 Docker 安装后指南 中的「以非 root 用户身份管理 Docker」步骤操作","按照 Docker 安装指南 此处 安装 Docker","请勿 安装 Docker Desktop。","请注意，如果将 Docker 网络配置为网桥模式，也可以像往常一样将外部 IP 地址添加到白名单中。","重启 Docker 容器以应用新配置"]},{"l":"\uD83E\uDE9F Windows 系统","p":["享受吧！:D","以管理员权限运行 Notepad 或您选择的代码编辑器，转到 config 并打开 config.yaml","克隆 SillyTavern 代码库","发布版（稳定分支）","在 127.0.0.1 下方添加新行，并输入从 Docker 复制的 IP。完成后应类似以下内容","在 Docker 文件夹内运行以下命令执行 docker compose","在 Windows 上使用 Docker ** 非常** 复杂。不仅需要在「启用或关闭 Windows 功能」中激活 Windows Subsystem for Linux，还要为虚拟化（Intel VT-d/AMD SVM）配置系统，这因 PC 制造商（或主板制造商）而异。有时此选项在某些系统上不可用。","在您选择的编辑器中，应该看到类似以下内容","复制 Gateway 中看到的 IP，这很重要","安装 Git for Windows","开发版（开发分支）","强烈建议按照我们的 Windows 指南安装 SillyTavern。本节仅是在 Windows 上实现的_粗略_思路。","您应该会收到类似以下的输出","打开新浏览器并访问 http://localhost:8000。片刻后应能看到 SillyTavern 加载","执行以下 Docker 命令获取 SillyTavern Docker 容器的 IP","按 Ctrl+S 保存文件，然后退出编辑器","按照 Docker 安装指南 此处 安装 Docker Desktop","请注意，如果将 Docker 网络配置为网桥模式，也可以像往常一样将外部 IP 地址添加到白名单中。","重启 Docker 容器以应用新配置"]},{"l":"\uD83C\uDF4E macOS 系统","p":["享受吧！:D","使用 Homebrew 安装 git","使用 sudo 打开 nano 并运行以下命令","克隆 SillyTavern 代码库","发布版（稳定分支）","在 127.0.0.1 下方添加新行，并输入从 Docker 复制的 IP。完成后应类似以下内容","在 Docker 文件夹内运行以下命令执行 docker compose","在 nano 中，转到 whitelist。您应该看到类似以下内容","复制 Gateway 中看到的 IP，这很重要","如果无法运行 nano，可通过 Homebrew 安装或使用 TextEdit。","尽管 macOS 与 Linux 类似，但它没有 Docker Engine。您需要像 Windows 一样安装 Docker Desktop。 您还需要安装 Homebrew 才能在 Mac 上安装 Git。本节是在 macOS 上实现的_粗略_思路。","开发版（开发分支）","您应该会收到类似以下的输出","打开新浏览器并访问 http://localhost:8000。片刻后应能看到 SillyTavern 加载","执行以下 Docker 命令获取 SillyTavern Docker 容器的 IP","按 Ctrl+S 保存文件，然后按 Ctrl+X 退出 nano","按照 Docker 安装指南 此处 安装 Docker Desktop","请注意，如果将 Docker 网络配置为网桥模式，也可以像往常一样将外部 IP 地址添加到白名单中。","重启 Docker 容器以应用新配置"]},{"l":"⚙️ 配置 SillyTavern","p":["SillyTavern 的配置文件 (config.yaml) 位于 config 文件夹内。配置该文件与在没有 Docker 的情况下配置应该没有区别，但是您需要以管理员权限运行 nano 或代码编辑器才能保存更改。","不要忘记重启 SillyTavern 的 Docker 容器以应用更改！请确保在 docker 文件夹内执行此命令。"]},{"l":"\uD83D\uDCC1 定位用户数据","p":["SillyTavern 的数据文件夹位于 data 文件夹内。备份文件应该很容易，但是，恢复或向其中添加内容可能需要以管理员权限操作。"]},{"l":"\uD83D\uDD0C 运行服务器插件","p":["在 Docker 中运行像 HoYoWiki-Scraper-TS 或 SillyTavern-Fandom-Scraper 这样的插件与在没有 Docker 的系统上运行没有区别，但是我们需要对 Docker Compose 脚本进行轻微修改才能实现。","如果已在 docker 文件夹内看到 plugins 文件夹，可以跳过步骤 1-2。","使用 nano 或代码编辑器，打开 docker-compose.yml 并在 volumes 下方添加以下行","在 docker 文件夹内创建一个名为 plugins 的新文件夹","按照插件说明安装插件","使用具有管理员权限的 nano 或代码编辑器，打开 config.yaml（在 config 文件夹内）并启用 enableServerPlugins","重启 Docker 容器","完成"]},{"l":"❗ Docker 常见问题"},{"l":"挂载卷的 SELinux 权限问题","p":["启用 SELinux 的 Linux 发行版（如 RHEL、CentOS、Fedora 等）可能会阻止 Docker 容器访问挂载的卷，这是由于安全策略的限制。当容器尝试读取或写入挂载目录时，可能会导致权限被拒绝错误。","可以添加后缀 :z 或 :Z 到卷挂载。这些后缀告诉 Docker 重新标记共享卷上的文件对象。","z 选项用于卷内容将在容器之间共享的情况","Z 选项用于卷内容应仅由当前容器使用的情况","示例："]}],[{"l":"\uD83D\uDD04 如何更新 SillyTavern","p":["请根据您的操作系统选择对应的更新指南。","本指南假设您已至少安装并运行过一次 SillyTavern。"]},{"l":"\uD83D\uDC27 Linux/Termux 或 \uD83C\uDF4E macOS 系统","p":["您肯定是通过 git 安装的，只需在 SillyTavern 目录中执行 'git pull' 即可。","cd SillyTavern 进入正确的文件夹","git pull 获取更新","./start.sh 或 bash start.sh 启动 ST"]},{"l":"\uD83E\uDE9F Windows 系统","p":["首先尝试使用位于 SillyTavern 安装基础文件夹中的 UpdateAndStart.bat","如果失败，请回到此处继续阅读。"]},{"l":"方法 1 - GIT 方式","p":["我们始终推荐用户使用 'git' 安装。原因如下：","当您通过 git clone 安装时，要更新只需在 ST 文件夹的命令行中 输入 git pull。 或者，如果命令提示符出现问题（且您已安装 GitHub Desktop），可以使用 Repository 菜单并选择 Pull。","更新会自动安全地应用。"]},{"l":"\"求助：我最初通过 Zip 安装，现在想转换为 Git 安装\"","p":["您选择了明智的道路。","由于您的安装是通过 Zip 完成的，您需要使用 git 进行全新安装。","幸运的是，我们提供了 操作说明。","一旦您使用 git 将新的 SillyTavern 安装到不同的文件夹中，请回到本页面并继续执行下面「Zip 更新」说明中的 第 4 步。"]},{"l":"方法 2 - ZIP 方式","p":["(*) '根据需要' = \"如果您创建了与这些文件夹相关的任何自定义内容\"","1.12.0 包含自动迁移程序。仅当迁移被中断或出错时才需要执行以下步骤。","下载新的发布版 zip 文件","再次使用适用于您操作系统的方法启动 SillyTavern，并祈祷您做对了","复制这些文件夹/文件后，将它们粘贴到新安装的 /data/default-user 文件夹中（secrets.json 放在文件夹根目录中）","如果一切正常显示，您可以安全地删除旧的 ST 文件夹","如果您坚持通过 zip 安装，以下是繁琐的更新过程：","将 /data 目录和 config.yaml 文件从一个安装复制到另一个安装","将其解压到当前 ST 安装之外的文件夹中","所有文件夹都不是必需的，因此只需复制您需要的内容","按照您操作系统的常规设置程序安装 NodeJS 要求","根据需要(*)从旧的 ST 安装中复制以下文件/文件夹：","根据需要将文件从旧的 /public 转移到新的 /data/default-user","注意：不要复制整个 /PUBLIC/ 文件夹","至少运行一次更新后的服务器安装，以创建 /data/default-user 目录","这样做可能会破坏新安装并阻止新功能的出现"]},{"l":"常见更新问题"},{"l":"\"工作目录中存在未解决的冲突\"","p":["这意味着您修改了远程仓库中已更改的默认文件（例如设置预设）。","要解决此问题，请在终端中运行此命令。请谨慎使用，因为它可能具有破坏性。如果需要，请确保有备份。"]},{"l":"文件更改阻止 git pull","p":["如果您更改了 SillyTavern 系统文件， git pull 可能无法工作","有时更新可能需要我们更改重要文件，这可能导致相同的问题","通常是默认预设文件或 package-lock.json","在这种情况下，您可以尝试将文件移动到其他文件夹（或删除文件），然后执行 git pull","另一种解决方案是使用 git pull --rebase --autostash"]},{"l":"启动服务器时出现错误：Cannot find module \"***\"","p":["这意味着 SillyTavern 添加了新的 npm 包要求","在 SillyTavern 目录中运行 npm install 来修复此问题。提供的 Start.bat 和 start.sh 脚本会自动执行此操作","没有帮助？删除 node_modules 文件夹","Windows 系统","Unix/Linux 系统"]},{"l":"\uD83D\uDC33 Docker 方式","p":["打开终端窗口并导航到您的 docker 目录 cd SillyTavern/docker","使用 docker compose down 删除您的容器","从缓存中删除 SillyTavern docker 镜像 docker rmi ghcr.io/sillytavern/sillytavern:latest（如果您的目标是 staging 分支，请将 sillytavern:latest 替换为 sillytavern:staging）","使用 sudo docker compose up -d 重新构建容器","如果一切顺利，docker 应该开始重新下载镜像，您很快就会启动并运行。如果遇到任何问题，请参阅本指南的下一部分。"]},{"i":"常见更新问题-1","l":"常见更新问题"},{"l":"我使用 Docker，更新后所有数据都消失了！","p":["您必须遵循 Docker 容器的迁移指南 来更新 1.12.0 中引入的新数据模型的卷映射"]},{"l":"运行 docker 命令时权限被拒绝","p":["这是 Linux 问题，意味着您的权限设置不正确。有两种解决方法：","简单方法：如果您的用户具有 sudo 访问权限，只需在命令前加上 sudo（例如： sudo docker compose down）","正确方法：修复您的权限。这取决于您使用的 Linux 版本。网上有很多指南可以帮助您解决此问题"]}],[{"l":"\uD83D\uDE80 1.12.0 迁移指南","p":["SillyTavern 1.12.0（代号「Neo Server」更新）包含多项重要变更，可能影响您的使用体验。","本指南将帮助您做好准备，并提供详细操作说明。"]},{"l":"\uD83D\uDCE6 数据存储更新","p":["1.12.0 版本改变了用户数据的处理方式。","此前，所有持久化数据都与前端文件一同存储在 /public 目录中，这导致了混淆和潜在的故障点，同时也使容器化和系统级应用安装变得复杂。"]},{"l":"变更内容","p":["所有来自 /public 的持久化信息（完整列表见下文）现已移至可配置路径的独立目录，使其可移植且独立于 Web 服务器本身。为兼容性考虑（例如托管扩展、完整角色卡、用户图片上传等），已设置智能重定向，自动从数据目录提供用户文件。"]},{"l":"设置数据根目录","p":["您可以通过 config.yaml 或启动服务器时使用 --dataRoot 控制台参数，指定数据根目录的绝对路径或相对路径（相对于 ST 代码库目录）。","YAML 示例","控制台示例","默认数据根目录路径为 ./data，即 SillyTavern 代码库中的 data 目录。","数据根目录路径应为 完整绝对路径 或 完整相对路径。不能使用 ~ 或 %APP_DATA% 等路径快捷方式，因为这些由 shell 解析，而非操作系统。"]},{"l":"迁移操作"},{"l":"⚠️ 重要！开始前的准备","p":["仅当需要从默认位置移动 dataRoot 时执行此步骤，否则请跳过。 在首次运行更新后的服务器之前设置数据根目录。运行 npm install 以使 config.yaml 填充新值，或传递控制台参数。","所有数据将迁移至 default-user 账户。详见下文 用户管理 部分。"]},{"l":"无容器（裸机）安装","p":["您无需任何操作！当 ST 服务器检测到旧存储格式（通过检查 /public/characters 目录是否存在）时，自动迁移将处理所有事宜。","移动任何文件前，系统会在 /backups/_migration/YYYY-MM-DD（解析为当前日期）目录中创建自动备份，但在运行迁移前手动完整备份仍是良好实践。"]},{"l":"容器化（Docker）安装","p":["迁移 Docker 卷中的数据稍复杂但操作直接。虽然代码库提供的 docker-compose.yml 已更新以反映变更，但您可能需要调整自定义工作流/部署。","步骤 1. 创建新卷，并将其挂载到容器内的 \"/home/node/app/data\" 路径。不要移除 config 卷。","步骤 2. 将 config 卷中除 config.yaml 文件外的所有内容移至 data 卷的 default-user 子目录。","步骤 3. 重新构建容器并启动。","不再需要 /public 目录与 config 卷之间的软链接，Docker 容器中也不再构建此链接！"]},{"l":"需要迁移哪些内容？","p":["/data/default-user/assets","/data/default-user/backgrounds","/data/default-user/characters","/data/default-user/chats","/data/default-user/content.log","/data/default-user/context","/data/default-user/extensions","/data/default-user/group chats","/data/default-user/groups","/data/default-user/instruct","/data/default-user/KoboldAI Settings","/data/default-user/movingUI","/data/default-user/NovelAI Settings","/data/default-user/OpenAI Settings","/data/default-user/QuickReplies","/data/default-user/secrets.json","/data/default-user/settings.json","/data/default-user/stats.json","/data/default-user/TextGen Settings","/data/default-user/themes","/data/default-user/thumbnails","/data/default-user/vectors","/data/default-user/worlds","/default/content/content.log","/public/assets","/public/backgrounds","/public/characters","/public/chats","/public/context","/public/group chats","/public/groups","/public/instruct","/public/KoboldAI Settings","/public/movingUI","/public/NovelAI Settings","/public/OpenAI Settings","/public/QuickReplies","/public/scripts/extensions/third-party","/public/settings.json","/public/stats.json","/public/TextGen Settings","/public/themes","/public/worlds","/secrets.json","/thumbnails","/vectors","以下文件和目录属于数据迁移范围。假设为默认配置，下表中提供了迁移前后的路径对照。","迁移前路径","迁移后路径"]},{"l":"\uD83D\uDC65 用户管理","p":["1.12.0 新增了（完全可选的）在同一服务器上创建多用户设置的功能，允许多个用户使用自己完全隔离的 SillyTavern 实例，甚至可以同时使用。用户账户还可设置密码保护，增加隐私层。","更多信息请参阅 用户管理 文档。"]}],[{"l":"\uD83D\uDE80 1.9.0 迁移指南"},{"l":"如何迁移到新分支（如果您当前使用 main/dev 分支）？","p":["推荐进行全新安装。 但如果您希望使用现有的 SillyTavern 副本，请按照以下说明操作。","重要提示！ 在进行任何操作前，请对您的安装目录进行 完整备份。在此过程中您可能 丢失数据，请勿忽略此警告。","不确定需要备份哪些文件？请参阅： 如何更新 SillyTavern"]},{"l":"Git 安装方式","p":["在您的 SillyTavern 安装文件夹中打开终端（cmd、PowerShell、Termux 等）","输入 git fetch，然后输入 git pull 拉取更新","您可能会丢失设置。是否已进行备份？使用 git switch release 或 git switch staging 可分别切换分支","如果没有错误，请跳至下一步。您可能会遇到类似如下错误：","您将看到受影响的文件列表。如果您不介意这些设置文件被替换，可使用 git switch -f release 或 git switch -f staging 强制设置分支 如果您希望保留这些更改，请从备份中恢复","输入 npm install，然后输入 npm run start 测试一切是否正常运行","完成！如有需要，请从备份恢复数据"]},{"l":"错误提示：fatal: invalid reference: release","p":["如果您之前从旧远程仓库（迁移到组织仓库之前）仅克隆了单个分支，可能会出现此问题。修复方法是从新远程添加并获取分支：","然后从第 5 步继续操作。"]},{"l":"ZIP 压缩包安装方式","p":["对您来说没有任何变化。只需像往常一样下载分支/发布版本的 ZIP 包即可。"]}],[{"l":"\uD83D\uDD04 如何更新 Node.js","p":["为确保安全性和性能，及时更新 Node.js 运行时十分重要。以下是根据操作系统更新 Node.js 的步骤指南。","我们推荐使用最新的长期支持（LTS）版本，您可以在 Node.js 官方网站 上找到相关信息。"]},{"l":"\uD83D\uDD0D 如何检查当前 Node.js 版本","p":["打开终端或命令提示符","输入以下命令并按回车："]},{"l":"\uD83D\uDD04 nvm（Node 版本管理器）- 跨平台方法","p":["如果您使用 nvm：","打开终端","输入以下命令：","Unix/Linux/macOS 系统：","Windows 系统："]},{"l":"\uD83E\uDE9F Windows 系统 - 常规安装方法","p":["访问 Node.js 下载页面","下载 LTS 版本的 Windows 安装程序","运行安装程序并按提示完成安装"]},{"l":"\uD83E\uDE9F Windows 系统 - SillyTavern 启动器","p":["如果您使用 SillyTavern 启动器安装：","打开 SillyTavern 启动器","导航至 工具箱 / 应用安装器 / 核心工具 / 安装 Node.js","或者：","在 PowerShell 中使用 winget 手动安装："]},{"l":"\uD83D\uDCF1 Android 系统 - Termux","p":["打开 Termux 应用","输入以下命令：","更新过程中出现提示时，别忘了按虚拟键盘上的 Y 键确认。"]},{"l":"\uD83C\uDF4E macOS 系统 - 常规安装方法","p":["访问 Node.js 下载页面","下载 LTS 版本的 macOS 安装程序","运行 .pkg 文件并按提示完成安装"]},{"l":"\uD83C\uDF4E macOS 系统 - Homebrew","p":["如果您已安装 Homebrew，可以使用以下命令更新 Node.js："]},{"l":"\uD83D\uDC27 Linux 系统 - 包管理器","p":["Linux 系统更新 Node.js 的方法取决于您的发行版。","但由于官方仓库中的 Node.js 版本可能不是最新的，我们推荐使用 Node 版本管理器 (nvm) 或 NodeSource 仓库。"]},{"l":"\uD83D\uDC33 Docker 容器","p":["无需任何操作。我们提供的预构建 Docker 镜像已使用最新版本的 Node.js 编译。"]}],[{"l":"\uD83D\uDE80 使用指南","p":["⚙️ 响应配置 与 \uD83D\uDCDD 提示词","❓ 常见问题","\uD83C\uDF0D 世界信息","\uD83C\uDFAF 欢迎页面助手","\uD83D\uDCAC 聊天交互","\uD83D\uDD0C API 连接","\uD83D\uDD0C 扩展功能","\uD83D\uDDC3️ 资料库","\uD83E\uDD16 开发与自动化","\uD83E\uDDD1‍\uD83E\uDD1D‍\uD83E\uDDD1 角色 与 \uD83D\uDC64 人物角色","\uD83D\uDE80 快速开始","为 AI 或界面添加新特性和能力","了解如何设置和使用欢迎页面助手，在欢迎屏幕上用指定角色迎接您。","以您的方式与 AI 互动。构筑您的世界、您的工作，或您的梦想。","关于 SillyTavern、AI 模型、角色创建、获取更佳回复等的常见问题解答","创建和使用角色来塑造 AI 的行为，定义您自己的身份","向 AI 发送您的第一条消息并获取回复","如何与 AI 聊天并使用聊天界面","存储和检索信息以供 AI 在响应中使用","控制您发送给 AI 的请求及其响应方式","管理信息并控制其插入提示词的时机","自动化任务，让您的 AI 与世界互动，并编写您自己的扩展","连接 AI 模型以生成文本、图像等"]},{"l":"\uD83C\uDF9B️ 控制面板","p":["⚙️ 响应配置 与 \uD83D\uDCDD 提示词管理","\uD83C\uDF0D 世界信息","\uD83C\uDFA8 高级格式化","\uD83D\uDC64 人物角色","\uD83D\uDC64 用户设置","\uD83D\uDD0C API 连接","\uD83D\uDD0C 扩展功能","\uD83D\uDDBC️ 背景","\uD83E\uDDD1‍\uD83E\uDD1D‍\uD83E\uDDD1 角色管理","为 AI 或界面添加新特性和能力","为文本补全 API 自定义提示词构建","从左到右，所有按钮的功能说明：","创建和管理与 AI 一起使用的人物角色","创建和管理供 AI 使用的角色","控制文本生成与采样。为聊天补全 API 自定义提示词构建。","更改主题，以及消息和聊天的外观与感觉","更改背景图片","管理信息并控制其插入提示词的时机","连接 AI 模型以生成文本、图像等"]}],[{"l":"\uD83D\uDE80 快速开始","p":["我是小白，请手把手教我最简单快捷使用 SillyTavern 的方法。 -- 匿名用户","只需几分钟即可开始使用 SillyTavern。以下是两种简单的入门方式：","您可以 使用 AI Horde（免费）。AI Horde 是一个社区驱动的 AI 服务，提供多种 AI 模型的访问权限。","如果您拥有 OpenAI 账户或想要注册一个，可以 使用 OpenAI。"]},{"l":"使用 AI Horde 快速开始","p":["按照 安装指南 安装并启动 SillyTavern","在 SillyTavern 的欢迎界面中，输入您的人物名称。此名称将在聊天中使用","可选说明文字","点击顶部工具栏中的 API 连接按钮","输入 AI Horde 的 API 密钥。您暂时可以使用 0000000000，或从 AI Horde 获取免费密钥","选择要使用的 AI 模型。只需从顶部选择几个即可，以后随时可以更改","关闭 API 连接窗口。在底部的聊天框中输入消息并按回车键","您的 AI 将在片刻后回复。您可以继续与它 聊天。成功！"]},{"l":"使用 OpenAI 快速开始"},{"l":"安装 SillyTavern","p":["按照 安装指南 安装并启动 SillyTavern"]},{"l":"获取 OpenAI 访问权限","p":["注册 OpenAI 账户","访问 https://platform.openai.com","点击右上角的账户图标，然后选择 View API Keys","点击 \"Create new secret key\"。立即将其复制到安全的地方。 请勿分享此密钥。任何拥有此密钥的人都可以使用您的账户并以您的费用使用 GPT"]},{"l":"配置 SillyTavern 使用您的 API","p":["在 SillyTavern 的顶部工具栏中，点击 API Connections","在 API 下选择 Chat Completion (OpenAI)","在 Chat Completion Source 下选择 OpenAI","粘贴您在上一步中保存的 API 密钥","点击 Connect 按钮。确认显示 Valid","默认情况下，SillyTavern 将使用 GPT-4 Turbo。您可以选择其他模型，但请先了解定价信息"]},{"l":"测试您的设置","p":["在 SillyTavern 的顶部工具栏中，点击最右侧的 Character Management","选择一个现有角色，例如 Seraphina","在底部的文本框中向 Seraphina 写些内容，然后按 Enter 键或点击 Send 按钮","如果一切设置正确，几秒钟后 Seraphina 应该会回复您。"]}],[{"l":"❓ 常见问题解答"},{"l":"SillyTavern 是什么？","p":["现代 AI 语言模型（如 ChatGPT）已经变得非常强大，其中一些能够逼真地模拟您创建的角色，您可以与之聊天、共同创作小说等。例如，您可以告诉 AI 扮演一位名叫 Jubei 的中世纪日本围棋导师，它会相应地行动和回应。您可以与 Jubei 长时间聊天，一起去酒吧，决定与武士打架，任何您能想象的事情，AI 都会配合并围绕这些内容进行写作/反应，充当您的对手和地下城主。您的想象力是唯一的限制。您可以告诉 AI 假装它是神奇女侠。您还可以指定场景（\"神奇女侠和我在抢劫银行\"）、写作风格（\"神奇女侠说黑人英语\"）或任何您能想到的内容。","SillyTavern 是一个促进这些用途的应用程序：","它是一个处理与 AI 语言模型通信的用户界面","它让您可以创建新的角色卡（提示），并轻松在它们之间切换","它让您可以导入其他人创建的角色","它会保存您与角色的聊天历史，允许您随时恢复、开始新聊天、查看旧聊天等","在后台，它会为您准备 AI 提示所需的内容。具体来说，它会发送系统提示（AI 的指令），使 AI 遵循某些规则以提高响应准确性"]},{"l":"AI 模型选项概述","p":["SillyTavern 可以与两种类型的 AI 交互：","网络服务（基于云端，通常付费、专有、封闭）","自托管（本地、免费、开源）"]},{"l":"付费网络服务 AI","p":["付费网络模型是黑盒子。您支付公司费用以使用他们的 AI 服务。您在 SillyTavern 中输入账户信息，它将连接到您的提供商以代表您使用 AI。","优点：","真正容易上手","最高质量的 AI 写作","缺点：","使用需要付费","所有内容都记录在他们的服务器上。存在隐私问题","它们经常被审查，会拒绝与您讨论某些主题"]},{"l":"自托管 AI","p":["自托管模型是可以在您的 PC 上运行的免费模型，但需要强大的 PC 和更多设置工作。","优点：","一旦设置完成，即使没有互联网访问也可以免费使用","完全隐私。您写的一切都保留在您自己的 PC 上","有各种各样的模型。作为社区驱动的技术，您可以找到适合特定任务或您想要的行为的模型","缺点：","它们不如 SOTA 模型强大（即，对话写作更差，创造性较低等）","运行本地模型需要至少 6GB VRAM 的 GPU","如果您有兴趣使用这些，请参阅专用指南： 如何使用自托管模型"]},{"l":"我可以在手机或平板电脑上使用 SillyTavern 吗？","p":["iPhone 和 iPad 无法运行整个 SillyTavern 应用程序，但由于它只是一个 Web 界面，您可以在家庭 Wi-Fi 上的另一台计算机上运行它，然后在移动浏览器中访问它。有关更多信息，请参阅 远程连接","对于 Android 用户，除了上述方法外，您还可以使用 Termux 应用程序直接在手机上运行整个 SillyTavern，而无需 PC。请参阅 安装（Android）（注意：Termux 安装不受官方支持，我们不能保证它会工作）"]},{"l":"我尝试导入 PNG 角色卡，但收到错误提示说它无效。为什么？","p":["两种可能性：","该卡片没有嵌入定义，只是一个普通的图像文件。某些程序或文件管理器在保存时会从卡片中剥离嵌入的定义。请确保您使用原始 PNG 文件，就像分享它的人发布的那样","PNG 文件实际上是一个带有 .png 文件名的 WEBP 文件。您可以尝试在导入前将卡片重命名为 .webp，或者寻找正确的 PNG 版本图像"]},{"l":"如何制作自己的 AI 角色？","p":["点击角色管理按钮","点击创建新角色","在角色名称下，给一个名字，比如 Amanda","可选地，点击选择头像按钮为此角色选择图像肖像","在描述下，描述角色，并包含您认为与聊天相关的任何信息。例如： Amanda 是一名在间隔年旅行的学生。她身高 6 英尺，是一名排球运动员。她有着运动员的身材。她有长长的棕色头发。她热爱维多利亚时代的英国时期，喜欢观看与该时期相关的电视和阅读小说 例如，如果您希望 Amanda 友好，那么您将添加： Amanda 非常开朗和外向","在第一条消息下，写下开始新聊天时角色的问候语。例如：*Amanda 向您挥手* 嘿！你也是背包客吗？","点击创建角色按钮","您现在有一个可以与之聊天的基础角色。从角色列表中选择 Amanda，将开始一个新的聊天。","请注意，您可以使用描述和/或第一条消息创建更具体的场景，和/或在描述中包含您自己。例如：","您包含的任何相关信息都可以使用。使用效果如何取决于 AI 模型的功率水平。","注意：角色创建后，您可以返回编辑任何这些信息，除了名称。"]},{"l":"我的 API 密钥存储在哪里？为什么我看不到它们？","p":["SillyTavern 将您的 API 密钥保存到用户数据目录中的 secrets.json 文件（默认路径是 /data/default-user/secrets.json）","默认情况下，API 密钥在保存并刷新页面后从界面中不可见。","要启用查看您的密钥：","在 config.yaml 文件中将 allowKeysExposure 的值设置为 true","重新启动 SillyTavern 服务器","点击 API 连接面板右下角的“查看隐藏的 API 密钥”链接"]},{"l":"性能提示"},{"l":"为什么 UI 这么慢/卡顿？","p":["尝试在用户设置面板上启用无模糊效果（快速 UI）模式","在 UI 主题设置中启用减少运动以移除装饰性动画","确保您的浏览器使用硬件加速","如果使用响应流，将流式传输 FPS 设置为较低值（推荐 10-15 FPS）"]},{"l":"我遇到输入延迟。我能做什么？","p":["性能下降，特别是输入延迟，最常归因于浏览器扩展。已知有问题的扩展包括：","iCloud 密码管理器","DeepL 翻译","基于 AI 的语法校正工具","各种广告拦截扩展","如果您遇到性能问题且无法确定原因，或怀疑是 SillyTavern 本身的问题，请：","记录性能配置文件","将配置文件导出为 JSON 文件","将其提交给开发团队进行分析","我们建议首先禁用所有浏览器扩展和第三方 SillyTavern 扩展进行测试，以隔离性能下降的来源"]},{"l":"当我导入大量角色时，应用程序变慢。为什么？","p":["不幸的是，SillyTavern 并非设计用于处理巨大的角色库。您拥有的角色越多，加载角色列表所需的时间就越长。证据数据表明，当您拥有超过 1000 个角色时，性能下降开始变得明显。","但是，您可以采取一些措施来缓解问题：","1. 使用懒加载","在 config.yaml 文件中将 performance.lazyLoadCharacters 的值设置为 true 以启用角色懒加载设置。在下次服务器重启后，角色列表将仅加载您与之交互的角色的完整数据。请注意，如果某些第三方扩展未更新以支持此设置，启用后可能无法正常工作（请联系扩展开发者获取更多信息）","2. 使用内存缓存","如果您有一些空闲 RAM，增加内存缓存容量。这将允许服务器在内存中保留更多角色，减少加载它们所需的时间。您可以通过调整 config.yaml 文件中 performance.memoryCacheCapacity 的值到更高的数字来实现。默认值是 100mb。大致经验法则：每拥有 3000 个角色，将值增加 100mb","限制：","启用懒加载后，高级（模糊）角色搜索将不起作用。仅搜索角色名称","由于可用内存有限，内存缓存在 Android 设备上被禁用"]},{"l":"如何让 AI 写更多？","p":["有时 AI 只会用一句话回应，而您希望它更详细。 这通常是本地运行模型的问题。","如果您只是想讓機器人從它最近回复結束的地方繼續寫作，您可以通過在輸入欄中不輸入任何內容並點擊發送來發送空用戶消息。這將強制機器人繼續故事。","修复策略：","增加“响应长度”设置的值","为角色设计一个良好的“第一条消息”，显示他们说话啰嗦的方式。当给予关于您期望的写作风格的指导时，AI 模型可以大大提高","在角色的描述框中添加短语，如“喜欢说话很多”或“非常啰嗦的说话者”","对您的“作者注记”或“后历史指令提示”做同样的事情","作为最后的手段，您可以尝试打开“自动继续”（在用户设置面板中），但会使响应变慢，因为它使 AI 背靠背地产生小回复，然后将它们全部组合成一个大回复。它也可能与某些 API 选项不兼容"]},{"l":"如何让 AI 写更少？","p":["这主要只是像 ChatGPT 或 Claude 这样的模型的问题。可以应用相同的策略但相反。","降低“响应长度”设置的值","给角色一个短语，如“说话简短”，或“不多说话”的行在他们的描述中","给角色一个简短的第一条消息来设定聊天的基调和期望","确保“自动继续”已关闭"]},{"l":"如何让 AI 停止编写我角色的动作，并完全自行驱动情节？","p":["这应该在“作者注记”中处理，结合如下短语：","{{char}} 的回应应仅对 {{user}} 的动作被动和反应","您的下一个回应应仅从 {{char}} 的视角出发","绝不允许为 {{user}} 规定动作或言语"]}],[{"l":"\uD83D\uDCAC 畅聊互动","p":["连接到 API 后，通过在屏幕底部的聊天栏中输入内容，向 AI 发送消息。然后点击 发送 或按 Enter 键。","聊天栏","AI 将回复一条消息以继续对话。","聊天消息","您现在可以：","发送另一条消息","滑动响应：点击消息上的 滑动 按钮以生成不同的回复。","编辑消息：点击任意消息上的 编辑 按钮以 编辑消息内容。","消息操作：点击消息上的 消息操作 按钮以获取更多 消息选项，如 翻译、图像生成和故事分支。","聊天选项：点击聊天栏旁边的 选项 按钮以获取更多 聊天选项，如作者笔记和聊天文件管理。","如果您希望之前说了不同内容，可以编辑您的消息，然后滑动 AI 的回复以获取新的回复。","您也可以使用 右 箭头键滑动回复，使用 上 箭头键编辑聊天中的最后一条消息。有关更多快捷键，请在聊天中使用 /help hotkeys 斜杠命令 或查看 快捷键 页面。"]},{"l":"\uD83D\uDCCB 消息操作面板","p":["通过消息上的省略号 (•••) 按钮管理单个聊天消息。","要在所有聊天消息中显示这些选项，请在用户设置中启用 展开消息操作 设置。"]},{"l":"核心功能","p":["翻译：将消息转换为不同语言","生成图像：根据消息内容 创建图像","讲述： 文本转语音 转换","提示：查看生成提示和令牌使用情况"]},{"l":"消息可见性","p":["已包含：AI 能看到此消息；点击以排除它","已排除：AI 看不到此消息；点击以包含它"]},{"l":"内容管理","p":["嵌入： 附加文件或图像","检查点：创建故事检查点","检查点导航：点击打开检查点聊天，Shift+点击更新现有检查点","分支：开始替代故事路径","复制：复制消息文本","编辑：编辑消息内容"]},{"l":"✏️ 编辑消息内容","p":["一个紧凑的消息操作工具面板，在您 编辑 聊天消息时出现。"]},{"l":"核心操作","p":["确认：保存消息更改","取消：丢弃消息更改"]},{"l":"消息操作","p":["复制：复制消息内容","删除：移除消息"]},{"l":"消息位置","p":["上移：将消息在聊天中向上移动","下移：将消息在聊天中向下移动","注意：根据消息在聊天历史中的位置，移动控件可能会被禁用。"]},{"l":"⚙️ 聊天选项面板","p":["通过聊天界面左下角的 选项 按钮管理聊天设置和操作。"]},{"l":"显示控制","p":["关闭聊天：退出当前聊天会话","切换面板：显示/隐藏 界面面板"]},{"l":"生成设置","p":["作者笔记：自定义上下文指令","CFG 规模：调整回复创意度","令牌概率：查看令牌生成统计信息"]},{"l":"聊天导航","p":["返回父聊天：返回主对话","保存检查点：创建故事检查点","转换为群组：转换为 群聊"]},{"l":"聊天管理","p":["开始新聊天：开始新的对话","管理聊天文件： 聊天文件操作，如导入、导出和重命名"]},{"l":"消息控制","p":["删除消息：选择并删除多条消息","重新生成：创建新的回复","模拟：AI 以用户身份编写消息","继续：扩展最后一条消息","注意：某些选项可能会根据上下文和聊天状态隐藏。"]},{"l":"\uD83D\uDCCA 令牌概率面板","p":["令牌概率面板让您可以深入了解 AI 生成文本时的采样过程。它不仅显示 AI 写了什么，还显示它在文本每个点考虑的其他选项。","要打开它，请点击 聊天选项 面板中的 令牌概率 按钮。","示例消息","示例消息的令牌概率显示","当您点击生成文本中的任何令牌（单词、标点符号或格式字符）时，面板会显示 AI 在该位置考虑的替代令牌及其概率分数。这让您可以了解 AI 的“思考过程”，并显示回复可能采取的其他方向。查看这些替代选项可以帮助您了解当时是有几个可能的选项还是一个明确的选择。","替代令牌和概率","如果您认为 AI 本应选择不同的令牌，请选择一个替代项，消息将从该点开始重新生成，可能会给您不同的回复。"]},{"l":"重新生成 (Rerolling)","p":["如果您更改特定令牌并重新生成回复，新回复中更改前令牌之前的部分将与原始回复相同。这部分显示为灰色。由于它不是生成的，因此没有这部分信息的概率。","您可能希望看到基于您选择的替代令牌可能生成的其他回复。","您可以点击灰色部分以“重新生成”，为您提供文本的新变体。点击灰色部分的任何部分将保留整个灰色部分，并重新生成整个白色/着色部分。","按住 Ctrl 键并点击灰色部分中的令牌将保留直到所点击令牌的灰色部分，并重新生成其余文本。您选择的替代令牌在这种情况下无法保留。"]},{"l":"控件","p":["令牌显示：","生成的文本被分割成单独的令牌","每个令牌都是交互式的，点击令牌可查看 AI 考虑的替代项","令牌会着色作为视觉辅助，但这并不表示概率","特殊字符（空格、换行符）会被明显标记","令牌选择：","点击令牌以查看替代项","点击替代项以替换令牌并重新生成回复","将鼠标悬停在令牌上可查看其原始对数概率分数","窗口控件：","拖动手柄用于重新定位面板（仅限 MovingUI）","最大化/恢复面板大小","展开/折叠面板内容","关闭面板"]},{"l":"可用性","p":["您必须在 用户设置 中选择 请求令牌概率 才能启用此功能。","令牌概率仅对最新消息可用，并且不会保存到聊天中。如果消息的令牌概率信息不再可用，面板将显示一条指示消息。","使用平滑流式传输时，令牌概率不可用。","并非所有 API 都提供令牌概率。如果您使用的 API 不支持令牌概率，面板将打开但不会显示任何信息。"]},{"l":"文本补全 (Text Completion)","p":["LlamaCPP：可用","Text Generation WebUI(oobabooga)：可用","TabbyAPI：可用","NovelAI：可用","KoboldCPP：可用","Ollama：似乎不可用","OpenRouter Text：似乎不可用"]},{"l":"聊天补全 (Chat Completion)","p":["OpenAI 或 Custom：可用，但不支持重新生成 (rerolling)","Anthropic：似乎不可用","Google AI Studio：似乎不可用","OpenRouter Chat：似乎不可用"]}],[{"l":"\uD83D\uDD27 斜杠命令","p":["此非完整列表，更新频率较低。","要获取您当前实例中最新的可用命令列表，请在任意 SillyTavern 聊天中使用 /help slash 命令。","/help– 显示帮助信息","/api- 切换至其他 API","/sys- 以系统中立旁白身份发送消息","/send- 以用户身份发送消息但不触发内容生成","/sendas– 以指定角色身份发送消息","/comment- 添加对 AI 不可见的聊天注释","/impersonate- 要求 AI 以您的身份进行回复（可提供提示词）","/persona- 设置您的用户角色设定","/imagine- 根据文本提示生成图像","/bg- 通过文件名设置背景图片"]}],[{"l":"\uD83D\uDE80 快捷键指南","p":["✨ 要获取 SillyTavern 实例中最新的快捷键列表，请在任意聊天中输入 /help hotkeys 命令。","\uD83D\uDCF1 移动设备禁用快捷键功能。"]},{"l":"\uD83D\uDCAC 聊天快捷键","p":["↑ 上箭头= 编辑聊天中的上一条消息","Ctrl + ↑= 编辑聊天中上一条用户消息","← 左箭头= 左滑（撤销操作）","→ 右箭头= 右滑（恢复操作）","⚠️ 输入框中有内容时，滑动快捷键禁用","Enter（输入框选中时）= 发送消息至 AI","Ctrl + Enter= 重新生成上一条 AI 回复","Alt + Enter= 继续生成上一条 AI 回复","Esc","（编辑消息且启用了自动保存时）= 关闭编辑框","（AI 正在生成或流式输出消息时）= 立即停止生成"]},{"l":"\uD83D\uDCDD Markdown 快捷键","p":["⚠️ 需在「用户设置」中启用。适用于输入框及带有 M↓ 图标的文本区域：","Ctrl + B= 加粗","Ctrl + I= 斜体","Ctrl + U= 下划线","Ctrl + K= 行内代码","Ctrl + Shift + ~= 删除线"]}],[{"l":"⚙️ 通用设置","p":["此处设置控制使用语言模型生成文本时的采样过程。这些设置的含义对所有支持的 后端 是通用的。"]},{"l":"\uD83D\uDCD6 上下文设置"},{"l":"生成长度（词元数）","p":["API 生成响应所使用的 最大词元数。","生成长度越高，生成响应所需时间越长。","如果 API 支持，可启用 流式传输，以便在响应生成过程中逐段显示。","关闭 流式传输 后，响应将在完成后一次性显示。"]},{"l":"上下文长度（词元数）","p":["SillyTavern 作为提示词发送给 API 的 最大词元数（需减去响应长度）。","上下文包含角色信息、系统提示、聊天历史等。","消息之间的虚线表示聊天的上下文范围，该线上方的消息不会发送给 AI。","生成消息后，点击 提示词分解 消息选项（展开 ... 菜单并点击带线方框图标）可查看上下文的组成。"]},{"l":"\uD83C\uDF9B️ 采样器参数"},{"l":"温度 (Temperature)","p":["控制词元选择的随机性：","低温度(<1.0) 生成更可预测的文本，偏向高概率词元。","高温度(>1.0) 通过增加低概率词元的选择机会，提升输出的创造性和多样性。","设置为 1 可使用原始概率。"]},{"l":"重复惩罚 (Repetition Penalty)","p":["通过根据词元在上下文中出现的频率进行惩罚，以 抑制重复。","设置为 1 可禁用此效果。"]},{"l":"重复惩罚范围 (Repetition Penalty Range)","p":["考虑重复惩罚的、从最后一个生成词元算起的词元数量。设置过高会破坏响应，因为常见词（如 “the”、“a”、“and” 等）将受到最大惩罚。","设置为 0 可禁用此效果。"]},{"l":"重复惩罚斜率 (Repetition Penalty Slope)","p":["如果此项和 重复惩罚范围 均大于 0，则重复惩罚在提示词末尾的效果更强。值越高，效果越强。","设置为 0 可禁用此效果。"]},{"l":"前 K 采样 (Top K)","p":["设置可供选择的最大顶级词元数量。例如，如果 Top K 为 20，则意味着只保留排名最高的 20 个词元（无论其概率分布广泛还是有限）。","设置为 0（或根据后端设置为 -1）可禁用。"]},{"l":"前 P 采样 (Top P)","p":["前 P 采样（又称核采样）累加顶级词元，直至达到目标百分比。如果前 2 个词元概率均为 25%，且 Top P 为 0.50，则仅考虑前 2 个词元。","设置为 1 可禁用此效果。"]},{"l":"典型 P 采样 (Typical P)","p":["根据词元与集合平均熵的偏差来优先选择词元。它保留累积概率接近预定义阈值（例如 0.5）的词元，强调那些具有平均信息量的词元。","设置为 1 可禁用此效果。"]},{"l":"最小 P 采样 (Min P)","p":["通过剔除与顶级词元相比概率较低的词元来限制词元池。可生成更连贯的响应，但设置过高也可能加剧重复。","在较低值（如 0.1-0.01）下效果最佳，但也可与高 温度 配合设置更高值。例如： 温度: 5, 最小 P: 0.5","设置为 0 可禁用此效果。"]},{"l":"前 A 采样 (Top A)","p":["根据最高词元概率的平方设置词元选择阈值。例如，如果 Top-A 值为 0.2，且顶级词元概率为 50%，则概率低于 5% (0.2 * 0.5^ 2) 的词元将被排除。","设置为 0 可禁用此效果。"]},{"l":"无尾采样 (Tail Free Sampling, TFS)","p":["通过使用导数分析词元概率的变化率，搜索分布中的低概率词元尾。它根据归一化二阶导数保留达到阈值（例如 0.3）的词元。越接近 0，丢弃的词元越多。","设置为 1 可禁用此效果。"]},{"l":"平滑因子 (Smoothing Factor)","p":["使用二次变换增加高概率词元的可能性，同时降低低概率词元的可能性。旨在无论 温度 如何，都能产生更具创造性的响应。","不与截断采样器（如 Top K、 Top P、 Min P 等）一起使用时效果最佳。","设置为 0 可禁用此效果。"]},{"l":"动态温度 (Dynamic Temperature)","p":["根据顶级词元的可能性动态调整温度。旨在不牺牲连贯性的前提下产生更具创造性的输出。","接受从最小到最大的温度范围。例如： 最小温度: 0.75 和 最大温度: 1.25","指数 根据顶级词元应用指数曲线。","取消勾选可禁用此效果。"]},{"l":"Epsilon 截断 (Epsilon Cutoff)","p":["设置一个概率下限，低于该值的词元将被排除在采样之外。单位为 1e-4；合理值为 3。","设置为 0 可禁用。"]},{"l":"Eta 截断 (Eta Cutoff)","p":["特殊 Eta 采样技术的主要参数。单位为 1e-4；合理值为 3。详情参见论文 Truncation Sampling as Language Model Desmoothing by Hewitt et al. (2022)。","设置为 0 可禁用。"]},{"l":"DRY 重复惩罚 (DRY Repetition Penalty)","p":["DRY 会惩罚那些将输入末尾扩展为输入中先前出现过的序列的词元。如果您想允许逐字重复某些序列（例如名称），可以将其添加到序列中断器列表中。参见 Pull Request 此处。","将乘数设置为 0 可禁用。"]},{"l":"排除顶级选择 (Exclude Top Choices, XTC)","p":["XTC 采样算法移除最可能的词元而非修剪最不可能的词元。它以给定概率移除除符合给定阈值的最不可能词元之外的所有词元。这确保了至少有一个“可行”选择保留，从而保持连贯性。参见 Pull Request 此处。","将概率设置为 0 可禁用。"]},{"l":"Mirostat","p":["Mirostat 将输出复杂度与输入匹配，从而避免重复陷阱（自回归推理生成文本时，输出复杂度趋于零）和混淆陷阱（复杂度发散）。详情参见论文 Mirostat: A Neural Text Decoding Algorithm that Directly Controls Perplexity by Basu et al. (2020)。","模式选择 Mirostat 版本。","0 = 禁用，","1 = Mirostat 1.0（仅限 llama.cpp），","2 = Mirostat 2.0。"]},{"l":"束搜索 (Beam Search)","p":["一种用于 LLM 采样的贪婪暴力算法，用于查找最可能的单词或词元序列。它同时扩展多个候选序列，并在每一步保留固定数量（束宽）的顶级序列。"]},{"l":"Top nsigma","p":["一种基于统计特性过滤逻辑值的采样方法。它保留最大逻辑值 n 个标准偏差范围内的词元，提供了一种更简单的 top-p/top-k 采样替代方案，同时在不同温度下保持采样稳定性。"]}],[{"l":"\uD83E\uDD16 API 连接概览","p":["SillyTavern 能够连接多种大语言模型（LLM）API。 下文将介绍它们各自的特点、优缺点及适用场景。"]},{"l":"\uD83E\uDDE0 核心概念：聊天补全 vs 文本补全","p":["首次进入 ST 的“API 连接”页面时，你会看到一个下拉选项，其中包含“Chat Completion”（聊天补全）和“Text Completion”（文本补全）等术语。理解其含义非常重要。","常见的误解：容易将“文本补全”视为本地模型，将“聊天补全”视为云端 LLM，但事实并非如此。同样地，“Novel AI”或“Kobold”也并非独立的模型类型，尽管它们在 ST 的 API 下拉菜单中是单独的选项。通过合适的后端，你可以强制模型使用不同的 API 结构，但这并非本节重点。","当你使用 ST 发送消息时，你的聊天记录、角色描述以及其他提示（如 lorebooks 或作者注记）会被构建成一个单一的“提示”（prompt）发送给模型。你所使用模型的 API“类型”决定了这个提示的具体构建方式（ST 会在后台自动处理——你可以在 ST 终端中查看发送给 AI 的提示的具体样子）。"]},{"l":"\uD83D\uDCAC 聊天补全 (Chat Completions)","p":["聊天补全模型，顾名思义，会将你的提示构建成用户（你）、助手（AI）或系统（中立）之间的一系列消息。为聊天补全训练的模型有助于营造“聊天”的感觉，让 AI“回复”最后一条消息。当你使用 ChatGPT 网站时，后台使用的就是聊天补全 API。"]},{"l":"\uD83D\uDCDD 文本补全 (Text Completions / Completions)","p":["另一方面，文本补全，同样顾名思义，会将你的提示转换成一个长字符串，模型则会简单地尝试续写这个字符串（想象一下你所有的文本、数百条消息、所有格式、换行符等都被压缩成一个非常长的句子）。","如果你在 ST 中的消息恰好被格式化为 YourPersona: 和 Character: 之间的一系列对话，文本补全模型会尝试延续这种模式，ST 会将其渲染为一条新的聊天消息，但实际上模型只是在尝试续写文本。如果你输入“太阳从（The Sun rises in the）”，文本补全模型很可能会为你补全为“东方（East）”。","大多数文本补全模型都有一个推荐的“指令模板”（Instruct Template，通常在模型的文档或下载页面提及），这有助于它们像聊天补全模型一样“响应”消息和指令。ST 通常在“高级格式化”页面提供了大多数（即使不是全部）指令模板供你选择。"]},{"l":"\uD83D\uDDA5️ 本地 API","p":["这些 LLM API 可在你的个人电脑上运行。","免费使用，且无内容过滤。","安装过程可能较为复杂（ SillyTavern 开发团队不为此提供支持）。","需要从 HuggingFace 单独下载 LLM 模型，每个模型约 5-50GB。","多数模型性能不及云端 LLM API。"]},{"l":"\uD83D\uDC09 KoboldCpp","p":["\uD83D\uDFE2 优势：易于使用的 API，支持 CPU 卸载（对显存低的用户有帮助）和流式传输 (streaming)；Windows、Mac 和 Linux 上均有单文件二进制程序；支持 GGUF 模型。","\uD83D\uDFE1 注意：速度比纯 GPU 加载器（如 AutoGPTQ 和 Exllama/v2）慢。","\uD83D\uDD17 链接： GitHub, 设置指南"]},{"l":"\uD83E\uDD99 llama.cpp","p":["\uD83D\uDFE2 优势：KoboldCpp 和 Ollama 均源于此；提供预编译二进制文件和支持从源码编译；支持 GGUF 模型；轻量级的 llama-server CLI 界面。","\uD83D\uDD17 链接： GitHub"]},{"l":"\uD83E\uDED2 Ollama","p":["\uD83D\uDFE2 优势：所有基于 llama.cpp 的 API 中最易设置和使用；提供便捷的模型 目录，支持一键下载；支持封装为 Ollama 自有格式的 GGUF 模型。","\uD83D\uDD17 链接： GitHub, 官网"]},{"l":"☕ Oobabooga TextGeneration WebUI","p":["\uD83D\uDFE2 优势：集成了流式传输的一体化 Gradio UI；最广泛支持量化模型（AWQ, Exl2, GGML, GGUF, GPTQ）和 FP16 模型；提供一键安装程序。","\uD83D\uDFE1 注意：定期更新，有时可能会破坏与 SillyTavern 的兼容性。","\uD83D\uDD17 链接： GitHub","将 SillyTavern 正确连接到 Ooba 的新 OpenAI API 的方法：","确保你使用的是最新版的 Oobabooga TextGen（截至 2023 年 11 月 14 日）。","编辑 CMD_FLAGS.txt 文件，在其中添加 --api 标志。然后重启 Ooba 服务器。","将 ST 连接到 http://localhost:5000/（默认）， 不勾选'Legacy API' 框。你可以移除 Ooba 控制台提供给你的 URL 中的 /v1 后缀。","你可以使用 --api-port 5001 标志更改 API 主机端口，其中 5001 是你的自定义端口。"]},{"l":"\uD83D\uDE3A TabbyAPI","p":["\uD83D\uDFE2 优势：基于 Exllamav2 的轻量级 API，支持流式传输；支持 Exl2、GPTQ 和 FP16 模型；官方扩展允许直接从 SillyTavern 加载/卸载模型。","\uD83D\uDFE1 注意：不建议显存低的用户使用（无 CPU 卸载）。","\uD83D\uDD17 链接： GitHub, 设置指南"]},{"l":"⚠️ KoboldAI Classic (已弃用，停止维护)","p":["\uD83D\uDFE2 优势：在本地运行，100% 私有，可用模型范围广；提供对 AI 生成设置最直接的控制。","\uD83D\uDFE1 注意：需要大量 GPU 显存（6-24GB，取决于 LLM 模型）；模型上下文限制在 2k；不支持流式传输。","\uD83D\uDD17 链接：流行版本： Henky's United, 0cc4m's 4bit-supporting United"]},{"l":"☁️ 云端 LLM API","p":["这些 LLM API 作为云服务运行，无需占用你的电脑资源。","它们比大多数本地 LLM 更强大/更聪明。","但是，它们都带有不同程度的内容过滤，并且大多数需要付费。"]},{"l":"\uD83C\uDF10 AI Horde","p":["\uD83D\uDFE2 优势：SillyTavern 可开箱即用此 API，无需额外设置；利用志愿者（Horde Workers）的 GPU 来处理你的聊天输入响应。","\uD83D\uDFE1 注意：生成等待时间、AI 设置和可用模型取决于提供算力的 Worker。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"⚪ OpenAI (ChatGPT)","p":["\uD83D\uDFE2 优势：易于设置和获取 API 密钥；较新的模型（gpt-4-turbo, gpt-4o）支持多模态 (multimodality)；逻辑性强。","\uD83D\uDFE1 注意：需要预付费购买额度，按提示词收费；创作风格可能重复且可预测。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDFE0 Claude (由 Anthropic 提供)","p":["\uD83D\uDFE2 优势：推荐给希望 AI 聊天具有创造性、独特写作风格的用户；最新模型（Claude 3）支持多模态。","\uD83D\uDFE1 注意：需要预付费购买额度，按提示词收费；需要特定的提示风格并利用 预填充(prefills) 来引导回复。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDD35 Google AI Studio 与 Vertex AI","p":["\uD83D\uDFE2 优势：提供具有速率限制的免费层级（Gemini Flash）； AI Studio 通常有最新的模型和功能。","\uD83D\uDFE1 注意：可能需要账单信息； Vertex AI 设置更复杂，但更稳定。","\uD83D\uDD17 链接： 设置指南"]},{"l":"\uD83D\uDFE3 Mistral (由 Mistral AI 提供)","p":["\uD83D\uDFE2 优势：提供不同规模和用途的高效模型；可在 其平台 创建账户和 API 密钥；通用模型上下文大小从 32k 到 128k，编码模型从 32k 到 256k；有免费层级（含速率限制）；审核适度，Mistral 的主要原则是保持中立并赋能用户，更多信息见 此处。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83C\uDF09 OpenRouter","p":["\uD83D\uDFE2 优势：提供统一 API 来访问市场上的所有主流 LLM；按 token 付费的信用点系统，以及每日请求次数有限的免费模型。","\uD83D\uDFE1 注意：除非 LLM 供应商要求，否则不强制执行内容审核。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDC2F DeepSeek","p":["\uD83D\uDFE2 优势：提供访问非常流行的 DeepSeek V3 ( deepseek-chat) 和 DeepSeek R1 ( deepseek-reasoner) 模型的最新版本；模型质量高且价格相当便宜。","\uD83D\uDFE1 注意：需要付费购买额度（最低 $2）；API 无审核，但模型可能拒绝某些提示。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83E\uDD99 AI21","p":["\uD83D\uDFE2 优势：提供访问 Jamba 系列开源模型；有免费试用（三个月 $10 额度），之后需按月按 token 付费。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDD37 Cohere","p":["\uD83D\uDFE2 优势：提供访问 Cohere 的最新模型（command-r, command-a, c4ai-aya 等）；有免费层级（试用密钥），速率限制足够日常使用。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDD0D Perplexity","p":["\uD83D\uDFE2 优势：通过其 API 提供独特的 Perplexity Sonar 在线模型。","\uD83D\uDFE1 注意：需要配置账单并购买额度。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"⚗️ Mancer AI","p":["\uD83D\uDFE2 优势：托管各种系列的无约束模型的服务；使用“信用点”(credits)支付不同模型的 token；默认不记录提示，但启用后可获得 token 信用点折扣。","\uD83D\uDFE1 注意：使用类似于 Oobabooga TextGeneration WebUI 的 API，详情见 Mancer 文档。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83C\uDF0C DreamGen","p":["\uD83D\uDFE2 优势：无审核模型，专为可引导的创造性写作调优；提供免费月度额度以及付费订阅；模型规模从 7B 到 70B。","\uD83D\uDD17 链接： 设置指南"]},{"l":"\uD83C\uDFA8 Pollinations","p":["\uD83D\uDFE2 优势：无需设置，开箱即用；免费提供访问多种模型。","\uD83D\uDFE1 注意：输出可能偶尔包含第三方服务的广告链接。"]},{"l":"\uD83D\uDCDC NovelAI","p":["\uD83D\uDFE2 优势：无内容过滤；最新模型基于 Llama 3。","\uD83D\uDFE1 注意：需要付费订阅，订阅等级决定最大上下文长度。","\uD83D\uDD17 链接： 官网, 设置指南"]},{"l":"\uD83D\uDD27 AI/ML API","p":["\uD83D\uDFE2 优势：提供 300+ 模型的统一 API，包括 Claude、GPT-4o、Gemini、LLaMA 3、Mistral 等；提供含速率限制的免费层级、订阅计划和按量付费选项。","\uD83D\uDD17 链接： 官网, 文档, 模型列表"]}],[{"l":"\uD83D\uDCC1 连接配置文件","p":["保存连接配置文件，以便快速在不同的 API、模型和格式化模板之间切换。这在您需要主动使用多个 API 连接，或无需浏览菜单即可在不同配置之间切换时非常有用。"]},{"l":"\uD83D\uDD17 访问连接配置文件","p":["此功能自 SillyTavern 1.12.6 或更高版本起作为内置扩展默认启用，并可在 API 连接菜单中找到。如果您希望 禁用 它，请打开扩展面板，点击“管理扩展”，在列表中找到“连接配置文件”，取消选中“启用”复选框，然后点击“关闭”。"]},{"l":"\uD83D\uDCBE 保存内容","p":["连接配置文件存储以下选项。"]},{"l":"通用设置","p":["API 类型、模型和服务器 URL","密钥 (Secret Key)","设置预设 (Settings preset)","起始回复词 (Start Reply With)(可显式设置为空)","自定义停止字符串 (Custom Stopping Strings)(可显式设置为空)","推理格式化 (Reasoning Formatting)"]},{"l":"文本补全 API","p":["系统提示词及其状态 (System Prompt)","指令模式状态和模板 (Instruct Mode)","上下文模板 (Context Template)","分词器 (Tokenizer)"]},{"l":"聊天补全 API","p":["提示词后处理 (Prompt Post-Processing)","代理预设 (Proxy preset)"]},{"l":"\uD83D\uDEE0️ 管理连接配置文件","p":["配置文件仅保存下拉字段中的选择，对底层设置一无所知。这意味着通过切换到其他配置文件，您将丢失未保存的更改。为防止这种情况，如果您不想丢失临时更改，请确保更新所有预设和模板。","要保存配置文件：设置所有必需的选项，然后单击“创建 (Create)”按钮。然后检查设置并为配置文件提供一个名称。 名称应是唯一的。","要查看所选配置文件的详细信息：单击“信息 (Information)”按钮。再次单击可隐藏详细信息。","连接配置文件设置会保存到 settings.json 中，而不会更改关联的配置文件保存文件，除非您按下“更新 (Update)”按钮。这意味着如果您设置了一个配置文件，但在未更新的情况下切换到另一个配置文件，您将丢失之前的所有更改。","要从已保存的配置文件恢复更改的选项：单击“重新加载 (Reload)”按钮。","要删除配置文件：单击“删除 (Delete)”按钮并确认删除。 此操作不可逆。"]},{"l":"⌨️ 斜杠命令","p":["可以使用以下斜杠命令管理连接配置文件。","/profile [名称]- 如果提供了参数，则切换到指定名称的配置文件；如果未提供，则获取当前配置文件的名称。","/profile-create [名称]- 将当前设置另存为具有所提供名称的新配置文件。","/profile-list- 返回可用配置文件名称的 JSON 序列化数组。","/profile-get [名称]- 获取所提供名称的配置文件的详细信息，以 JSON 序列化对象形式返回。","/profile-update- 使用当前设置更新选定的配置文件。"]}],[{"l":"\uD83E\uDD16 自托管 AI 模型","p":["本指南基于作者的个人经验和知识，并非绝对真理。所有陈述都应持保留态度看待。如果您有任何更正或建议，请在 Discord 上联系我们或向 SillyTavern 文档仓库 提交 PR。"]},{"l":"\uD83C\uDFAF 简介","p":["本指南旨在帮助您设置并使用运行在您个人电脑上的本地 AI（从现在开始我们将使用正确的术语，称其为 LLM - 大语言模型）与 SillyTavern 配合使用。在您用技术支持问题打扰他人之前，请先阅读本指南。"]},{"l":"什么是最好的大语言模型？","p":["这个问题无法回答，因为不存在标准化的“最好”尺度。社区在 Reddit 和 Discord 上有足够的资源和讨论，足以对什么是首选/常用的模型形成一些看法。您的体验可能有所不同。"]},{"l":"什么是最好的配置？","p":["如果存在一个最好的或无需思考的设置，那还需要配置吗？最好的配置是适合您的那一个。这是一个反复试验的过程。"]},{"l":"\uD83D\uDCBB 硬件要求与导向","p":["这是一个复杂的话题，因此我将坚持要点并进行概括。","互联网上有成千上万个免费的 LLM 可供下载，类似于 Stable Diffusion 有大量模型可用于生成图像。","运行未经修改的 LLM 需要一个拥有大量 VRAM（GPU 内存）的怪兽级 GPU。远超您所拥有的。","可以通过使用量化技术（如 GPTQ 或 AWQ）压缩模型来降低 VRAM 需求。这会使得模型能力稍有下降，但大大降低了运行它所需的 VRAM。突然之间，这让拥有像 3080 这样的游戏 GPU 的用户可以运行 13B 模型。即使它不如未量化的模型好，但仍然不错。","情况变得更好：还有一种称为 GGUF（以前是 GGML）的模型格式和量化方式，已成为没有怪兽级 GPU 的普通用户的首选格式。这允许您完全无需 GPU 即可使用 LLM。它只会使用 CPU 和 RAM。这比使用 GPTQ/AWQ 在 GPU 上运行 LLM 慢得多（可能慢 15 倍），尤其是在提示处理期间，但模型的能力同样好。GGUF 创建者随后通过添加一个配置选项进一步优化了 GGUF，该选项允许拥有游戏级 GPU 的用户将部分模型卸载到 GPU 上，从而允许他们以 GPU 速度运行部分模型（请注意，这不会降低 RAM 要求，只会提高您的生成速度）。","模型有不同的大小，根据其训练所用的参数数量命名。您会看到像 7B、13B、30B、70B 等名称。您可以将这些视为模型的大脑尺寸。同一模型系列的 13B 模型将比 7B 模型更强大：它们在相同的数据上训练，但更大的大脑可以更好地保留知识并更连贯地思考。更大的模型也需要更多的 VRAM/RAM。","有几种不同程度的量化（8 位、5 位、4 位等）。程度越低，模型退化越严重，但硬件要求也越低。因此，即使在较差的硬件上，您也可能运行所需模型的 4 位版本。甚至还有 3 位和 2 位量化，但在这一点上，您是在做无用功。还有进一步的量化子类型，名为 k_s、k_m、k_l 等。k_m 比 k_s 更好，但需要更多资源。","上下文大小（在模型丢弃部分内容之前，您的对话可以持续多长时间）也会影响 VRAM/RAM 需求。幸运的是，这是一个可配置的设置，允许您使用较小的上下文来减少 VRAM/RAM 需求。（注意：基于 Llama2 的模型的上下文大小为 4k。Mistral 宣传为 8k，但实际上是 4k。）","在 2023 年的某个时候，NVIDIA 更改了他们的 GPU 驱动程序，因此如果您需要的 VRAM 超过 GPU 所具有的，任务不会崩溃，而是开始使用常规 RAM 作为后备。这会破坏 LLM 的书写速度，但模型仍然有效并提供相同质量的输出。幸运的是， 可以禁用 此行为。","鉴于以上所有，硬件要求和性能完全取决于模型系列、模型类型、模型大小、量化方法等。"]},{"l":"模型大小计算器","p":["您可以使用 Nyx 的模型大小计算器 来确定您需要多少 RAM/VRAM。","请记住，您希望运行能够放入内存中的最大、量化程度最低的模型，即不会导致 磁盘交换。"]},{"l":"\uD83D\uDCE5 下载 LLM","p":["要开始使用，您需要下载一个 LLM。查找和下载 LLM 最常见的地方是 HuggingFace。有数千个模型可用。查找 GGUF 模型的一个好方法是查看 bartowski 的帐户页面： https://huggingface.co/bartowski。如果您不想要 GGUF，他会链接到原始模型页面，您可能在那里找到同一模型的其他格式。","在给定模型页面上，您会找到一大堆文件。","您可能不需要全部！对于 GGUF，您只需要 .gguf 模型文件（通常为 4-11GB）。如果您找到多个大文件，这通常是同一模型的所有不同量化版本，您只需要选择一个。","对于 .safetensors 文件（可以是 GPTQ 或 AWQ 或 HF 量化或未量化），如果您在文件名中看到数字序列，如 model-00001-of-00003.safetensors，那么您需要所有这 3 个 .safetensors 文件 + 存储库中的所有其他文件（分词器、配置等）才能获得完整模型。","截至 2024 年 1 月，Mixtral MOE 8x7B 被广泛认为是本地 LLM 的最新技术水平。如果您有 32GB RAM 来运行它，一定要试试。如果您的 RAM 少于 32GB，那么请使用 Kunoichi-DPO-v2-7B，尽管其尺寸小，但一开始就表现出色。"]},{"l":"下载 Kunoichi-DPO-v2-7B 的演练","p":["我们将在本指南的其余部分使用 Kunoichi-DPO-v2-7B 模型。这是一个基于 Mistral 7B 的优秀模型，只需要 7GB RAM，并且性能远超其重量级别。注意：Kunoichi 使用 Alpaca 提示格式。","访问 https://huggingface.co/brittlewis12/Kunoichi-DPO-v2-7B-GGUF","点击 'Files and versions'。您将看到列出了几个文件。这些都是同一个模型，但提供了不同的量化选项。点击文件 'kunoichi-dpo-v2-7b.Q6_K.gguf'，这为我们提供了 6 位量化。","点击 'download' 按钮。您的下载应该开始。"]},{"l":"如何识别模型类型","p":["像 TheBloke 这样的优秀模型上传者会给出描述性名称。但如果没有：","文件名以 .gguf 结尾：GGUF CPU 模型（废话）","文件名以 .safetensors 结尾：可能是未量化的，或 HF 量化的，或 GPTQ，或 AWQ","文件名是 pytorch-***.bin：同上，但这是一种较旧的模型文件格式，允许模型在加载时执行任意 Python 脚本，被认为是不安全的。如果您信任模型创建者或别无选择，仍然可以使用它，但如果有选择，请选择 .safetensors。","存在 config.json？查看它是否有 quant_method。","q4 表示 4 位量化，q5 是 5 位量化，等等","您看到像 -16k 这样的数字？那是增加的上下文大小（即在模型忘记您聊天开头之前，您的对话可以持续多长时间）！请注意，更高的上下文大小需要更多的 VRAM。"]},{"l":"\uD83D\uDDA5️ 安装 LLM 服务器：Oobabooga 或 KoboldAI","p":["现在 LLM 已在您的 PC 上，我们需要下载一个工具，作为 SillyTavern 和模型之间的中间人：它将加载模型，并将其功能作为本地 HTTP Web API 公开，SillyTavern 可以与之通信，就像 SillyTavern 与 OpenAI GPT 或 Claude 等付费网络服务通信一样。您使用的工具应该是 KoboldAI 或 Oobabooga（或其他兼容工具）。","本指南涵盖了两个选项，您只需要一个。","如果您在 Docker 上托管 SillyTavern，请使用 http://host.docker.internal:\\<端口> 而不是 http://127.0.0.1:\\<端口>。这是因为 SillyTavern 从运行在 Docker 容器中的服务器连接到 API 端点。Docker 的网络堆栈与主机的网络堆栈是分开的，因此不回环接口不共享。"]},{"l":"下载和使用 KoboldCpp（无需安装，GGUF 模型）","p":["访问 https://koboldai.org/cpp，您将在那里看到最新版本以及可以下载的各种文件。 在撰写本文时，他们列出的最新 CUDA 版本是 cu12，它在现代 Nvidia GPU 上运行最佳，如果您有旧 GPU 或不同品牌，可以使用常规的 koboldcpp.exe。如果您的 CPU 较旧，KoboldCpp 在尝试加载模型时可能会崩溃，在这种情况下，请尝试 _ oldcpu 版本，看看是否能解决您的问题。","KoboldCpp 不需要安装，一旦启动 KoboldCpp，您将立即能够使用 Model 字段旁边的 Browse 按钮选择您的 GGUF 模型，例如上面链接的模型。","默认情况下，KoboldCpp 以最大 4K 上下文运行，即使您在 SillyTavern 中设置得更高，如果您希望以更高的上下文运行模型，请确保在启动模型之前调整此屏幕上的上下文滑块。请记住，更大的上下文大小意味着更高的（视频）内存要求，如果您将此设置得太高或加载对于系统过大的模型，KoboldCpp 将自动开始使用您的 CPU 来处理无法放入 GPU 的层，这将慢得多。","单击 Launch，如果一切顺利，将打开一个新的网页，其中包含 KoboldAI Lite，您可以在其中测试是否一切正常。","打开 SillyTavern 并单击 API Connections（顶部栏中的第二个按钮）","将 API 设置为 Text Completion，将 API Type 设置为 KoboldCpp。","将服务器 URL 设置为 http://127.0.0.1:5001/ 或 KoboldCpp 给您的链接（如果它没有运行在同一系统上）（您可以激活 KoboldCpp 的 Remote Tunnel 模式以获得可以从任何地方访问的链接）。","单击 Connect。它应该成功连接并检测到 kunoichi-dpo-v2-7b.Q6_K.gguf 作为模型。","与角色聊天以测试其是否正常工作。"]},{"l":"优化 KoboldCpp 速度的技巧","p":["Flash Attention 将有助于减少内存需求，根据您的系统，它可能更快或更慢，并且允许您比默认情况在 GPU 上容纳更多层。","KoboldCpp 在猜测层时会为其他软件留出一些空间以防止问题，如果您打开的程序很少并且无法将模型完全放入 GPU，您也许可以添加一些额外的层。","如果模型对于上下文大小使用了太多内存，您可以通过量化 KV 来减少这种情况。这会降低输出的质量，但可以帮助您在 GPU 上放置更多层。为此，请转到 KoboldCpp 中的 Tokens 选项卡，然后禁用 Context Shifting 并启用 Flash Attention。这将解锁 Quantized KV Cache 滑块，数字越小意味着内存使用越少/模型智能越低。","在运行 KoboldCpp 的系统较慢，处理提示需要很长时间？当您避免使用 Lorebooks、随机化或其他动态更改输入的功能时，Context Shifting 效果最佳。保持启用上下文切换 KoboldCpp 将帮助您避免长的重新处理时间。"]},{"l":"安装 Oobabooga","p":["这是一个更正确/更傻瓜式的安装过程：","git clone https://github.com/oobabooga/text-generation-webui（或在浏览器中将他们的仓库下载为 .zip，然后解压）","运行 start_windows.bat 或适合您操作系统的任何文件","当被问到时，选择您的 GPU 类型。即使您打算使用 GGUF/CPU，如果您的 GPU 在列表中，现在选择它，因为它将为您提供稍后使用称为 GPU 分片的速度优化选项（无需从头重新安装）。如果您没有游戏级 dGPU（NVIDIA、AMD），请选择 None。","等待安装完成","将 kunoichi-dpo-v2-7b.Q6_K.gguf 放入 text-generation-webui/models","打开 text-generation-webui/CMD_FLAGS.txt，删除里面的所有内容并写入：--api","重新启动 Oobabooga","访问 http://127.0.0.1:5000/docs。它是否加载了一个 FastAPI 页面？如果没有，您在某处搞错了。"]},{"l":"在 Oobabooga 中加载我们的模型","p":["在浏览器中打开 http://127.0.0.1:7860/","单击 Model 选项卡","在下拉列表中，选择我们的 Kunoichi DPO v2 模型。它应该已自动选择 llama.cpp 加载器。","（可选）我们之前多次提到“GPU 卸载”：这就是此页面上的 n-gpu-layers 设置。如果您想使用它，请在加载模型之前设置一个值。作为基本参考，将其设置为 30 对于 13B 及更小的模型仅使用不到 6GB 的 VRAM。（它随模型架构和大小而变化）","单击 Load"]},{"l":"配置 SillyTavern 与 Oobabooga 通信","p":["单击 API Connections（顶部栏中的第二个按钮）","将 API 设置为 Text Completion","将 API Type 设置为 Default (Oobabooga)","将服务器 URL 设置为 http://127.0.0.1:5000/","单击 Connect。它应该成功连接并检测到 kunoichi-dpo-v2-7b.Q6_K.gguf 作为模型。","与角色聊天以测试其是否正常工作"]},{"l":"\uD83C\uDF89 结论","p":["恭喜，您现在应该拥有一个正常工作的本地 LLM 了。"]}],[{"l":"\uD83D\uDCAC 聊天补全"},{"l":"各来源具体说明","p":["大多数 API 平台仅在创建时允许查看一次生成的 API 密钥。如果丢失，您将需要生成一个新密钥。请务必妥善保管！"]},{"l":"OpenAI","p":["使用 OpenAI 的开发平台访问各种 OpenAI 模型，包括 gpt-4o、gpt-4.1、o3 等。","如何获取 API 密钥：","前往 OpenAI 并登录。","使用“ 查看 API 密钥”选项创建新的 API 密钥。"]},{"l":"Claude","p":["Claude 是由 Anthropic 开发的一系列 AI 模型。您可以通过 Anthropic 控制台访问 Claude 模型。","如何获取 API 密钥：","前往 Anthropic 控制台 并登录。","使用“ 获取 API 密钥”部分创建新的 API 密钥。"]},{"l":"Mistral AI","p":["Mistral AI 是一个团队，以高科学标准和对开放性的关注开发开源和专有模型。您可以在本地运行他们的模型，或通过他们的 API 服务 La Plateforme 来使用。","如何获取 API 密钥：","第一步是在 La Plateforme 上创建一个帐户。","完成后，您可以选择一个 计划 并设置您的付款信息或选择免费套餐。","接下来，您可以创建您的 API 密钥。您可能需要等待几分钟密钥才会生效！"]},{"l":"DeepSeek","p":["DeepSeek 平台通过 API 提供对最新 DeepSeek 模型的访问。他们提供一系列模型，包括 DeepSeek V3 和 DeepSeek R1。","如何获取 API 密钥：","在 DeepSeek 平台 上注册。","注册并为帐户充值后，您可以在“ API 密钥”部分创建 API 密钥。"]},{"l":"AI21","p":["AI21 Labs 提供一系列 AI 模型，包括其旗舰 Jamba 系列。您可以通过 AI21 Studio API 访问他们的模型。","如何获取 API 密钥：","前往 AI21 Studio 并登录。","导航到“Settings => API Keys”部分以创建新的 API 密钥。"]},{"l":"Cohere","p":["Cohere 提供一套用于各种任务的 AI 模型，包括文本生成和嵌入。您可以通过 Cohere API 访问他们的模型。","如何获取 API 密钥：","前往 Cohere 并登录。","导航到您帐户设置中的“ API 密钥”部分以创建新的 API 密钥。"]},{"l":"Perplexity","p":["Perplexity AI 通过其 API 提供对支持在线的 Sonar 模型的访问，用于实时研究和信息检索。","官方入门指南： Perplexity 快速入门","如何获取 API 密钥：","前往 Perplexity 并登录。","前往“ API 计费”部分购买 API 使用额度。","导航到设置中的“ API 密钥”部分以创建新的 API 密钥。"]},{"l":"Fireworks AI","p":["Fireworks AI 是一个高性能平台，提供快速、经济高效的最新开源语言模型访问。该平台提供具有 OpenAI 兼容 API 的无服务器部署，并支持高达 256,000 tokens 的上下文窗口。","如何获取 API 密钥：","前往 Fireworks AI 创建帐户或登录。","导航到您帐户设置中的 API 密钥页面。","单击“Create API key”并提供描述性名称（例如“SillyTavern”）。"]},{"l":"自定义 OpenAI 兼容端点","p":["请注意，对于您可能遇到的任何问题，我们不提供支持！ 我们不保证与每个可能的 API 端点的兼容性！","如果您打算使用此功能来使用本地端点，如 TabbyAPI、Oobabooga、Aphrodite 或任何类似的端点，您可能需要查看 对这些端点的内置兼容性支持。自定义端点功能主要用于与其他服务和程序交互，这些服务和程序公开了 OpenAI 兼容的 API 聊天补全端点。","大多数文本补全 API 支持比 OpenAI 标准允许的更强大的自定义选项。这些更强大的自定义选项，例如 Min-P 采样器，可能值得 SillyTavern 用户探索，可以极大地提高生成质量。","您可以为聊天补全后端配置一个替代端点。此自定义端点可以连接到任何支持通用 OpenAI API 架构的服务器。","兼容后端的示例包括：","LM Studio","LiteLLM","LocalAI"]},{"l":"连接","p":["要访问此功能：","切换到 'Chat Completion' API 类型","在 'Chat Completion Source' 中选择 'Custom (OpenAI-compatible)'","输入自定义端点 URL 以及所需的 API 密钥（如果需要）。例如，TabbyAPI 需要 API 密钥进行身份验证。","提示： 如果遇到连接问题，请尝试在端点 URL 末尾添加 /v1。请 不要 添加 /chat/completions 后缀。"]},{"l":"选择模型","p":["如果自定义 API 实现了 /v1/models 端点以提供可用模型列表，您可以从下拉列表中选择。否则，请使用文本字段手动输入模型 ID。","选中“Bypass API status check”以阻止 SillyTavern 就非功能性 API 端点发出警报。如果您的 API 端点工作正常但 SillyTavern 持续显示警告，请启用此选项。","点击“Test Message”通过向模型发送简单提示来验证连接性。"]},{"l":"提示词后处理","p":["注意： 当使用“无工具 (no tools)”的后处理选项时，不支持工具调用 (Tool Calling)！","某些端点可能对传入提示的格式有特定限制，例如仅允许一条系统消息或严格交替的角色。","SillyTavern 提供内置的提示转换器来帮助满足这些要求（从限制最少到最严格）：","无 (None) - 除非 API 严格要求，否则不应用显式处理","合并来自同一角色的连续消息 (Merge consecutive messages from the same role)","半严格 (Semi-strict) - 合并角色并仅允许一条可选的系统消息","严格 (Strict) - 合并角色，仅允许一条可选的系统消息，并且要求第一条消息必须是用户消息","单条用户消息 (Single user message) - 将所有角色的所有消息合并为一条用户消息","合并 (Merge)、半严格和严格模式还会从提示中删除任何工具调用，除非选择了“带工具 (with tools)”的变体。这对于不支持工具调用的 API 以及您现有提示中包含工具调用的情况非常有用。","限制较少的选项对 SillyTavern 中实现的限制更严格的端点（“自定义 OpenAI 兼容”端点除外）没有影响；自定义端点可能会在请求无效时报错。","在严格模式下，如果第一条助手消息之前不存在用户消息，则将插入 config.yaml 中的 promptPlaceholder，默认情况下是“[开始新聊天]”。"]}],[{"l":"\uD83D\uDD17 OpenRouter","p":["OpenRouter 既可作为文本补全 (Text Completion) 源，也可作为聊天补全 (Chat Completion) 源。所有模型都可通过任一 API 使用，但它们的功能可能因您选择的 API 类型而异。例如，内联图像 (image inlining) 和工具调用 (tool calling) 仅适用于聊天补全 API。","不想注册十几个 API 服务，但仍想访问所有最新模型？使用 OpenRouter。","OpenRouter 的工作原理是让您使用单个端点访问 DeepSeek、Claude 和 Gemini 等模型，所有这些都在一个服务中，共享信用额度。","它提供免费试用（约 1 美元），之后是付费访问。没有订阅费或月租费——您只需为实际使用的内容付费。某些模型提供免费访问，但有每日请求次数限制。","要永久访问免费模型并获得慷慨的每日限制，您需要 一次性 购买至少 10 美元的信用额度。","详见 OpenRouter 常见问题页面。","创建 OpenRouter 帐户： openrouter.ai","OpenRouter 模型列表","OpenRouter-连接面板","从上到下（见上图）：","选择 'Chat Completion' API。","选择 OpenRouter 作为来源。","点击 \"Authorize\" 使用 OAuth 流程获取密钥。或者，在此处 生成 API 密钥 并将其粘贴到框中。","点击 \"Connect\" 并选择一个模型。","（可选）使用 \"Test Message\" 按钮验证您的连接。"]}],[{"l":"\uD83C\uDFAD DreamGen","p":["DreamGen 是一款专注于 AI 驱动创意写作的应用与 API 服务。它提供免费层级，以及付费订阅，允许无限次访问其专为可引导式 AI 辅助写作而打造的高质量自研文本生成模型。请先创建帐户以开始使用： https://dreamgen.com/。","（免费）信用额度会在每个日历月初重置。请查看 定价 了解各模型的信用成本，并查看 使用情况 了解您的剩余信用额。"]},{"l":"\uD83D\uDD17 连接 DreamGen"},{"l":"获取 API 密钥","p":["前往 DreamGen API 密钥 页面，点击 \"New API Key\" 按钮。确保将 API 密钥复制到剪贴板。","创建新的 DreamGen API 密钥 复制 DreamGen API 密钥"]},{"l":"连接步骤","p":["进入 SillyTavern 连接设置。","选择 API：Text Completion","选择 API 类型：DreamGen","输入 API 密钥","（可选）选择一个模型","连接 DreamGen"]},{"l":"\uD83E\uDDE0 模型","p":["DreamGen 提供 opus-v1-sm、 opus-v1-lg 和 opus-v1-xl 模型。模型越大，遵循指令和编写优质故事的能力就越强。"]},{"l":"\uD83C\uDFA8 格式化设置","p":["DreamGen 模型期望特定的输入格式， 此处有详细文档。","SillyTavern 内置了为 DreamGen 制作的预设。请确保使用这些设置作为基线。 这些设置试图尽可能贴近 DreamGen 格式，但由于角色卡的格式不规律，并非总是完美。","进入 \"Advanced Formatting\" 页面。","在 \"Context Template\" 下，根据模型选择 DreamGen Role-Play V1 Llama3 或 DreamGen Role-Play V1 ChatML(*)。","启用 \"Instruct Mode\"。","在 \"Instruct Mode Presets\" 下，选择 DreamGen Role-Play V1 Llama3 或 DreamGen Role-Play V1 ChatML。","DreamGen 上下文设置 DreamGen 指令设置","(*) 何时使用 Llama 3，何时使用 ChatML？截至 2024/06/17， opus-v1-sm 基于 ChatML，所有其他模型基于 Llama3。 运行本地模型时，模板会在模型的 HuggingFace 卡片中指明。"]},{"l":"⚙️ 补全设置","p":["DreamGen 支持：","\"Temperature\"、\"Top P\"、\"Top K\" 和 \"Min P\"","\"Presence Penalty\"、\"Frequency Penalty\" 和 \"Repetition Penalty\"（无范围限制）","\"Min Length\" — 强制模型至少生成 min(min_length, max_tokens) 个 token","良好的起始值可能是：","Min P: 0.05","Temperature: 0.8","Repetition Penalty: 1.1"]},{"l":"\uD83D\uDCA1 格式化提示","p":["DreamGen 模型不同于常规的指令遵循模型（如 OpenAI 的 ChatGPT）。","这些模型经过微调，用于根据提供的描述（通常包括情节描述、风格描述、角色、地点、背景知识等）编写故事。模型还可以在故事中间被 引导，让您成为导演，告诉角色应该做什么或情节应该如何展开。","格式良好的 系统提示 消息如下所示：","注意， 提示应该是故事的描述，而不是关于如何编写故事的指令或指示。 避免使用诸如以下的短语：","\"以...方式编写故事\"","\"确保...\"","等等。","查看更多关于情节、风格和角色描述应该是什么样子的 示例。","默认的 \"DreamGen Role-Play V1\" 模板按以下方式替换不同部分：","## 情节描述： 将包含 {{scenario}} 和 {{wiBefore}}。","## 风格描述： 未提供，您应该在高级设置下的系统提示中添加它，或添加到角色卡中 {{scenario}} 的末尾。此部分可用于影响叙事风格（第一、第二、第三人称）、时态（过去、现在）、细节水平和冗长度等。","## 角色： 将有一个 {{char}} 角色，描述包含 {{description}} 和 {{personality}}，以及一个 {{user}} 角色，描述包含 {{persona}}。"]},{"l":"消息示例和初始消息","p":["DreamGen 模型对上下文非常敏感——它们会很大程度上坚持之前对话轮次中呈现的写作风格（和事实）。 这使得消息示例和初始消息非常重要。"]},{"l":"格式化消息示例","p":["{{mesExamples}} 附加在系统提示的末尾。要充分利用指令格式化，请确保您的示例使用 START 分隔符分隔。例如："]},{"l":"示例","p":["以下是几个为 DreamGen 调整的示例角色卡，考虑了独特的提示方式。这些卡片还利用了上述的 {{mesExamples}}。"]},{"l":"Seraphina","p":["这是对 SillyTavern 默认内置的流行 Seraphina 角色卡的修改。"]},{"l":"Lara Lightland","p":["这是对 Deffcolony 的 Lara Lightland 角色卡的修改。"]},{"l":"❓ 常见问题"},{"l":"我应该使用什么采样器设置？","p":["您可以从这些开始：","温度 (Temperature): 1.0","MinP: 0.05","存在惩罚 (Presence Penalty): 0.1","频率惩罚 (Frequency Penalty): 0.1"]},{"l":"如何使响应更长或更短？","p":["您有几个选项：","在系统提示或模型卡中更改或添加 ## 风格描述：。您可以尝试添加诸如“句子通常较长，叙事详尽描述设置”等内容。","在补全设置中更改 Min Length。","在高级格式化设置下的指令模式中添加 Last Output Sequence，类似于以下内容：","这是一个 Last Output Sequence 的示例，可能有助于使模型以更详细的方式响应，使用 Llama 3 模板：","使用 ChatML 模板表达的相同内容：","您可以将其中的文本更改为更适合您的场景或上下文的内容。"]},{"l":"如何阻止模型重复自身？","p":["如果模型重复上下文中的内容，您可以尝试在补全设置中增加“重复惩罚”(Repetition Penalty)，或者尝试重新表述被重复的上下文部分。 如果模型在一条消息中重复自身，您可以尝试增加“存在惩罚”(Presence Penalty) 或“频率惩罚”(Frequency Penalty)。"]},{"l":"如何引导故事？","p":["如果您想指导角色做某事，或将情节引导到某个方向，您可以使用 user 角色（即 |im_start|user 前导符）。","目前，此功能并未原生地整齐集成到 SillyTavern 中，但您可以使用上述的 Last Output Sequence 来插入 user（指令）回合。请参见 示例 了解指令应该是什么样子。"]}],[{"l":"\uD83D\uDC09 KoboldCpp","p":["KoboldCpp 是一个用于 GGML 和 GGUF 模型的自包含 API。","Nyx 制作的这个 VRAM 计算器 会告诉您您的模型大约需要多少 RAM/VRAM。"]},{"l":"Nvidia GPU 快速入门","p":["GPU Layers（GPU 层数）应在您加载模型时已自动填充。暂时保持原样。","KoboldCpp 1.58","下载最新版本： https://github.com/LostRuins/koboldcpp/releases","即使您的 VRAM 较低，也 不要 勾选 Low VRAM。","启动 KoboldCpp。您可能会看到 Microsoft Defender 的弹出窗口，点击 Run Anyway（仍要运行）。","在 Hardware 选项卡下，勾选 High Priority（高优先级）。","在 Quick Launch 选项卡下，选择模型和您偏好的 Context Size（上下文大小）。","差不多完成了。","恭喜！您完成了！","您应该会看到类似这样的信息：","您现在可以在 SillyTavern 中使用 http://localhost:5001 作为 API URL 连接到 KoboldCpp 并开始聊天。","截至版本 1.58，KoboldCpp 应如下图所示：","本指南假设您使用的是 Windows。","点击 Launch（启动）并等待模型加载。","点击 Save（保存），这样您就不必在每次启动时都配置 KoboldCpp。","选择 Use CuBLAS 并确保 GPU ID 旁边的黄色文本与您的 GPU 匹配。","除非您拥有 Nvidia 10 系列或更旧的 GPU，否则请取消勾选 Use QuantMatMul (mmq)。"]},{"l":"GPU 层数 (GPU Layers)","p":["KoboldCpp 正在工作，但您可以通过确保尽可能多的层被卸载到 GPU 上来提高性能。您应该在终端中看到类似这样的信息：","不要害怕数字；这部分比看起来容易。 CPU buffer size 指的是正在使用的系统 RAM 量。忽略那个。 CUDA0 buffer size 指的是正在使用的 GPU VRAM 量。 CUDA_Host KV buffer size 和 CUDA0 KV buffer size 指的是专用于模型上下文的 GPU VRAM 量。在这种情况下，KoboldCpp 使用了大约 9 GB 的 VRAM。","我有 12 GB 的 VRAM，并且只有 2 GB 的 VRAM 用于上下文，所以我还有大约 10 GB 的 VRAM 剩余来加载模型。因为 9 层使用了大约 7 GB 的 VRAM，并且 7000 / 9 = 777.77，我们可以假设每层使用大约 777.77 MIB 的 VRAM。 10,000 MIB / 777.77 = 12.8，所以我将向下取整，从此使用此模型加载 12 层。","现在根据您的模型、上下文大小和系统 VRAM 进行您自己的计算，然后重新启动 KoboldCpp：","如果您够聪明，您之前点击了 Save，现在您可以使用 Load 加载您之前的配置。否则，选择您之前选择的相同设置。","将 GPU Layers 更改为您新的、经过 VRAM 优化的数字（在我的例子中是 12 层）。","点击 Save 以保存您更新的配置。","您现在应该看到类似这样的信息：","KoboldCpp 使用了我 12 GB VRAM 中的大约 11.5 GB。这应该比 KoboldCpp 自动生成的设置性能好很多。","恭喜！您（真正）完成了！","要更深入地了解 KoboldCpp 设置，请查看 Kalomaze 的 Simple Llama + SillyTavern Setup Guide（简易 Llama + SillyTavern 设置指南）。"]}],[{"l":"\uD83D\uDCD6 NovelAI","p":["NovelAI 是一项付费订阅服务，允许每月无限次访问其高质量的自研文本生成、图像生成和文本转语音模型。在此处注册帐户以开始使用： https://novelai.net/","您将仅获得 50 次免费生成 来评估模型。当出现 “Not eligible for this model”（不符合此模型资格）错误时，这意味着您的试用期已用完，需要订阅付费计划。"]},{"l":"\uD83D\uDD11 API 密钥","p":["要获取您的 NovelAI API 密钥，请按照以下步骤操作：","选择左侧边栏顶部的齿轮图标。 左侧边栏","在“User Settings”（用户设置）下选择“Account”（帐户）。 用户设置","选择“Get Persistent API Token”（获取持久性 API 令牌）。 帐户","选择复制图标将您的 NovelAI API 令牌复制到剪贴板。 持久性 API 令牌"]},{"l":"\uD83E\uDDE0 模型","p":["如果您拥有 Opus 订阅，那么 Erato 是使用的模型。如果您没有 Opus，那么 Kayra 是可用的最佳模型。","Clio 在 Tablet/Scroll 层级上具有更大的上下文大小，但 Kayra 的优势通常可以弥补这种差异。"]},{"l":"⚙️ 设置","p":["设置文件位于此处 ( SillyTavern/data/用户句柄/NovelAI Settings)。 您也可以手动添加自己的设置文件。"]},{"l":"响应长度 (Response Length)","p":["您希望每条消息生成多少文本。请注意，NovelAI 限制每条响应为 150 个 token。"]},{"l":"上下文大小 (Context Size)","p":["在任何给定时间，聊天中有多少 token 保留在上下文中。您可以使用的最大上下文大小取决于模型和您的订阅层级：","Kayra (Tablet) - 3072 tokens","Kayra (Scroll) - 6144 tokens","Erato (Opus 专属), Kayra (Opus) 和 Clio (所有层级) - 8192 tokens"]},{"l":"前言 (Preamble)","p":["紧接在聊天上方插入的文本，用于修改写作风格。推荐的格式是简短标签列表，例如“[Style: chat, detailed, sensory ]”。"]},{"l":"\uD83C\uDF9B️ 预设描述","p":["根据 Novel AI 的说法，以下是默认预设的适用场景。"]},{"l":"Erato","p":["Golden Arrow - 全能型好手。","Wilder - 词汇选择多样性更高，重投之间差异更大，更容易出错。","Zany Scribe - 避免错误和重复。优先使用更复杂的词汇。","Dragonfruit - 语言多样且复杂，重复少。错误和矛盾更频繁。","Shosetsu - 专为日语写作设计。也适用于英语。"]},{"l":"Kayra","p":["Asper - 用于创意写作。期待意想不到的转折。","Carefree - 全能型好手","Fresh-Coffee - 保持正轨。很好地处理指令。","Pro_Writer - 模仿畅销小说的节奏和感觉","Stelenes - 更可能选择合理的替代方案。重试时多样性高。","Tea_Time - 一旦开始就会很好。","Writers-Daemon - 极富想象力，有时过于天马行空。"]},{"l":"Clio","p":["Edgewise - 能很好地处理各种生成风格","Fresh Coffee - 保持正轨。","Long-Press - 旨在用于创意散文。","Talker Chat - 专为聊天风格生成而设计。","Vingt-Un - 一个很好的全能默认值，偏向散文。"]},{"l":"\uD83D\uDCA1 在 SillyTavern 中使用 NovelAI 的技巧和常见问题解答","p":["从另一个 ST 后端 API 切换到 NovelAI 时，会出现许多常见问题和疑问。差异在于模型的训练目的。很可能，您使用的是 OpenAI 或 Anthropic 模型（或类似这些的本地模型），它们围绕遵循用户指令构建。而 NovelAI 的模型纯粹围绕文本补全构建：NAI 的模型不是将您的输入视为消息并制定响应，而是尝试继续传入的提示。由于这种差异，许多适用于其他 API 的技巧和常识对 NAI 无效。"]},{"l":"为 NovelAI 调整设置","p":["在高级格式化（A 图标）下：","将“Context Template”（上下文模板）设置为“NovelAI”","将“Tokenizer”（分词器）设置为“Best match”（最佳匹配）","勾选“Always add character's name to prompt”（始终将角色名称添加到提示中）","勾选“Collapse Consecutive Newlines”（合并连续换行符）","取消勾选“Instruct Mode”（指令模式）下的“Enabled”（启用）框","在用户设置（带齿轮的人像）下：","打开“Swipes”（滑动）（非 NAI 特定，但非常有用，您应该打开它）"]},{"l":"为 NovelAI 构建/调整角色卡","p":["为了优化您的角色卡以适应 NovelAI，有几种推荐的方法来编写角色描述：散文 (prose) 和属性 (attributes)。","散文简单到让人觉得不应该有效：“Sylpheed 是一个看起来年轻但实际上有 900 岁的精灵。她身材娇小，留着长长的白色头发，在她编成的侧马尾中渐变成绿色梯度，还有翡翠绿色的十字形眼睛。[...]” 不，真的，就是这样。只需用普通的句子写出角色的外貌、行为等，AI 就会捕捉到它。","如果您不相信自己的写作能力，或者想要一种更结构化的方法，您可以使用属性方法，该方法存在于 NovelAI 的训练数据中。这作为一个简单的列表，包含不同类型的角色特征。以下是一系列经过测试对 NovelAI 模型有效的可能属性：","“Type: character”用于告诉 AI 这是在描述一个角色（与地点、物体或其他类型的事物相对）。其余属性是可选的，有些是冗余的（例如，Personality、Mind 和 Mental 基本上意思相同），但这些已经过测试并且与 NovelAI 的模型配合良好。填写与您的角色相关的任何属性。属性应使用小写并用逗号分隔，单词不需要加引号。例如：","推荐这些方法是因为它们存在于 NovelAI 的训练数据中，因此它们特别适合该模型。"]},{"l":"示例角色卡","p":["以下是几个为 NovelAI 制作的示例角色卡，展示了为 NovelAI 创建角色卡的不同方式。第一张卡 Valka 使用属性方法进行角色描述，而第二张卡 Eris 使用散文描述，以及大量的示例对话。","Valka","Eris"]},{"l":"不该做什么","p":["大多数现有的角色卡格式都不适合 NovelAI。它们会给出一些结果，甚至是一些好的结果，但它们有很多问题。W++ 是最大的问题之一，它不像 NovelAI 模型训练过的任何东西，并且它持续使用括号/大括号/引号会消耗大量 token，使卡片大小膨胀而没有真正的好处。","在未内置到 NovelAI 的现有格式中，AliChat 是最有可能工作的格式，因为它依赖于使用示例消息来同时传递有关角色及其声音的信息，并以您希望 AI 输出的消息类型格式呈现。","对于大多数其他格式，由于它们通常是列出特定角色不同特征的方式，因此可以相当直接地转换为属性方法。"]},{"l":"我应该使用哪个模块？(Module)","p":["可能选择“No Module”（无模块）。如果您希望角色以更华丽的方式说话，Prose Augmenter 很有用，但注意不要过度使用。Text Adventure 可能对文本冒险风格的角色卡/故事有用。"]},{"l":"不用指令模块 (Instruct module) 吗？","p":["您可以在需要时调用指令模块。在消息中创建一个新行，并将您的指令放在花括号中，像这样：{ 角色名对被看似无害的陈述冒犯了 }（文本和括号之间的空格是 必需的）。这样做会自动将 AI 短暂切换到指令模块。您不希望一直使用指令模块，因为它往往比其他模块产生的输出创造力较低，仅在您需要强烈引导 AI 朝特定方向发展时使用。"]},{"l":"为什么我的响应总是被截断？","p":["NovelAI 将响应长度限制在总共约 150 个 token，即使您将滑块设置得更高。当达到滑块中的 token 数或 150（取较低者）时，它会再生成最多 20 个 token，寻找停止序列或句子结尾，因此响应的有效限制是 170 个 token，此时它会停止，导致截断。","如果被截断，您可以选择继续选项（文本框左侧的三行菜单中）让角色继续他们的响应。","如果您经常需要超过 170 个 token 的响应，可以像这样绕过限制：","将响应长度保持在 150 个 token。","在高级格式化下，启用自动继续 (Auto-continue)。","将“目标长度”(Target length) 设置为所需长度。","这将把多次生成链接在一起，为您提供更长的消息，但如果模型决定停止，则不能保证回复 100% 是所需长度。"]},{"l":"如何让机器人写出更长的响应？","p":["阅读上面关于响应被截断的内容。这将有助于确保响应不会因达到生成长度限制而提前截断。","如果您的响应没有被截断但仍然太短，很可能您遇到的是“垃圾进，垃圾出”——如果您给模型提供糟糕的示例，它将产生糟糕的输出。如果角色卡没有示例对话或示例对话很短，并且您发送给机器人的消息很短，模型会捕捉到这一点，将其视为可接受的方式，响应就会很短。所以，编写更长的示例对话和发送给机器人的更长的消息。（您总是可以使用 NovelAI 为您编写一些示例对话，而不是自己动手。）"]},{"l":"如何让机器人停止替我说话？","p":["检查角色卡的第一条消息和示例对话是否不包括角色为您采取行动——如果包括，则重写它们以消除替您行动的部分","确保“Always add character's name to prompt”（始终将角色名称添加到提示中）已勾选","确保您当前使用的用户角色 (user persona) 与聊天的其余部分相同。如果您更改了用户角色但没有改回来（或者没有将角色锁定到该聊天），阻止替您生成的通常规则将失效","将 [\"\\n{{user}}:\"] 添加到自定义停止字符串 (Custom Stopping Strings)（应该不是必须的，但有时有帮助）"]},{"l":"为什么我的角色没有响应？","p":["很多事情都可能导致这种情况，所以我们需要检查几个地方：","确保在高级格式化中勾选了“Always add character's name to prompt”（始终将角色名称添加到提示中）","检查确保没有来自 API 的错误。虽然您可以在 NAI 免费试用期间使用 SillyTavern，但一旦试用结束，您只会收到错误","检查“Custom Stopping Strings”（自定义停止字符串）中的内容——如果这些在响应开始时被生成，它可能会提前截断"]},{"l":"我应该如何使用作者笔记 (Author's Note)？","p":["一般来说，您可能不应该使用它。它被插入到非常接近上下文末尾的位置，对于 NAI 的模型，它经常压倒上下文中的所有其他内容。它主要是来自较旧、较弱模型的产物，那时它更必要。"]},{"l":"如何进行场景分隔/时间跳跃？(scene break/time jump)","p":["将以下内容作为系统消息或放在您下一条消息开头的新行上：","然后将消息的其余部分放在下一行。括号中的文本可以是时间跳跃、新地点或任何其他内容。“***”（滑稽地称为“dinkus”）告诉 AI 场景已经改变，括号中的文本为此提供了更多上下文。"]},{"l":"AI 不断重复特定的单词/短语，我该怎么办？","p":["如上所述，您可以将重复惩罚 (repetition penalty) 滑块推高一点，不过推得太远可能会使输出变得不连贯。 要更彻底地解决问题，请回溯上下文，尤其是最近的消息，并删除重复的单词/短语。将其从上下文中移除会使 AI 没有理由开始说它。"]}],[{"l":"\uD83E\uDD16 AI Horde（AI 群）"},{"l":"⚠️ 免责声明","p":["AI Horde 是一个完全由志愿者运营的、众包式的分布式 GPU 集群。","默认情况下，您的输入是匿名发送的，运行 Horde Worker 的人员无法看到响应。","但是，由于它是一个开源程序，恶意工作者 (Malicious Workers) 可能会修改代码以：","记录您的活动（输入提示词、AI 响应）。","产生不良或冒犯性的响应。","使用 Horde 时， 切勿发送 任何个人信息，例如姓名、电子邮件地址等。","打开“仅受信任工作者 (Trusted Workers Only)”复选框将把可用工作者的选择限制为那些已在 Horde 上托管一段时间且通常被认为是可信的工作者。但他们仍然可能看到提示词，例如通过使用未经验证的软件进行托管。","为了帮助减少此问题，SillyTavern 内置了以下功能：","当聊天响应由 Horde Worker 生成时，SillyTavern 会记录该工作者的 ID 以及他们使用的模型。","将鼠标光标悬停在聊天项目上即可看到此信息（见下图）。","如果您认为收到了恶意响应，可以将此信息传递给 AI Horde Discord 上的 Horde 管理员，以供审查并可能对该工作者采取纪律处分。","Horde 工作者信息弹出窗口"]},{"l":"⚙️ 设置","p":["SillyTavern 能够开箱即用地与 Horde 连接，无需任何额外设置。","在 ST API 面板的 API 下拉选择器中选择 'AI Horde'。","从面板底部的模型选择器中选择一个或多个模型（角色的“AI 大脑”）。","选择一个角色并开始聊天。","ST Kobold Horde API 连接面板","默认情况下，您的 SillyTavern 实例连接到 Horde 的低优先级“访客帐户”。 这意味着您可能需要等待很长时间才能收到回复。 要减少等待时间，请遵循下面的提示。"]},{"l":"\uD83D\uDCA1 提示","p":["在 Horde 网站上注册一个帐户，然后将您的 Horde 密钥添加到 SillyTavern 的 Horde API Key 框中。","设置一个 Horde Worker 来为他人提供您的 GPU 算力。","让他人使用您的 GPU 可以为您赚取 'Kudos'，一种 Horde 专属的积分。","您的帐户拥有的 Kudos 越多，您从其他 Horde Worker 获得聊天响应的速度就越快。","Kudos 也可用于在 Stable Horde 上创建 AI 图像。","SillyTavern 开箱即用地支持 Stable Horde 图像生成。","如果您的 GPU 不够强大无法运行 AI，或者您没有电脑，您仍然可以 通过多种方式参与 Horde 社区来赚取 Kudos。"]}],[{"l":"\uD83E\uDD16 Google Gemini","p":["Gemini 是谷歌尖端的多模态大语言模型 (LLM)，可通过多个 API 使用，包括 Google Vertex AI 和 Google AI Studio（前身为 MakerSuite）。本指南将帮助您在 SillyTavern 中设置 Gemini API 连接。"]},{"l":"\uD83C\uDFA8 Google AI Studio","p":["AI Studio 是尝试最新 Google AI 模型最快、最用户友好的方式，无需设置 Google Cloud Platform (GCP) 项目。它提供一个简单的 API 密钥，您可以用它来访问 Gemini 模型。"]},{"l":"步骤 1：创建 Google AI Studio 密钥","p":["转到 Google AI Studio 页面并使用您的 Google 帐户登录。","点击 \"Get API Key\"，接受条款和条件。","点击 \"Create API Key\" 以生成您的 API 密钥。","将 API 密钥复制到剪贴板。"]},{"l":"步骤 2：将 API 密钥放入 SillyTavern","p":["在 SillyTavern 中，转到 \"API Connections\" 页面。","选择 \"Chat Completion\" 作为 API 类型。","从下拉菜单中选择 \"Google AI Studio\"。","将您之前复制的 API 密钥输入到 \"API Key\" 文本框中。","点击 \"Connect\" 按钮保存密钥。","您现在应该能够在 SillyTavern 中使用 Google AI Studio API。"]},{"l":"☁️ Google Vertex AI","p":["Vertex AI 是 Google Cloud Platform (GCP) 提供的一项服务。它提供对各种 AI 模型的访问，包括 Gemini 系列。","Vertex AI API 有几种设置方式，可用模型可能因使用的方法而异。"]},{"l":"服务帐户 (Service Account)","p":["Google Cloud Platform (GCP) 需要服务帐户来访问 Vertex AI，简单的 API 密钥将不起作用。将从服务帐户 JSON 文件生成一个令牌，该令牌随后将用于验证对 Vertex AI API 的请求。","您可以通过以下步骤创建服务帐户：","先决条件：","您必须拥有 Google Cloud Platform (GCP) 帐户。","您必须在您的 GCP 帐户中创建一个项目。","您必须为该项目启用计费。"]},{"l":"步骤 1：启用 Vertex AI API","p":["在您的密钥生效之前，必须为您的项目启用该 API。","转到 Google Cloud Console： https://console.cloud.google.com/","确保在顶部栏中选择了正确的项目。","导航到 Vertex AI API 页面： https://console.cloud.google.com/apis/library/aiplatform.googleapis.com","如果尚未启用，请点击 \"Enable\" 按钮。"]},{"l":"步骤 2：创建服务帐户","p":["这是将用于访问 Vertex AI API 的身份。","在 Google Cloud Console 中，导航到 \"Service Accounts\" 页面。您可以在顶部搜索栏中搜索它或使用此直接链接： https://console.cloud.google.com/iam-admin/serviceaccounts","选择您的 GCP 项目并点击 \"+ CREATE SERVICE ACCOUNT\"。","服务帐户名称：给它一个描述性名称，例如 my-vertex-ai-client。","点击 \"CREATE AND CONTINUE\"。","授予此服务帐户对项目的访问权限：在 \"Role\" 下拉列表中，搜索并选择 Vertex AI User。此角色授予运行模型所需的权限，而不会授予过多的访问权限。","点击 \"CONTINUE\"，然后点击 \"DONE\"。"]},{"l":"步骤 3：生成 JSON 密钥","p":["这是您需要的“密码”文件。它包含敏感信息，因此不要共享它或将其上传到任何公共地方。","您现在应该回到服务帐户列表。找到您刚刚创建的帐户（例如，sillytavern-vertex-ai）。","点击该行最右侧的三点菜单 (⋮) 并选择 \"Manage keys\"。","点击 \"ADD KEY\" -> \"Create new key\"。","确保密钥类型设置为 JSON。","点击 \"CREATE\"。","一个 .json 文件将立即下载到您的计算机。请妥善保管，因为此密钥丢失后无法恢复。"]},{"l":"步骤 4：将 JSON 内容放入 SillyTavern","p":["您下载的 JSON 文件包含验证 Vertex AI API 所需的所有信息。它看起来像这样：","使用简单的文本编辑器（如 Windows 上的 Notepad、Mac 上的 TextEdit 或 VS Code）打开您刚刚下载的 .json 文件。","选择文件中的所有文本（Ctrl+A 或 Cmd+A）。","将文本复制到剪贴板（Ctrl+C 或 Cmd+C）。","在 SillyTavern 中，转到 \"API Connections\" 页面，选择 \"Chat Completion\" 作为 API 类型，然后从下拉菜单中选择 \"Google Vertex AI\"。将身份验证方法切换为 \"Service Account\"。","将整个复制的内容粘贴到 \"Service Account JSON Content\" 文本框中。","点击 \"Validate JSON\" 按钮以确保您正确复制了它。","最后，向下滚动并点击 API 设置页面底部的 \"Connect\"。","您现在应该能够在 SillyTavern 中使用 Google Vertex AI API。"]},{"l":"快速模式 (Express Mode)","p":["快速模式是在 Google Cloud 上开始使用生成式 AI 的最快方式。它允许您使用 Gemini API，而无需设置服务帐户。相反，您可以直接使用 API 密钥。","有关更多详细信息，请参阅官方文档： Vertex AI 快速模式概述。"]},{"l":"步骤 1：确保您的帐户有资格使用快速模式","p":["您必须拥有一个之前未用于创建 Google Cloud 项目的 Google 帐户。 如果您有现有的 Google Cloud 项目（包括免费试用），您可以为此目的创建一个新项目。"]},{"l":"步骤 2：激活 Vertex AI 快速模式","p":["转到以下网页： Vertex AI Studio。","点击 \"Try it free\"。","接受条款和条件并使用您的 Google 帐户登录。","选择您的国家/地区并点击 \"Agree & start free\"。等待设置完成。"]},{"l":"步骤 3：创建 API 密钥","p":["验证您的 Google Cloud 控制台是否在快速模式下运行。您应该在页面左上角看到一个横幅。","点击左侧边栏中的 \"API Keys\" 链接。","点击 \"Create API Key\" 按钮。","将生成一个新的 API 密钥。将此密钥复制到剪贴板。"]},{"l":"步骤 4：将 API 密钥放入 SillyTavern","p":["在 SillyTavern 中，转到 \"API Connections\" 页面。","选择 \"Chat Completion\" 作为 API 类型。","从下拉菜单中选择 \"Google Vertex AI\"。","将身份验证方法切换为 \"Express Mode (API Key)\"。","将您之前复制的 API 密钥粘贴到 \"API Key\" 文本框中。","点击 \"Connect\" 按钮保存密钥。","您现在应该能够在 SillyTavern 中使用快速模式的 Google Vertex AI API。"]}],[{"l":"\uD83D\uDE80 Mancer","p":["Mancer 是一项大型语言模型推理服务，允许您运行任何想要的提示词且不审查响应。截至撰写时 (2024-11-28)，大多数模型需要预充值余额才能开始聊天，但也提供了一个免费模型。","模型列表","定价"]},{"l":"\uD83D\uDEE0️ 如何开始","p":["在 mancer.tech 注册一个帐户。","点击 Dashboard（仪表板）并复制您的 API 密钥。","截至 2024年2月27日的 Mancer 仪表板","在 SillyTavern 中，选择 Text Completion API，然后在 API Type 下选择 Mancer。","输入您的 Mancer API 密钥并点击 Connect（连接）。","API 密钥","您现在应该能够与您选择的任何 Mancer 模型聊天了。"]},{"l":"\uD83D\uDCDD 匿名日志记录","p":["如果您不介意您的聊天内容可能被用于训练模型、改进 Mancer 的服务、发布数据集或 他们可能决定进行的任何其他操作，您可以选择加入匿名日志记录，以便在特定模型上享受 25% 的 token 折扣。只需转到您的 Mancer 仪表板 并勾选 Enable Anon. Logging（启用匿名日志记录）即可。"]},{"l":"❓ 支持","p":["还需要帮助？请前往 SillyTavern Discord 的 #mancer 支持频道。"]}],[{"l":"\uD83D\uDE80 TabbyAPI","p":["基于 FastAPI 的应用，支持通过 Exllamav2 后端使用 LLM 生成文本，兼容 Exl2、GPTQ 及 FP16 模型。","GitHub 项目地址"]},{"l":"\uD83D\uDE80 快速开始","p":["按照官方 TabbyAPI GitHub 中的 安装说明 进行操作。","创建 config.yml 配置文件，设置模型路径、默认模型、序列长度等。若无需调整，可忽略大部分（甚至全部）设置。","启动 TabbyAPI。若成功，将看到类似如下界面：","TabbyAPI 终端显示","在 SillyTavern 的文本补全 API 选项中，选择 TabbyAPI。","将 TabbyAPI 终端中的 API 密钥复制到 Tabby API key 字段，并确保 API URL 正确（默认为 http://127.0.0.1:5000）。","若一切正确，SillyTavern 中将显示如下内容：","SillyTavern 配置页","现在即可使用 TabbyAPI 进行对话！"]},{"l":"\uD83D\uDCE6 TabbyAPI 加载器","p":["TabbyAPI 开发者提供了官方扩展，可直接在 SillyTavern 中加载/卸载模型。安装步骤如下：","在 SillyTavern 中点击 Extensions 标签页，进入 Download Extensions & Assets。","将 https://raw.githubusercontent.com/theroyallab/ST-repo/main/index.json 复制到 Assets URL 中，并点击右侧的插件按钮。","界面将显示如下内容。点击 Tabby Loader 旁的下载按钮。","Tabby 加载器资产页","安装成功后，屏幕顶部将显示绿色提示消息。在扩展标签页中进入 TabbyAPI Loader，并将 TabbyAPI 终端中的管理员密钥复制到 Admin Key 字段。","点击 Model Select 旁的刷新按钮。点击下方文本框时，将显示模型目录中的所有模型。","Tabby 加载器扩展界面","现在可直接在 SillyTavern 中加载和卸载模型！"]},{"l":"❓ 支持与帮助","p":["仍需帮助？请访问 TabbyAPI GitHub 获取开发者官方 Discord 服务器链接，并 查阅维基文档。"]}],[{"l":"\uD83D\uDCDD 提示词","p":["当您向 AI 发送消息时，您编写的文本会与其他文本组合成一个单一的请求发送给 AI。这个组合文本称为“提示词”，有时也称为“请求”或“上下文”。","提示词可以包含各种不同类型的文本，包括：","关于 AI 如何生成响应的 主要指令","AI 应承担的 角色定义","您所扮演角色的定义","有关 AI 正在交互的“世界”的 信息","来自 数据库 的相关文档或信息","过去对话的 摘要","网络搜索 或其他 外部数据源 的结果","对话中的先前消息","您发送给 AI 的消息","关于 AI 如何生成响应的 最终指令","这可能需要大量管理！为了帮助您理解如何构建和修改发送给 AI 的请求，SillyTavern 识别了您可能希望包含在提示词中的不同元素。然后，您可以构建提示词，以包含对您与 AI 交互方式有意义的内容。","这些元素中的许多都在您将更改它们的部分中进行了解释。例如，要描述您希望 AI 扮演的角色，您可以使用 角色设计 中的 描述 字段。"]},{"l":"\uD83D\uDC40 查看提示词","p":["阅读发送给 AI 的最终提示词对于理解 AI 被告知了什么以及它为何生成特定响应非常有帮助。您可以通过以下几种方式查看提示词：","使用 AI 回复消息上的“提示词明细”图标","使用 提示词检查器 扩展","检查运行 SillyTavern 的终端窗口中的日志","检查浏览器开发者工具中的控制台"]},{"l":"\uD83D\uDD27 更改提示词的构建方式","p":["以正确的方式向 AI 呈现提示词的所有部分对于获得最佳响应至关重要。您可以控制提示词的构建方式。","使用 高级格式化 面板自定义文本补全 API 的提示词构建。","使用 提示词管理器 自定义聊天补全 API 的提示词构建。"]},{"l":"\uD83E\uDDED 主提示词（系统提示词）","p":["主提示词（或系统提示词）定义了模型需要遵循的一般指令。它为对话设定了基调和上下文。例如，它告诉模型充当 AI 助手、写作伙伴或虚构角色。","系统提示词 是 故事字符串 的一部分，通常是模型接收到的提示词的第一部分。","主提示词是 提示词管理器 中的默认提示词之一。它通常是模型在上下文中接收到的第一条消息，归属于（“由”）系统角色。","默认的主提示词是：","在 {{char}} 和 {{user}} 的虚构聊天中，编写 {{char}} 的下一个回复。","{{char}} 和 {{user}} 占位符会被替换为您在对话中定义的角色和人格的名称。","您可以在主提示词中使用任何受支持的 {{宏}} 标签，以包含可能因对话而异或随着对话进行而变化的信息。"]},{"l":"调整主提示词","p":["默认的主提示词帮助模型理解它应该如何处理后面的角色和人格信息，如何解释过去的对话，以及生成何种响应。它是一个灵活的通用提示词，在许多情况下都工作良好，因为它确立了 AI 是在以角色身份与您的人格进行对话中写作。","但是，您可以调整主提示词以更好地满足您的需求。以下是一些调整主提示词的常见原因：","提供额外指令：例如，您希望 AI 解释其推理、遵循特定规则或避免某些话题","阐明 AI 的角色：例如，您希望 AI 充当叙述者、讲故事的人或向导","更改对话的上下文：例如，您希望 AI 像 AI 助手、文字冒险游戏或写作伙伴一样响应","本指南中的所有示例对其他用户都很有效，但适合您需求和所用模型的提示词可能有所不同。尝试不同的指令和提示风格，看看什么最适合您。如果您不确定该尝试什么，可以随时在 SillyTavern Discord 中寻求帮助。","在主提示词中向 AI 提供额外指令可以帮助它理解您从对话中想要什么。","只写一个回复。至少写一段，最多四段。","启用 Markdown。使用它来格式化您的回复。将代码片段用三个反引号括起来。","用引号书写角色对话。用括号书写 {{char}} 的想法。","您是一个面向 13 至 17 岁用户的动漫角色扮演生成模型。您始终生成有趣、适合年龄的响应。","如实回答，并逐步写出您的思考过程以确保得到正确答案。","AI 更容易遵循关于它应该做什么的指令，而不是它不应该做什么。例如，如果您希望 AI 避免以某种方式写作，最好告诉它您希望它如何写作。虽然*“不要决定 {{user}} 说什么或做什么”* 通常包含在提示词中以防止 AI 控制您的人格，但一些用户发现 “以尊重 {{user}} 自主权的方式编写 {{char}} 的响应” 更有效。","通常有比主提示词更好的地方来包含关于用户或角色的信息、修改角色的写作和说话风格，或提供其他特定指令。主提示词最好用于关于整个对话的一般指令，或关于您想要进行的某种类型的对话。"]},{"l":"消息历史的影响","p":["在调整主提示词以改进 AI 的响应时，请考虑到 AI 从消息历史中获取了大量信息。历史是它对过去事件、角色互动和关系的记忆，以及其词汇选择和写作风格的风格指南。","通过提供展示您希望 AI 如何响应的 示例消息 来利用这一点。展示您想要的内容通常比试图解释它更容易！","当您的对话已有历史时，更改主提示词对 AI 响应的影响有限。在事件和关系方面，AI 假定主提示词发生在遥远的过去，而消息历史会更新它。在写作风格和词汇选择方面，AI 假定历史中的所有消息都是根据 当前 主提示词中的规则生成的，并且它应该继续以相同的方式生成消息。处理此事的一些建议：","将当前指令插入到消息历史的末尾或之后，例如使用 作者注记","通过开始新对话来测试您对主提示词的更改","编辑消息历史以删除或纠正不良行为的示例","使用 历史记录后指令 向 AI 提供最终指令","绝不要让 AI“逃脱”您不希望它做的事情。如果您不喜欢 AI 的响应，不要像它是正确的那样继续对话。相反，修改提示词，重新生成消息，并从那里继续。这将帮助 AI 了解您想要什么。"]},{"l":"移除“虚构聊天”上下文","p":["在某些情况下，“虚构聊天”可能不是您对话的正确上下文。","您可以从主提示词中移除“虚构”上下文：","在 {{char}} 和 {{user}} 的对话中，编写 {{char}} 的下一个回复。","您可能根本不希望 AI 认为自己在进行角色扮演。除了移除角色的概念，您还可以移除 AI 的概念：","您是 {{char}}，一个乐于助人的助手。您提供有用的信息并帮助 {{user}} 解答问题。"]},{"l":"AI 作为叙述者或讲故事者","p":["如果您希望 AI 充当叙述者，从全知视角描述事件，发明自己的角色和设置，该怎么办？","一种方法是为 AI 创建一个命名角色作为叙述者。这个角色可以称为“叙述者”或“AI”，暗示 AI 是一个通用的讲故事者，或者可以以特定场景或设置命名，赋予 AI 在该设置中叙述故事的任务。然后，设置的细节可以在 角色 或 世界信息 中定义。","您需要调整默认的主提示词以反映 AI 的角色。对于通用叙述者，您可以使用：","您是 {{char}}，一个熟练且多才多艺的讲故事者。叙述故事。","或者针对特定设置：","您是一个奇幻场景的叙述者。扮演访问 {{char}} 的角色。","阐明用户在对话中的角色会有所帮助。您的消息是故事的一部分，还是给叙述者关于您角色行为或说话的指令？一个将用户包含在故事中的示例：","故事应通过响应用户 {{user}} 的行为和对话来推进。以第三人称叙述故事。","一个将用户排除在故事之外的示例：","进入冒险模式。根据用户在“>”之后的对话和动作叙述故事。生动详细地描述周围环境。要详细、有创意、冗长和主动。通过引入奇幻元素和有趣角色来推动故事发展。","定义用户的角色不仅有助于 AI 理解如何响应您的消息，还有助于理解它在多大程度上可以控制您的人格。这避免了 AI 为您的人格做出您宁愿自己做的决定的情况。"]},{"l":"\uD83D\uDCCC 历史记录后指令","p":["历史记录后指令 (PHI) 是在主提示词和用户消息之后发送给 AI 的附加指令。它们可用于根据消息历史向 AI 提供额外的上下文或指令。","由于历史记录后指令是在用户消息之后发送的，它们是 AI 在生成响应之前收到的最终指令。AI 通常给予它们比主提示词更高的优先级，并且它们可以覆盖主提示词的指令。","要使用每角色历史记录后指令，请将它们添加到角色的 历史记录后指令 中并启用 偏好角色指令。要在使用角色特定指令的同时保留全局定义的 PHI，您可以在角色的历史记录后指令字段中使用 {{original}} 宏。","历史记录后指令在 高级格式化 面板的系统提示词类别下定义。历史记录后指令作为一个不可见的用户角色注入添加，位于提示词最后一行（通常包含响应消息“头”）之前。请注意，“启用系统提示词”开关必须启用才能应用历史记录后指令（即使系统提示词本身为空）。","历史记录后指令是 提示词管理器 中的默认提示词之一。它通常是模型在上下文中接收到的最后一条消息，归属于（“由”）系统角色。如果您的聊天补全 API 不支持系统角色，它通常会被归属于用户角色。"]},{"l":"➕ 添加到提示词（世界信息）","p":["您可以使用 世界信息 功能在提示词中的任何位置插入附加信息。通过设置信息应何时插入的条件，您可以引导 AI 包含特定细节、更改其响应方式或将新元素添加到对话中。","世界信息的一些常见用途包括：","包含有关世界或设置的信息的“传说书”或“百科全书”","一种管理不同角色和情境的各种系统提示词的方法","一个存储 AI 应在对话中“回忆”的记忆的地方","一个用于创建、编辑和共享角色细节的更模块化的系统","一个随机事件和惊喜的来源，让 AI 做出反应，或者让您做出反应！"]}],[{"l":"\uD83E\uDD14 推理","p":["在语言模型中，推理（也称为模型思考）指的是一种思维链（CoT）技术，通过逐步分析来模拟人类解决问题的方式。SillyTavern 提供了多项功能，使得在使用支持推理的后端时，推理模型的运用更加高效和一致。"]},{"l":"⚠️ 常见问题","p":["使用推理模型时，模型的内部推理过程会消耗您的一部分响应词元额度，即使此推理未在最终输出中显示（例如 o3-mini 或 Gemini Thinking）。如果您发现回复不完整或为空，应尝试调整 AI 响应配置 面板中的“最大响应长度”设置。对于推理模型，通常使用的词元限制要比标准对话模型高得多——从 1024 到 4096 个词元不等。"]},{"l":"⚙️ 配置","p":["大多数与推理相关的设置可以在 高级格式化 面板的“推理”部分进行配置。","推理块在聊天中显示为可折叠的消息部分。它们可以通过手动添加、由后端自动添加或通过响应解析添加（见下文）。","默认情况下，推理块是折叠的以节省空间。单击块可展开并查看其内容。您可以通过在推理设置中启用 自动展开 来设置块自动展开。","当推理块展开时，您可以使用 复制 和 编辑 按钮来复制或编辑其内容。","有些模型支持推理，但不会将其思考过程发送回来。通过切换 显示隐藏 设置，仍然可以为这些模型显示带有推理时间的推理块。"]},{"l":"➕ 添加推理"},{"l":"手动添加","p":["通过 消息编辑 菜单，可以向任何消息添加推理块。编辑时点击 以添加推理部分。第三方扩展也可以通过在处理消息对象并将其添加到聊天之前，写入 extra.reasoning 字段来添加推理。"]},{"l":"使用命令","p":["使用 /reasoning-set STscript 命令向消息添加推理。该命令接受 at（消息 ID，默认为最后一条消息）和推理文本作为参数。"]},{"l":"通过后端","p":["如果您选择的 LLM 后端和模型支持推理输出，在 AI 响应配置 面板中启用“请求模型推理”将添加一个包含模型思考过程的推理块。","支持的源：","Claude","DeepSeek","Google AI Studio","Google Vertex AI","OpenRouter","xAI (Grok)","AI/ML API","“请求模型推理”并不决定模型是否进行推理。Claude 和 Google (2.5 Flash) 允许切换思考模式；参见 推理力度。"]},{"l":"通过解析","p":["在 高级格式化 面板中启用“自动解析”，以自动从模型的输出中解析推理。","响应必须包含一个推理部分，该部分包裹在配置的前缀和后缀序列中。默认提供的序列对应于 DeepSeek R1 推理格式。","使用前缀 think 和后缀 /think 的示例："]},{"l":"\uD83D\uDCDD 使用推理的提示","p":["默认情况下，识别出的推理块内容不会发送回模型。要在提示中包含推理，请在 高级格式化 面板中启用“添加到提示词”。推理内容将包裹在配置的前缀和后缀序列中，并通过分隔符与主上下文分开。“最大添加数”数字设置控制可以包含多少个推理块，从提示词的末尾开始计数。","大多数模型提供商不建议在多轮对话中将 CoT 发送回模型。"]},{"l":"从推理继续","p":["一个特殊情况是，即使未启用“添加到提示词”开关，推理也可以发送回模型，即当生成被继续时（例如，从 选项 菜单按下“继续”），但被继续的消息仅包含推理而没有实际内容。这为模型提供了一个完成不完整推理并开始生成主要内容的机会。提示词将按如下方式发送："]},{"l":"\uD83D\uDD0D 正则表达式脚本","p":["来自 正则表达式扩展 的正则表达式脚本可以应用于推理块的内容。在脚本编辑器的“影响范围”部分勾选“推理”，以专门针对推理块。","不同的临时性选项对推理块的影响如下：","非临时性：推理内容被永久更改。","编辑时运行：当推理块被编辑时，重新评估正则表达式脚本。","改变聊天显示：正则表达式应用于推理块的显示文本，而非底层内容。","改变外发提示词：正则表达式仅在推理块发送到模型之前应用于它们。"]},{"l":"⚖️ 推理力度","p":["\"high\"","\"high\", 或最大响应的 80%","\"low\"","\"low\", 或最大响应的 20%","\"medium\"","\"medium\", 或最大响应的 50%","0, 不思考","128","2.5 Flash","2.5 Flash Lite","2.5 Pro","Claude (≤ 21333 如果不流式传输)","Google AI Studio 和 Vertex AI 如下：","grok-3-mini","o4-mini, o3*, o1*","OpenAI (关键词)","OpenRouter (关键词)","Opus 4, Sonnet 4/3.7","Perplexity (关键词)","sonar-deep-research","thinkingBudget = -1","xAI (Grok) (关键词)","中","低","最大","最大响应与 24576 的较小值","最大响应与 32768 的较小值","最大响应的 15%","最大响应的 15%，最小 1024","最大响应的 15%，最小 128","最大响应的 15%，最小 512","最大响应的 25%","最大响应的 25%，最小 1024","最大响应的 50%","最大响应的 50%，最小 1024","最大响应的 95%，最小 1024","最小","对于 Claude，如果禁用流式传输，预算上限为 21333。如果计算的预算少于 1024，则最大响应更改为 2048。","对于 Gemini 2.5 Pro 和 2.5 Flash/Lite，无论流式传输设置如何，预算分别上限为 32768 或 24576 个词元。","对于 OpenRouter、Perplexity 和 AI/ML API，仅发送 OpenAI 风格的关键词。","推理力度是 AI 响应配置 面板中的一个聊天补全设置，它影响可能用于推理的词元数量。每个选项的效果取决于所连接的源。对于下面列出的源，“自动”仅意味着相关参数不包含在请求中。","未指定","未指定， 不思考","未指定，效果取决于模型","模型","自动","自动 (动态思考)","适用模型","选项","预算 1024 词元","高"]}],[{"l":"\uD83C\uDF9B️ 高级格式化","p":["⏹️ 自定义停止字符串","\uD83D\uDCAC 系统提示词","\uD83D\uDCCB 上下文模板","\uD83D\uDCE6 后端定义的模板","\uD83D\uDD04 重置模板","\uD83D\uDD24 分词器","\uD83D\uDE80 回复起始词","AI Horde","Claude","Google AI Studio","KoboldAI Classic（1.2.2 及更高版本）或 KoboldCpp","MistralAI","NovelAI","OpenAI（最多 4 个字符串）及兼容 API","OpenRouter（文本补全和聊天补全）","一些文本补全源提供自动选择模型作者推荐的模板的能力。这是通过比较模型 tokenizer_config.json 文件中定义的聊天模板的哈希值与某个默认的 SillyTavern 模板的哈希值来实现的。","不适用于聊天补全 API，因为它们使用不同的提示词构建器。","从用户数据目录的根目录中删除 content.log 文件。该文件跟踪为用户复制的默认文件。","从相关的子目录（ context, instruct, sysprompt 等）中删除模板 JSON 文件。","你可以将默认模板恢复至原始状态。这可以通过界面操作或手动删除相关数据文件来完成。","出现提示时确认操作。","分词器是一种将文本分解为更小单元（称为词元 (token)）的工具。这些词元可以是单个单词，甚至是单词的一部分，例如前缀、后缀或标点符号。一个经验法则是，一个词元通常对应 3~ 4 个文本字符。","如果哈希值匹配，并且该模板存在于模板列表中（即未被重命名或删除），则会自动选择该模板。","对于聊天补全 API 中的等效设置，请使用 提示词管理器。","对于聊天补全 API 中的等效设置，请使用 提示词管理器。 主提示词 (Main Prompt) 相当于聊天补全 API 中的系统提示词。","导航到你的用户数据目录（详情请见 数据路径）。","将一个助手 (assistant) 角色的消息添加到提示词的末尾。对于某些后端模型，这相当于预填充模型响应，但有些模型可能根本不支持此功能，并会返回验证错误。如果不确定，请将此字段留空。","建立与 API 的连接时，模型必须正确报告其元数据。如果此功能无效，请尝试将后端更新到最新版本。","必须选择一个支持的后端作为文本补全源。目前只有 llama.cpp 和 KoboldCpp 支持推导模板。","手动重置","打开 高级格式化 菜单。","报告的聊天模板哈希值必须与 已知的 SillyTavern 模板 之一匹配。这仅涵盖默认模板，例如 Llama 3, Gemma 2, Mistral V7 等。","接受一个 JSON 序列化的停止字符串数组。示例：[\\n, \\nUser:, \\nChar:]。如果不确定格式，请使用 在线 JSON 验证器。如果模型输出 以 任何停止字符串结尾，它们将从输出中删除。","推导模板 (Derive templates) 选项必须在 高级格式化 菜单中启用。这可以应用于上下文 (Context)、指令 (Instruct) 或两者。","支持的 API：","文本补全 API","文本补全 API：Text Generation WebUI (ooba), Tabby, Aphrodite, Mancer, TogetherAI, Ollama 等。","有关系统提示词的更多信息，请参阅 提示词指南。","本节提供的设置允许对 提示词构建 策略进行更多控制，主要针对文本补全 (Text Completion) API。","此部分的选项在 上下文模板 中有详细说明。","此部分的选项在 分词器 中有详细说明。","此面板中的大多数设置不适用于聊天补全 (Chat Completions) API，因为它们由提示词管理器 (prompt manager) 系统管理。","点击 恢复当前模板 按钮。","界面重置","确保在 config.yaml 中将 skipContentCheck 设置为 false，否则不会触发内容检查。","系统提示词定义了模型需要遵循的通用指令。它为对话设定了基调和上下文。例如，它告诉模型扮演一个 AI 助手、写作伙伴或虚构角色。","系统提示词是 故事字符串 (Story String) 的一部分，通常是模型接收到的提示词的第一部分。","聊天补全 API","选择要重置的模板。","通常，AI 模型要求你以某种特定方式向其提供角色数据。SillyTavern 包含一个针对不同模型的预制转换规则列表，但你可以随意自定义它们。","重启 SillyTavern 服务器。应用程序将重新填充默认内容，恢复任何已删除的默认模板。","预填充提示词的最后一行，强制模型从该点继续。这对于强制执行内容很有用，例如使用定义的前缀引导 模型推理：","默认情况下，回复起始词前缀不会显示在结果消息中。启用“在聊天中显示回复前缀 (Show reply prefix in chat)”以显示它。"]}],[{"l":"\uD83E\uDDE9 上下文模板","p":["聊天补全 API 的等效设置，请使用 提示词管理器。","通常，AI 模型要求您以特定方式向其提供角色数据。SillyTavern 包含了一系列针对不同模型的预制转换规则，但您也可以按需自定义。","请在“ 高级格式化”面板中编辑这些设置。"]},{"l":"\uD83D\uDCD6 故事字符串","p":["{{anchorAfter}}: 设置为使用“故事字符串后”位置的提示词。","{{anchorBefore}}: 设置为使用“故事字符串前”位置的提示词。","{{char}}: 角色名称。","{{description}}: 角色的 描述。","{{mesExamples}}: (可选) 角色的 示例对话，以指令格式带分隔符呈现。","{{mesExamplesRaw}}: 角色的 示例对话 原始格式，无任何格式化。","{{persona}}: 所选 人格的描述。","{{personality}}: 角色的 性格。","{{scenario}}: 角色的 场景。","{{system}}: 系统提示词 或 角色的 主提示词 覆盖项（如果存在且在用户设置中启用了“偏好角色提示词”）。","{{user}}: 所选人格的名称。","{{wiAfter}} 或 {{loreAfter}}: 组合的已激活 世界信息 条目，其位置设置为“角色定义后”。","{{wiBefore}} 或 {{loreBefore}}: 组合的已激活 世界信息 条目，其位置设置为“角色定义前”。","在故事字符串中使用 {{mesExamples}} 时，请在 用户设置 面板中将 “示例消息行为” 设置为 “永不包含示例”，以避免在提示词中重复出现示例消息。","我们向 Handlebars 求值器提供以下参数（用双花括号包裹）：","支持一个特殊的 {{trim}} 宏，用于移除其周围的任何换行符。如果您希望某部分文本不与前一行被换行符分隔，请使用它（ 空格不会被修剪）。","此字段是提示词前言（内部称为故事字符串）的模板。这是为文本补全和指令模型添加在 角色卡 中定义信息的主要方式。","警告：如果故事字符串模板中缺少上述任何参数，它们将完全不会被发送到提示词中。","该模板支持 Handlebars 语法、自定义文本注入或格式化，以及任何其他 宏。语言参考请见： https://handlebarsjs.com/guide/"]},{"l":"\uD83D\uDCCD 提示词锚点","p":["{{anchorBefore}} 和 {{anchorAfter}} 是通用占位符，用于存放由各种扩展和杂项功能添加的、位于选定静态位置的提示词，例如：","作者注记","摘要","聊天向量化/ 数据库","STscript 注入","网络搜索"]},{"l":"\uD83D\uDCCD 故事字符串位置","p":["默认情况下，渲染后的故事字符串（所有占位符已替换）放置在提示词的最开头，后面跟着示例消息和可见的聊天历史记录。","或者，您可以通过选择“聊天中 @ 深度”选项将其移动到动态位置，该选项将故事字符串放置在聊天上下文中的特定深度。","如果模板包含用于包装故事字符串的静态提示词元素（模型特定的前缀或后缀），使用“聊天中 @ 深度”位置将导致其被重复序列错误地双重包装，这可能会产生意外结果。","这种情况下，您可以通过以下方式之一修复此问题：","内置模板：使用 高级格式化 中描述的步骤将模板重置为默认值。","自定义模板：将静态元素从故事字符串模板移动到 故事字符串序列。"]},{"l":"\uD83C\uDF81 故事字符串包装","p":["以下部分仅当 指令模式 开启时适用。","默认 位置：渲染后的故事字符串将使用 故事字符串序列 中定义的序列进行包装。","聊天中 @ 深度 位置：渲染后的故事字符串将使用 聊天消息序列 中为所选角色（默认为系统）定义的序列进行包装。"]},{"l":"➗ 示例分隔符","p":["用作块标题和示例对话块之间的分隔符。示例对话中任何 START 标签的实例都将被此字段的内容替换。"]},{"l":"\uD83D\uDCAC 聊天开始符","p":["在渲染的故事字符串之后、示例对话块之后，但在上下文中第一条消息之前，作为分隔符插入。"]},{"l":"⏹️ 将分隔符用作停止字符串","p":["将“示例分隔符”和“聊天开始符”添加到停止字符串列表中。","如果模型倾向于幻觉或泄漏前面带有分隔符的整块示例对话，这会很有帮助。"]},{"l":"\uD83D\uDD24 将名称用作停止字符串","p":["将角色和用户人格名称添加到停止字符串列表中。","建议保持开启，以防止模型冒名顶替。"]},{"l":"\uD83D\uDCDB 始终将角色名称添加到提示词","p":["当指令模式开启时，此设置无效。名称行为由所选的 包含名称 选项定义。","将角色名称附加到提示词中，以强制模型以该角色的身份完成消息："]}],[{"l":"\uD83E\uDDE0 指令模式","p":["指令模式允许您调整针对各种提示格式（如 Alpaca、ChatML、Llama2 等）训练的指令遵循模型的提示方式。","聊天补全 API 的等效设置，请使用 提示词管理器。"]},{"l":"API 支持"},{"l":"文本补全 API","p":["完全支持。这包括：","文本补全下的所有来源","KoboldAI Classic","AI Horde"]},{"l":"选择格式化方式","p":["所选的指令模板必须与后端运行的实际模型的期望相匹配。","这通常在 HuggingFace 的模型卡中有所反映，有些甚至提供与 SillyTavern 兼容的 JSON 文件。","示例： NeverSleep/Noromaid-13b-v0.1.1"]},{"l":"聊天补全 API (OpenAI, Claude 等)","p":["聊天补全 API 不支持（也不需要） 此功能。它们使用完全不同的提示词构建器。"]},{"l":"NovelAI","p":["虽然 NovelAI 技术上 支持，但其模型均未经过训练以理解指令格式。NovelAI 模型可以使用一个特殊的指令模块，当在聊天消息中遇到用花括号包裹的指令时会 自动 激活，因此对整个提示词使用指令模式将导致输出质量 下降。","以下是一个为 NovelAI 自动激活指令模块的示例："]},{"l":"⚙️ 指令模式设置"},{"l":"系统提示词","p":["系统提示词现在是一个独立的实体。详情请参阅 高级格式化 页面。"]},{"l":"模板","p":["提供一些知名指令模型的、带有序列的现成模板。","更改模板会将未保存的设置重置为上次保存的状态！如果您进行了任何不想丢失的更改，请不要忘记保存您的模板。"]},{"l":"激活正则表达式","p":["如果定义为有效的正则表达式，当连接到模型且其名称匹配此正则表达式时，将自动选择此模板。","需要预先启用指令模式。只有按字母顺序评估的第一个匹配的模板会被选中。"]},{"l":"使用换行符包裹序列","p":["每个序列文本在插入提示词时将被换行符包裹。Alpaca 及其衍生格式需要此选项。","如果您想完全控制行终止符，请禁用此选项。"]},{"l":"替换序列中的宏","p":["如果启用，已知的 {{宏}} 替换将在消息包装序列中被替换（如果已定义）。","此外，可以在消息前缀中使用特殊的 {{name}} 宏来引用附加到消息的实际名称（而不是当前活动的 {{char}} 或 {{user}}}），这在群聊或 /sendas 命令时很有帮助。如果无法确定名称，则使用“System”作为后备占位符。"]},{"l":"包含名称","p":["如果启用，将在聊天历史记录日志的前缀序列之后附加角色和用户名称。","可用选项如下：","从不：不在消息内容前添加名称前缀。","群组和过往人格：仅对来自群组角色和过往人格的消息添加名称前缀。","总是：总是在消息内容前添加名称前缀。"]},{"l":"\uD83D\uDD04 序列：故事字符串包装","p":["系统提示词包装已被移除，并替换为故事字符串包装。","定义当位置设置为“默认（上下文顶部）”时，故事字符串将如何被包装。"]},{"l":"故事字符串前缀","p":["插入到故事字符串之前。"]},{"l":"故事字符串后缀","p":["插入到故事字符串之后。"]},{"l":"\uD83D\uDD04 序列：聊天消息包装","p":["这些设置定义了在构建提示词时，属于不同角色的消息将如何被包装。","所有前缀序列也会自动用作停止字符串。"]},{"l":"用户消息前缀","p":["插入到用户消息之前，以及在模拟（impersonating）时作为最后的提示词行。"]},{"l":"用户消息后缀","p":["插入到用户消息之后。"]},{"l":"助手消息前缀","p":["插入到助手消息之前，以及在生成 AI 回复时作为最后的提示词行。"]},{"l":"助手消息后缀","p":["插入到助手消息之后。"]},{"l":"系统消息前缀","p":["插入到系统消息（由斜杠命令或扩展添加）之前。"]},{"l":"系统消息后缀","p":["插入到系统消息之后。"]},{"l":"系统同用户","p":["如果勾选为真，系统消息将使用用户角色消息序列。","否则，系统消息将使用其自己的序列（如果不为空）或根本不做任何包装（如果为空）。"]},{"l":"\uD83D\uDD27 其他序列","p":["用于微调提示词构建的各种高级配置。"]},{"l":"首个助手前缀","p":["插入到第一个助手消息之前。","仅计算 聊天历史 中的第一条消息，而不是实际首先进入提示词的消息！"]},{"l":"最后助手前缀","p":["插入到最后一条助手消息之前，或在生成 AI 回复时作为最后的提示词行。","在后台生成文本时（例如，Stable Diffusion 提示词或摘要）不使用。将改用系统指令前缀或常规助手前缀。"]},{"l":"系统指令前缀","p":["在后台生成中性/系统文本时（例如，Stable Diffusion 提示词或摘要），作为最后的提示词行插入。"]},{"l":"用户填充消息","p":["如果聊天历史不是以用户消息开头，则将在其开头插入此消息。","用例： 当指令格式 严格要求 提示词必须以用户消息开头并且消息角色必须严格交替时，例如：Llama 2 Chat, Mistral Instruct。"]},{"l":"⏹️ 停止序列","p":["表示回复结束的文本。也会作为停止字符串发送到后端 API。","如果生成了停止序列，则其后的所有内容（包括序列本身）将从输出中删除。"]}],[{"l":"\uD83D\uDD22 分词器","p":["AI21 API：Jamba 分词器（需要一次性下载）。","API 分词器。查询生成 API 以直接从模型获取词元计数。已知支持的后端：Text Generation WebUI (ooba), koboldcpp, TabbyAPI, Aphrodite API。 如果您使用受支持的后端，请选择此项。","Claude：通过 WebTokenizers 使用依赖模型的分词器。","Cohere API：Command-R 或 Command-A 分词器（需要一次性下载）。","DeepSeek API：DeepSeek 分词器（需要一次性下载）。","DeepSeek 分词器。被 DeepSeek 模型（如 R1）使用。 如果您使用 DeepSeek 模型，请选择此项。","Gemma 分词器。被 Gemini/Gemma 模型使用。 如果您使用 Gemma 模型，请选择此项。","Google AI Studio：Gemma 分词器。","KoboldAI Classic / AI Horde：Llama 分词器。","KoboldCpp：模型 API 分词器。","Llama 3 分词器。被 Llama 3/3.1 模型使用。 如果您使用 Llama 3/3.1 模型，请选择此项。","Llama 分词器。被 Llama 1/2 模型系列使用：Vicuna, Hermes, Airoboros 等。 如果您使用 Llama 1/2 模型，请选择此项。","Mistral Nemo 分词器。被 Mistral Nemo 模型系列及其微调版本使用。 如果您使用 Mistral Nemo/Pixtral 模型，请选择此项。","Mistral V1 分词器。被较旧的 Mistral 模型系列及其微调版本使用。 如果您使用较旧的 Mistral 模型，请选择此项。","MistralAI API：Mistral V1 或 V3 分词器（需要一次性下载）。","NerdStash v2 分词器。被 NovelAI 的 Kayra 模型使用。 如果您使用 Kayra 模型，请选择此项。","NerdStash 分词器。被 NovelAI 的 Clio 模型使用。 如果您使用 Clio 模型，请选择此项。","NovelAI Clio：NerdStash 分词器。","NovelAI Kayra：NerdStash v2 分词器。","OpenAI：通过 tiktoken 使用依赖模型的分词器。","OpenRouter：为其各自的模型使用 Llama, Mistral, Gemma, Yi 分词器。","SillyTavern 提供了一个“最佳匹配”选项，它会根据所使用的 API 提供商尝试使用以下规则来匹配分词器。","Yi 分词器。被 Yi 模型使用。 如果您使用 Yi 模型，请选择此项。","分词器是一种将文本分解为更小单元（称为词元）的工具。这些词元可以是单个单词，甚至是单词的一部分，例如前缀、后缀或标点符号。经验法则是，一个词元通常对应 3~ 4 个文本字符。","后备分词器：GPT-3.5 turbo 分词器。","如果您得到的结果不准确或希望进行实验，可以为 SillyTavern 设置一个 覆盖分词器，以便在向 AI 后端形成请求时使用：","文本补全 API （可覆盖）：","文本补全：API 分词器（如果支持）或 Llama 分词器。","无。每个词元估计约为 ~ 3.3 个字符，向上取整为最接近的整数。 如果您的提示词在高上下文长度时被截断，请尝试此选项。 此方法由 KoboldAI Lite 使用。","聊天补全 API （不可覆盖）："]},{"l":"附加分词器","p":["由于体积较大，这些分词器未包含在默认安装中。首次使用时需要一次性下载。","Qwen2 分词器。","Command-R / Command-A 分词器。由聊天补全中的 Cohere 源使用。","Mistral V3 (Nemo) 分词器。由聊天补全中的 MistralAI 源使用（Nemo 和 Pixtral 模型）。","DeepSeek (deepseek-chat) 分词器。由聊天补全中的 DeepSeek 源使用。","如果您不想使用互联网下载，可以在 config.yaml 中选择退出选项： enableDownloadableTokenizers。设置为 false 以禁用下载。","您也可以从 SillyTavern-Tokenizers 仓库手动下载分词器。下载 JSON 文件并将其放在数据根目录的 _cache 子目录中，默认路径是 ./data/_cache。如果 _cache 目录不存在，请创建它。之后，重启 SillyTavern 服务器以重新初始化分词器。","如果所需的分词器模型未缓存且下载被禁用，将使用后备分词器（Llama 3）进行计数。"]},{"l":"词元填充","p":["SillyTavern 将始终为聊天补全模型使用匹配的分词器，因此不需要词元填充。","除非 SillyTavern 使用运行模型的远程后端 API 提供的分词器，否则在提示词生成过程中假设的所有词元计数都是基于所选 分词器 类型估算的。","由于在接近模型定义的最大值的上下文大小上，分词结果可能不准确，提示词的某些部分可能会被修剪或丢弃，这可能会对角色定义的一致性产生负面影响。","为防止这种情况，SillyTavern 会分配一部分上下文大小作为填充，以避免添加超出模型容纳能力的聊天项。如果您发现即使选择了最匹配的分词器，提示词的某些部分仍被修剪，请调整填充量，以免描述被截断。","您可以输入负值进行反向填充，这允许分配超过设置的最大词元量的空间。"]}],[{"l":"\uD83E\uDDEA CFG（无分类器引导）","p":["本文作者：kingbri","贡献者：kingbri, Guillaume \"Vermeille\" Sanchez, AliCat"]},{"l":"它是什么？","p":["CFG，即无分类器引导（Classifier-Free Guidance），是一种用于增强或减弱提示词中某些部分显著性的方法。"]},{"l":"支持的 API 后端","p":["目前支持的后端有 oobabooga 的 textgen WebUI、NovelAI 和 TabbyAPI。 NovelAI 有其自己的 CFG 文档。","警告：CFG 会因处理多于 1 个提示词而增加显存使用量！如果在启用 CFG 生成提示词时 GPU 内存耗尽，请考虑减小上下文大小、使用参数更少的模型或完全关闭 CFG。"]},{"l":"⚙️ 配置","p":["访问 CFG 设置的方式与访问“作者注记”相同：","CFG 汉堡菜单 png","CFG 面板如下所示：","CFG 聊天面板 png","CFG 面板中有四个下拉菜单：","聊天 CFG","将 CFG 尺度（scale）和提示词的作用范围限定于此聊天。","角色 CFG","将 CFG 尺度和提示词的作用范围限定于指定角色。","全局 CFG","全局覆盖 CFG 尺度和提示词（也会覆盖模型预设！）。","CFG 高级设置（原名为 CFG 提示词级联）","用于组合前 3 个下拉菜单中的提示词并设置插入深度。","注意：如果引导尺度设置为 1，则不会发送任何内容，因为此时 CFG 处于“关闭”状态。"]},{"l":"群聊","p":["在群聊中，CFG 尺度面板如下所示：","CFG 面板群聊 png","主要变化是移除了角色 CFG，并在聊天 CFG 下拉菜单中提供了一个名为 使用角色 CFG 尺度 的复选框。这允许使用当前角色的引导尺度，而非聊天 CFG 所设置的尺度。","此功能的主要用途是根据每个角色的个体需求来调整尺度。","此外，在提示词级联中勾选 角色负面提示词 框，将附加独立的角色负面提示词以及聊天负面提示词（如果启用）。"]},{"l":"\uD83D\uDCA1 概念"},{"l":"这和 Stable Diffusion 里的一样吗？","p":["是，也不是。LLM 中的 CFG 其工作方式可能与大家在 Stable Diffusion 中习惯的方式不同。基于 LLM 的 CFG 基于“提示词混合”的原则。CFG 公式接收一个正面提示词和一个负面提示词，然后混合它们之间的 差异。之后，发送一个组合提示词并生成回复！","下面是一个示意图来帮助可视化这个概念。红色代表负面提示词，蓝色代表中性提示词，紫色代表被解释的混合结果。所有白色区域在三个提示词中是相同的，因此不用于 CFG 混合。","st cfg 示意图 png","如果您想了解更多关于 CFG 和 LLM 的信息，Vermifuge 的原始论文在这里。建议阅读/收听：","论文 - [2306.17806] Stay on topic with Classifier-Free Guidance (arxiv.org)","音频版本 - https://www.youtube.com/watch?v=MGY00YFcyco"]},{"l":"我需要 CFG 提示词吗？","p":["不需要！CFG 提示词完全是可选的。仅仅将引导尺度调整到 1 以上也会对回复产生影响，可以突出聊天和角色互动。"]},{"l":"什么是好的 CFG 提示词？","p":["那么，我们已经确定 CFG 提示与 Stable Diffusion 的负面标签和嵌入不同。我们如何制作提示词呢？","警告：此处假设您已使用 PLists 和 Ali:Chat 创建了一个角色。如果没有，请随意尝试各种提示技术。","假设我有一个名为“John”的角色。根据他的示例对话，John 应该总是感到快乐和兴奋。然而，在与 John 聊天时，他有时会悲伤和沮丧。","为了消除这种情况，CFG 来帮忙了！只需将负面提示词设为 [John 的感受：悲伤，沮丧] 以帮助消除悲伤部分。您还可以选择将正面提示词设为 [John 的感受：快乐，高兴] 以进一步突出 John 快乐的部分。"]},{"l":"正面提示词","p":["我在上一节中提到了这一点，但我想再谈一点。正面提示词用于进一步突出角色的某些部分。让我们再次以 John 为例。通过使用 [John 的感受：快乐，高兴] 作为正面提示词让他更快乐，John 输出的对话应该会比不包含正面提示词时更具快乐感。"]},{"l":"但是...","p":["这些只是基于一种特定角色格式的经验得出的 宽松指南。还有许多其他创建提示词的方法值得尝试。请随时与其他用户分享您的想法！"]},{"l":"引导尺度","p":["这里有一个经验法则。引导尺度为 1 意味着 CFG 被禁用。实际上，如果引导尺度为 1，SillyTavern 不会向后端发送任何内容。引导尺度 1 会在不同程度上产生其他部分所示的效果。","然而，引导尺度 1 会产生 相反 的效果，因为这里负面提示词被用作主要提示词。","让我们再次使用 John 的例子。负面提示词是 [John 的感受：悲伤，沮丧]，正面提示词是 [John 的感受：快乐，高兴]，引导尺度为 0.8。","这反过来会增强 负面 提示词的效果，你会看到 John 开始表现得比平时更悲伤，而不是更快乐。","tl;dr：使用 1.5 的引导尺度，然后根据输出结果上下调整。"]},{"l":"提示词级联","p":["负面和正面提示词可以在 CFG 类型（即“每聊天”、“每角色”和“全局覆盖”）之间级联。更多信息请参见“配置”标题部分。"]},{"l":"插入深度","p":["遵循基本规则：某个内容在提示词中的位置越低，它对回复的影响就越大。对于聊天，我推荐使用默认深度 1，因为它与 SillyTavern 的其他组件非常灵活。","但是，如果您想尝试，也可以使用插入深度 0。但是，这会极大地改变回复的外观，并且 不推荐 在此处使用提示词级联！"]}],[{"l":"\uD83E\uDDE0 提示词管理器","p":["提示词管理器是一个系统，它为聊天补全 API 提供了对 提示词构建 策略的更多控制。","文本补全 API 的等效设置，请使用 高级格式化。","如果一个预设与您的某个角色卡共享名称，则在开始与该角色聊天时会自动选择该预设。为避免此行为，请为预设命名一个独特的名称。","通过点击导航栏中的“AI 响应配置”按钮访问提示词管理器。提示词管理器位于 通用设置 面板下方。"]},{"l":"✏️ 快速提示词编辑","p":["提供空间以快速编辑常见的提示词部分，例如 主提示词、 辅助提示词 和 历史记录后指令。关于这些提示词的更多信息可以在 提示词构建 页面上找到。"]},{"l":"\uD83D\uDEE0️ 功能提示词","p":["这些提示词被发送到聊天补全模型，以帮助其理解发送给它的信息，或指示其在特定类型的交互中以特定方式行事。"]},{"l":"格式模板","p":["如果未设置格式模板，信息将按原样发送，不做任何包装。","这些是字符串模板，用于包装从 世界信息 和 角色卡 中提取的信息。","使用特殊标记来指示信息应插入的位置：","{0} 用于世界信息格式模板。","{{scenario}} 用于场景格式模板。","{{personality}} 用于性格格式模板。"]},{"l":"群聊推动提示词模板","p":["仅在群聊中使用。放置在提示词的末尾，以强制特定角色回复。","留空以禁用群聊推动功能。"]},{"l":"新聊天、新群聊、新示例聊天","p":["这些内容在聊天历史记录之前和每个 示例对话 块之前发送，以告知模型背景信息结束和聊天历史开始的位置。","新聊天： 用于单人聊天。","新群聊： 用于群聊。","新示例聊天： 用于示例对话块。","留空以禁用此功能。"]},{"l":"继续推动提示词","p":["在提示词末尾发送，以指示模型在触发“继续”时该做什么，例如按下继续按钮或由 STScript 触发时。","请记住，聊天补全模型处理“继续”的方式与 文本补全 模型不同，并且无论您的继续推动提示词如何，都可能无法始终提供无缝的结果。"]},{"l":"替换空消息","p":["当文本框为空且按下 发送消息 时，发送此字段的内容而不是空白消息。"]},{"l":"\uD83D\uDC65 角色名称行为","p":["提供不同的策略来指示模型如何将消息与角色关联。如果聊天补全模型在确定哪些消息属于哪个角色时遇到问题，则可能需要选择不同的策略。"]},{"l":"➕ 继续后缀","p":["当触发“继续”时，模型返回的“已继续”消息将在开头添加所选的继续后缀。例如，它可以在继续的文本前添加一个空格。"]},{"l":"⚙️ 附加设置"},{"l":"用引号包裹","p":["已弃用选项。建议改用 正则表达式脚本。","在发送前将整个用户消息用隐藏的引号包裹。这对于角色不使用引号来表示说话的会话非常有用。如果您的会话使用引号来表示说话，请勿勾选此项。"]},{"l":"继续预填充","p":["可能不适用于所有聊天补全源。","将继续推动提示词作为助手角色消息而非系统消息发送。如果启用此功能，则不会使用继续推动提示词。"]},{"l":"压缩系统消息","p":["已弃用选项。建议改用 提示词后处理。","将连续的系统消息合并为一条组合消息（不包括示例对话）。"]},{"l":"启用网络搜索","p":["不要与 网络搜索扩展 混淆。","启用由聊天补全后端提供的网络搜索功能。提示词通常由模型提供商使用搜索结果进行丰富，并可能产生额外费用。"]},{"l":"启用函数调用","p":["参见 函数调用"]},{"l":"发送内联图片、发送内联视频","p":["不要与 图片说明扩展 混淆。","如果聊天补全模型具有处理所提交图片和视频的多模态能力，此选项将切换其执行此操作的能力。要将媒体附加到提示词，请使用“魔法棒”菜单中的 附加文件 选项。"]},{"l":"请求内联图片","p":["不要与 图片生成扩展 混淆。","允许模型返回图片附件。"]},{"l":"使用系统提示词","p":["仅由 Google Gemini 和 Anthropic Claude 后端支持。","尽管这两者的设置非常相似，但它们在技术上是独立的选项，因此可以分别配置。","将所有系统消息合并，直到第一条具有非系统角色（用户/助手）的消息，并将它们作为单独的系统指令字段发送。"]},{"l":"\uD83E\uDD14 推理设置","p":["如果聊天补全模型使用推理，这些设置会影响其可见性和功能。"]},{"l":"请求模型推理","p":["参见 按后端添加推理。"]},{"l":"推理力度","p":["参见 推理力度。"]},{"l":"\uD83D\uDCCB “提示词”部分","p":["提示词管理器构成了发送给聊天补全模型的提示词的主干。它控制发送的内容以及发送的 顺序。"]},{"l":"“提示词”下拉菜单","p":["包含当前聊天补全预设包含的所有（非默认）提示词的下拉列表。要将这些提示词之一添加到外发消息中，需要从下拉列表中选择它，然后按 插入提示词 按钮将其添加到提示词管理器中。要创建新提示词并将其添加到此下拉列表中，请按 新建提示词 按钮。新提示词编写并保存后，它将被添加到下拉列表中，然后可以插入。"]},{"l":"提示词列表","p":["这是一个拖放界面，列出了选择要发送给聊天补全模型的提示词。放置在界面 顶部 的提示词会较早发送。列表的 底部 是 最后发送 给模型的内容（通常，这将是您的 历史记录后指令）。","默认提示词无法从选定的提示词列表中移除。这包括主提示词、世界信息（前/后）、人格描述、角色描述、角色性格、场景、增强定义、辅助提示词、聊天示例、聊天历史记录和历史记录后指令。如果不需要这些，可以将它们 切换为“关闭”，但不能完全移除或删除。"]},{"l":"✍️ 编辑提示词","p":["点击提示词上的 铅笔按钮 将进入 编辑界面。在这里，您可以直接编辑提示词。","要永久保存对这些提示词在聊天补全预设中的更改，您必须点击 编辑界面 右下角的 保存 按钮，并通过使用 AI 响应配置 部分顶部的 保存 按钮来保存预设本身！否则，当切换到其他聊天补全预设时，所做的更改将会丢失。"]},{"l":"名称","p":["提示词的名称。这不会发送给聊天补全模型；仅用于您在提示词管理器中的参考。"]},{"l":"角色","p":["发送提示词的角色。您可以在系统、AI 助手或用户之间选择。"]},{"l":"触发器","p":["发送此提示词的生成类型。如果未选择任何内容，则该提示词将针对所有生成类型发送。如果选择了一个或多个，则该提示词仅针对那些特定的生成类型发送：","普通： 常规消息生成请求。","继续： 当按下继续按钮时。","模拟： 当按下模拟按钮时。","滑动： 当通过滑动触发生成时。","重新生成： 在单人聊天中按下重新生成按钮时。","静默： 后台生成请求，通常由 扩展 或 STscript 命令触发。","“重新生成”触发器在群聊中不可用，因为它使用不同的重新生成逻辑：删除最后一条回复的所有消息，并根据所选的 群聊回复策略 使用“普通”生成类型对消息进行排队。"]},{"l":"位置","p":["当位置设置为 相对 时，此提示词与所有其他提示词一起在拖放界面中的位置发送。当设置为 聊天中 并给定 深度 时，它反而作为所选角色 在聊天历史记录中 发送，并 忽略 拖放界面的顺序。"]},{"l":"深度","p":["当位置设置为 聊天中 时，这定义了提示词在聊天历史记录中发送的深度。数字越高，发送得越深。例如，深度为 0 将在最后一条聊天消息之后发送，深度为 1 将在最后一条聊天消息之前发送，深度为 2 将在倒数第二条聊天消息之前发送，依此类推。"]},{"l":"顺序","p":["具有相同角色和深度的提示词将分组在一起，并按它们的顺序值排序。 顺序如下（从上到下）：用户、AI 助手、系统。","当位置设置为 聊天中 时，这定义了提示词在聊天历史记录中发送的顺序。数字越低，发送得越早。"]},{"l":"\uD83C\uDFD7️ 构建您的提示词：提示与技巧","p":["访问 SillyTavern 文档的 提示词构建 部分，了解更多关于如何编写有效提示词的信息。这些信息在很大程度上可以应用于聊天补全预设。"]}],[{"l":"\uD83C\uDF0D 世界信息","p":["世界信息（也称为传说书或记忆书）是 ST 中一个强大的工具，可动态将提示词插入您的聊天中，以帮助引导 AI 回复。","通常，世界信息（简称 WI）用于增强 AI 对您虚构世界中细节的理解，但您也可以使用世界信息条目插入您希望插入提示词中的 任何内容。","它就像一个动态词典，只有当与条目关联的关键词出现在消息文本中时，才会插入世界信息条目中的相关信息。","SillyTavern 引擎会激活并无缝地将相应的背景知识集成到提示词中，为 AI 提供背景信息。","需要注意的是，虽然世界信息有助于引导 AI 生成期望的内容，但它并不保证其一定会出现在生成的输出消息中。这取决于您的模型利用附加信息的能力！"]},{"l":"\uD83D\uDCA1 专业提示","p":["世界信息引擎是一个非常强大的提示词管理工具。不要只局限于添加角色背景知识，请随意尝试。","激活关键词、标题以及 内容 字段以外的其他信息不会被插入上下文中，因此每个世界信息条目都应包含一个全面的、独立的描述。","要创建丰富详细的世界背景知识，条目可以通过递归激活相互链接和引用。详见下文关于 递归扫描 的内容。","SillyTavern 为插入的背景信息提供了灵活的上下文预算。为节省提示词词元，建议保持条目内容简洁。"]},{"l":"\uD83D\uDCDA 延伸阅读","p":["世界信息百科全书: 关于世界信息和传说书的详尽深入指南。作者：kingbri, Alicat, Trappu。"]},{"l":"\uD83D\uDC64 角色背景知识","p":["可以选择将一个世界信息文件分配给一个角色，作为与该角色所有聊天（包括群组）的专用背景知识来源。","操作方法：导航到角色管理面板，点击地球仪按钮，然后从下拉列表中选择世界信息，点击“确定”。","要解除绑定或更改角色背景知识，请按住 Shift 键点击地球仪按钮。如果在移动设备上，请点击“更多...”，然后点击“链接世界信息”。"]},{"l":"角色背景知识插入策略","p":["生成 AI 回复时，角色世界信息中的条目将与全局世界信息选择器中的条目使用以下策略之一组合："]},{"l":"均匀排序（默认）","p":["所有条目将根据其插入顺序进行排序，就好像它们是一个大文件的一部分，忽略来源。"]},{"l":"角色背景知识优先","p":["首先按插入顺序包含角色世界信息中的条目，然后是全局世界信息中的条目。"]},{"l":"全局背景知识优先","p":["首先按插入顺序包含全局世界信息中的条目，然后是角色世界信息中的条目。"]},{"l":"\uD83D\uDCDD 世界信息条目"},{"l":"关键词 (Key)","p":["触发世界信息条目激活的关键词列表。默认情况下关键词不区分大小写（此功能 可配置）。"]},{"l":"将正则表达式 (Regex) 用作关键词","p":["关键词支持通过正则表达式进行更灵活的匹配。这使得可以匹配更具动态性的内容，包括可选单词或字符、空格以及正则表达式提供的所有其他功能。 如果定义的关键词是有效的正则表达式（JavaScript 正则表达式风格，以 / 作为分隔符。允许所有标志），则在检查是否应触发条目时将其视为正则表达式。多个正则表达式可以作为单独的关键词输入，并且可以协同工作。在正则表达式内部，可以使用逗号。纯文本关键词不支持逗号，因为它们被视为关键词分隔符。","高级正则表达式匹配的使用示例： 一个应在角色执行与天气相关的动作时插入的条目/指令","有关正则表达式语法和可能性的更多信息： 正则表达式 - JavaScript | MDN"]},{"l":"高级正则表达式逐消息匹配","p":["ST 在世界信息扫描缓冲区中的每条聊天消息前添加 角色名称:，并在 v1.12.6 之后使用字符值 1 (\\x01) 连接它们。 这意味着您可以使用绑定到该分隔字符的正则表达式来匹配特定角色的特定输入或输出。","例如，要仅匹配用户说“hello”，您可以使用以下正则表达式："]},{"l":"关键词输入","p":["有两种输入关键词的模式，每种模式的用户界面略有不同。在 ⌨️ 纯文本模式（默认）下，关键词可以在单个文本字段中以逗号分隔列表的形式输入。也可以包含正则表达式，但它们没有任何特殊高亮显示。在 ✨ 高级模式 下，关键词显示为单独的元素，正则表达式将如此高亮显示。该控件支持编辑和删除关键词。可以通过输入控件内的行内按钮切换模式。"]},{"l":"可选过滤器 (Optional Filter)","p":["与主关键词结合使用的附加关键词的逗号分隔列表。 如果未提供参数，则忽略此标志。 支持 AND ANY、NOT ANY 或 NOT ALL 逻辑","AND ANY = 仅当主关键词 和 可选过滤器关键词中的 任何一个 存在于扫描的上下文中时才激活条目。","AND ALL = 仅当主关键词 和 所有可选过滤器关键词都存在时才激活条目。","NOT ANY = 仅当主关键词存在 且 可选过滤器关键词中的 任何一个都未 出现在扫描的上下文中时才激活条目。","NOT ALL = 如果所有可选过滤器都出现在扫描的上下文中，则 阻止 条目激活，尽管主关键词已触发。","这些关键词也支持 正则表达式。"]},{"l":"条目内容 (Entry Content)","p":["条目激活时插入到提示词中的文本。"]},{"l":"插入顺序 (Insertion Order)","p":["数字值。定义多个条目同时激活时的优先级。插入顺序值较高的条目将插入到上下文的更靠近末尾的位置，因为它们对输出的影响更大。"]},{"l":"插入位置 (Insertion Position)","p":["角色定义前 (Before Char Defs): 世界信息条目插入在角色描述和场景之前。对对话有中等影响。","角色定义后 (After Char Defs): 世界信息条目插入在角色描述和场景之后。对对话有较大影响。","示例消息前 (Before Example Messages): 世界信息条目被解析为示例对话块，并插入在角色卡提供的示例之前。","示例消息后 (After Example Messages): 世界信息条目被解析为示例对话块，并插入在角色卡提供的示例之后。","作者注记顶部 (Top of AN): 世界信息条目插入在作者注记内容的顶部。影响程度取决于作者注记的位置。","作者注记底部 (Bottom of AN): 世界信息条目插入在作者注记内容的底部。影响程度取决于作者注记的位置。","@ 深度 (@ D): 世界信息条目插入到聊天中的特定深度（深度 0 为提示词的底部）。","⚙️ - 作为系统角色消息","\uD83D\uDC64 - 作为用户角色消息","\uD83E\uDD16 - 作为助手角色消息","示例消息条目将根据提示词构建设置进行格式化：指令模式或聊天补全提示词管理器。它们也遵循示例消息行为规则：在上下文满时逐渐被推出、始终保留或完全禁用。","如果您的作者注记被禁用（插入频率 = 0），则位于作者注记位置的世界信息条目将被忽略！"]},{"l":"条目标题 / 备忘录 (Entry Title / Memo)","p":["一个方便的文本字段，用于标记您的条目，AI 或任何触发逻辑都不会使用它。","如果为空，可以通过点击“填充空备忘录”按钮使用条目的第一个关键词来回填。"]},{"l":"策略 (Strategy)","p":["\uD83D\uDD35 (蓝色圆圈) = 该条目将始终存在于提示词中。","\uD83D\uDFE2 (绿色圆圈) = 该条目仅在存在关键词时触发。","\uD83D\uDD17 (链条链接) = 允许通过嵌入相似性插入该条目。","每个条目还有一个切换开关，允许您启用或禁用该条目。"]},{"l":"概率 (触发%) (Probability (Trigger %))","p":["此值就像一个附加过滤器，当条目通过任何方式（常量、主关键词、递归）激活时，增加一个不插入该条目的机会。","概率 = 100 意味着该条目将在每次激活时插入。","概率 = 50 意味着该条目有 1:1 的机会被插入。","概率 = 0 意味着该条目将 不 被插入（实质上禁用它）。","使用此功能在聊天中创建随机事件。例如，每条消息都有 1% 的几率在消息中提到其名字时唤醒一个上古之神。"]},{"l":"包含组 (Inclusion Group)","p":["包含组控制当多个具有相同组标签的条目同时被触发时如何选择条目。如果多个具有相同组标签的条目被激活，则只有一个会插入到提示词中。","默认情况下，根据它们的组权重（默认是 100 点）随机选择条目——数字越高，被选中的概率越高。这允许在触发的条目中进行随机选择，为交互增加惊喜和多样性。","如果一个条目被定义为逗号分隔的列表，则它可以属于多个包含组。将应用上述相同的逻辑。如果该条目被触发，它将 禁用 属于其任何组的所有其他条目。因此，如果任何组被激活，此条目将不会被激活。"]},{"l":"优先包含 (Prioritize Inclusion)","p":["为了提供对通过 包含组 激活哪些条目的更多控制，您可以使用“优先包含”设置。此选项允许您确定性地选择要选择的条目，而不是随机滚动组权重机会。","如果多个具有相同组标签且启用此设置的条目被激活，则将选择具有最高“顺序”值的条目。这对于通过包含组创建后备序列很有用。例如，优先处理深度较低、更强调的条目，或者在两者都有效时选择特定的场景设置指令。"]},{"l":"使用组评分 (Use Group Scoring)","p":["当全局或每个条目启用此设置时，激活的条目关键词数量决定组获胜者的选择。只有具有最多关键词匹配的组子集才会留待通过组权重或包含优先级激活 - 其余的将被停用并从组中移除。","使用此功能为大型组中的单个条目提供更多特异性。例如，它们可以有一个通用关键词和一个特定关键词。当未提供特定关键词时，将插入随机条目，反之亦然。","主关键词的分数计算逻辑是：1 次匹配 = 1 分。","对于辅助关键词，交互取决于所选的筛选逻辑：","AND ANY: 1 次辅助匹配 = 1 分。","AND ALL: 如果所有辅助关键词都匹配，则每个辅助关键词得 1 分。","NOT ANY 和 NOT ALL: 无变化。","示例：","条目 1. 关键词: song, sing, Black Cat. 组: songs","条目 2. 关键词: song, sing, Ghosts. 组: songs","输入 sing me a song 可以激活任一条目（两者都激活了 2 个关键词），但 sing me a song about Ghosts 将仅激活条目 2（激活了 3 个关键词）。"]},{"l":"自动化 ID (Automation ID)","p":["允许将世界信息条目与快速回复扩展中的 STscripts 集成。如果快速回复命令和 WI 条目具有相同的自动化 ID，则在激活具有匹配 ID 的条目时将自动执行该命令。","自动化按照它们被触发的顺序执行，遵循您指定的排序策略，结合 角色背景知识插入策略 和“优先级”排序。这导致 蓝色圆圈 条目首先被处理，然后是其他条目按其指定的“顺序”处理。递归触发的条目将在之后以相同的顺序处理。","如果多个具有相同自动化 ID 的条目被激活，脚本命令将仅运行一次。"]},{"l":"角色过滤器 (Character Filter)","p":["此条目可以为其激活的角色名称列表。如果此列表不为空，则该条目仅对名称在列表中的角色激活。当选择一个标签时，该条目将仅对具有该特定标签的角色激活。","“排除”模式会反转过滤器，意味着该条目将对所有角色激活，除了添加到列表中的角色或具有所选标签的角色。"]},{"l":"触发器 (Triggers)","p":["可以激活此世界信息条目的生成类型。如果未选择任何内容，则该条目可以针对所有生成类型激活。如果选择了一个或多个，则该条目将仅针对那些特定的生成类型激活：","普通 (Normal): 常规消息生成请求。","继续 (Continue): 当按下继续按钮时。","模拟 (Impersonate): 当按下模拟按钮时。","滑动 (Swipe): 当通过滑动触发生成时。","重新生成 (Regenerate): 在单人聊天中按下重新生成按钮时。","静默 (Quiet): 后台生成请求，通常由 扩展 或 STscript 命令触发。","“重新生成”触发器在群聊中不可用，因为它使用不同的重新生成逻辑：删除最后一条回复的所有消息，并根据所选的 群聊回复策略 使用“普通”生成类型对消息进行排队。"]},{"l":"附加匹配源 (Additional matching sources)","p":["默认情况下，世界信息条目仅针对当前对话的内容进行匹配。这些选项允许您针对不显示在聊天中的不同角色信息，甚至人格信息进行匹配。当您希望拥有范围广泛的条目用于多个角色之间，但又不想管理庞大的标签列表，或者不想在每次创建新角色时更新角色过滤器列表时，这非常有用。这也允许您根据当前活动的人格进行匹配。","角色描述 (Character Description): 针对角色描述进行匹配。","角色性格 (Character Personality): 针对角色性格摘要进行匹配，可在高级定义下找到。","场景 (Scenario): 针对角色指定的场景进行匹配，可在高级定义下找到。","人格描述 (Persona Description): 针对当前所选人格的描述进行匹配。","角色的注释 (Character's Note): 针对角色的注释进行匹配，可在高级定义下找到。","创作者注释 (Creator's Notes): 针对角色创作者的注释进行匹配，可在高级定义下找到。创作者的注释通常不包含在提示词中。"]},{"l":"\uD83D\uDD22 向量存储匹配 (Vector Storage Matching)","p":["向量存储扩展提供了一种替代关键词匹配的方法，它使用最近聊天消息与世界信息条目内容之间的相似性。","要启用和使用此功能，需要满足以下先决条件：","向量存储扩展已启用，并配置为使用可用的嵌入源之一。","向量存储扩展设置中勾选了“为世界信息启用”复选框。","要么允许进行无关键词匹配的世界信息条目具有“向量化”(\uD83D\uDD17) 状态，要么在向量存储设置中勾选“为所有条目启用”选项。","扩展中选择的向量化模型以及术语“嵌入”背后的理论含义在此不做介绍。如果您需要有关此主题的更多信息，请查看 数据库 指南。","向量存储匹配遵循以下规则集：","允许与向量存储匹配的最大条目数可以通过“最大条目数”设置进行调整。此数字仅设置限制，不影响为世界信息激活设置中设置的词元预算。所有预算规则仍然适用。","此功能仅替代对关键词的检查。条目要插入，必须满足所有附加检查：触发%、角色过滤器、包含组等。","不使用来自激活设置或条目覆盖的“扫描深度”设置。而是使用向量存储的“查询消息”值来获取要匹配的文本。这允许进行诸如将“扫描深度”设置为 0 的配置，这样就不会进行常规的关键词匹配，但条目仍然可以被向量激活。","“向量化”状态只是一个附加标记。该条目仍然表现得像一个正常的、已启用的、非常量记录，如果设置了关键词，它将被关键词激活。如果您希望它们仅由向量激活，请移除关键词。","由于检索质量完全取决于嵌入模型的输出，因此无法准确预测将插入哪些条目。如果您需要确定性和可预测的结果，请坚持使用关键词匹配。"]},{"l":"⏱️ 定时效果 (Timed Effects)","p":["通常，世界信息评估是无状态的，这意味着评估结果相同，仅取决于当前的聊天上下文。但是，随着定时效果的引入，您可以创建具有激活延迟、触发后保持活动状态或在激活后无法触发的条目。"]},{"l":"定时效果规则","p":["效果的时间范围以消息数（不是消息对/交换）衡量，0 表示没有效果。","效果仅适用于条目被激活的聊天。分支继承父聊天的状态。","如果聊天没有进展，例如最后一条消息被滑动或删除，则活动的定时效果将被移除。","对当前具有定时效果的条目进行任何更改将导致效果被强制移除。","关键词的后续触发不会刷新效果持续时间（如果它已经处于活动状态）。"]},{"l":"定时效果类型","p":["粘性 (Sticky) - 条目在激活后保持活动状态 N 条消息。粘性条目在后续扫描中忽略概率检查，直到它们过期。","冷却 (Cooldown) - 条目在激活后的 N 条消息内无法被激活。可以与粘性一起使用：条目在粘性持续时间结束后进入冷却。","延迟 (Delay) - 除非在评估时聊天中至少有 N 条消息，否则无法激活条目。","延迟 = 0 -> 条目可以随时激活。","延迟 = 1 -> 如果聊天为空（没有问候语），则无法激活条目。","延迟 = 2 -> 如果聊天中有零条或仅一条消息，则无法激活条目，依此类推。"]},{"l":"定时效果示例","p":["条目配置：粘性 = 3，冷却 = 2，延迟 = 2。"]},{"l":"⚙️ 激活设置 (Activation Settings)","p":["世界信息屏幕顶部的可折叠菜单。"]},{"l":"扫描深度 (Scan Depth)","p":["可在条目级别覆盖。","定义应扫描聊天历史中的多少条消息以查找世界信息关键词。","如果设置为 0，则仅评估递归条目和作者注记。","如果设置为 1，则 SillyTavern 仅扫描最后一条消息。","2 = 最后两条消息，依此类推。"]},{"l":"包含名称 (Include Names)","p":["定义是否应将聊天参与者的名称作为消息前缀包含在扫描的文本缓冲区中。这允许激活使用名称作为关键词的条目，而无需直接在消息中提及名称。","参见下面要扫描的文本示例，假设聊天参与者名为 Alice 和 Bob。","启用（默认）：","禁用："]},{"l":"上下文 % / 预算 (Context % / Budget)","p":["定义世界信息条目一次可以使用的词元数量。 您可以定义相对于 API 最大上下文设置（上下文%）的阈值或客观的词元阈值（预算）","如果预算耗尽，那么即使提示词中存在关键词，也不会激活更多条目。","常量条目将首先插入。然后是插入顺序值较高的条目。","通过直接提及其关键词插入的条目比那些在其他条目内容中提到的条目具有更高的优先级。"]},{"l":"最小激活数 (Min Activations)","p":["此设置与最大递归步骤互斥。","最小激活数：如果设置为非零值，这将忽略“扫描深度”的限制，从最新消息向后搜索所有聊天记录以查找关键词，直到触发指定数量的条目。这仍将受到最大深度设置或您的总体预算上限的限制。","由最小激活数触发的额外扫描不会检查在前几步通过递归添加的条目。只有聊天消息和扩展提示词可以触发这些额外的激活。但是，由最小激活数激活的条目可以像往常一样触发其他条目。"]},{"l":"最大深度 (Max Depth)","p":["使用最小激活数设置时扫描的最大深度。"]},{"l":"递归扫描 (Recursive scanning)","p":["递归扫描允许条目激活其他条目或被其他条目激活，从而实现不同世界信息条目之间的复杂交互和依赖关系。此功能可以显著增强创意场景的动态性。 是否启用递归扫描可以通过全局设置 递归扫描 (Recursive Scan) 来控制。 每个条目有三个选项可用于控制递归：","不可递归 (Non-recursable): 选中此复选框后，该条目不会被其他条目激活。这对于不应更改或受其他世界信息条目影响的静态信息很有用。","阻止进一步递归 (Prevent further recursion): 选择此选项可确保一旦此条目被激活，它将不会触发任何其他条目。这有助于避免意外的激活链。","延迟至递归 (Delay until recursion): 此条目仅在递归检查期间激活，这意味着它不会在初始过程中触发，但可以被启用了递归的其他条目激活。现在，为这些延迟添加了 递归级别，条目按级别分组。最初，只有第一级（最小数字）会匹配。一旦找不到匹配项，下一级就有资格进行匹配，重复此过程直到检查完所有级别。这允许更好地控制如何在递归期间揭示更深层次的信息，特别是与 NOT ANY 或 NOT ALL 关键词匹配组合等条件结合使用时。","条目可以通过在其内容文本中提及其他条目的关键词来激活它们。","例如，如果您的世界信息包含两个条目：","如果消息文本 仅提及 Bessie，则 两者 都将被拉入上下文。"]},{"l":"最大递归步骤 (Max Recursion Steps)","p":["此设置与最小激活数互斥。","当设置为零时，递归嵌套仅受您的提示词预算限制。当设置为非零值时，将总扫描次数限制为所需的最大“嵌套级别”。","示例值：","1 有效地禁用递归，因为检查在第一步后停止。","2 只能激活递归条目一次。","3 可以触发递归两次..."]},{"l":"区分大小写的关键词 (Case-sensitive keys)","p":["可在条目级别覆盖。","要拉入上下文，条目关键词需要与世界信息条目中定义的大小写匹配。","当您的关键词是常见单词或常见单词的一部分时，这很有用。","例如，当此设置处于活动状态时，关键词 'rose' 和 'Rose' 将根据输入进行不同的处理。"]},{"l":"匹配完整单词 (Match whole words)","p":["可在条目级别覆盖。","仅包含一个单词的关键词的条目仅当整个单词出现在搜索文本中时才会匹配。默认启用。","例如，如果启用此设置且条目关键词是 \"king\"，那么像 \"long live the king\" 这样的文本将被匹配，但 \"it's not to my liking\" 则不会。","重要提示： 此设置可能对不使用空格分隔单词的语言（例如日语或中文）产生不利影响。如果您使用这些语言编写条目，建议保持关闭。"]},{"l":"溢出警报 (Alert on overflow)","p":["如果激活的世界信息超过分配的词元预算，则显示警报。"]}],[{"l":"⚙️ 用户设置","p":["\uD83C\uDFA8 界面自定义","根据您的偏好更改聊天界面的主题和外观。","\uD83C\uDFAE 视觉小说模式","像《心跳文学部》等著名视觉小说游戏一样，与带有立绘的角色聊天。"]},{"l":"\uD83E\uDDE9 通用设置","p":["这些是影响您整体 SillyTavern 体验的核心设置。"]},{"l":"\uD83C\uDF10 界面语言","p":["SillyTavern 的用户界面支持多种语言。语言选择器提供以下选项：","默认：如果可用，则使用您的系统语言","English：无论系统设置如何，强制使用英语界面","通过下拉菜单可选择其他语言","注意：此设置仅影响用户界面文本。如需进行 AI 对话翻译，请使用 聊天翻译 扩展。"]},{"l":"\uD83D\uDD04 软件版本","p":["您当前的 SillyTavern 版本显示在右上角。此信息对于以下情况至关重要：","故障排除","确保与扩展的兼容性","确定是否有可用的更新","要将 SillyTavern 更新到最新版本，请参阅 更新 文档。"]},{"l":"\uD83D\uDC65 账户管理","p":["在 多用户模式 下控制您的 SillyTavern 用户账户、备份设置和用户数据，并管理用户角色和权限。"]},{"l":"账户","p":["⚠️ 危险区域","下载备份：导出所有用户数据的完整备份","个人资料信息","在“账户”对话框中，您可以查看和编辑您的个人资料信息、更改密码和管理账户设置。","密码状态（锁定/未锁定图标表示保护状态）","显示名称（可通过铅笔图标编辑）","更改密码：更新您的账户安全凭证","用户头像（也可使用 人物角色 更改）","用户角色","设置快照：创建、管理和恢复用户设置的备份","账户创建日期","账户句柄 (Handle)","账户操作","重置所有内容：完全清除账户并恢复出厂设置","重置设置：将所有设置恢复为出厂默认值","需要谨慎使用的关键账户操作："]},{"l":"管理面板","p":["多账户功能要求在 config.yaml 中将 enableUserAccounts 设置为 true。","选择 管理用户 以查看和管理现有用户账户。"]},{"l":"用户资料","p":["自定义头像管理（上传/删除）","显示名称和句柄","角色和状态信息","账户创建日期","密码保护状态"]},{"l":"账户控制","p":["编辑显示名称","启用账户","禁用账户","提升为管理员","降级为普通用户"]},{"l":"管理操作","p":["下载用户数据备份","更改用户密码","删除账户"]},{"l":"新用户","p":["选择 新用户 以创建新的用户账户。","显示名称*(例如：\"John Snow\")","用户句柄*(仅限小写字母、数字和破折号)","密码 (可选)","确认密码","创建新用户会自动在 /data/ 目录中生成一个子文件夹，使用用户句柄作为文件夹名称。"]},{"l":"注销","p":["注销您当前的会话。"]},{"l":"\uD83D\uDD0D 设置搜索","p":["一个便捷的搜索栏，帮助您快速找到特定设置：","输入任何关键词即可筛选并高亮显示“用户设置”中任何位置的设置","搜索设置名称和描述","帮助更高效地浏览复杂设置"]},{"l":"\uD83C\uDFA8 界面主题","p":["更改聊天界面的外观以适应您的偏好。","有关 用户设置 中此部分设置的更多信息，请参阅 界面自定义。"]},{"l":"\uD83E\uDDD1‍\uD83E\uDD1D‍\uD83E\uDDD1 角色处理","p":["角色列表副标题：选择在 角色 列表中角色名称下显示哪些附加信息：","角色版本","创建者","导入卡片标签：控制导入角色卡片时如何处理标签：","询问 - 每次导入时显示对话框","无 - 不导入任何标签","全部 - 导入所有标签","仅现有 - 仅导入已存在的标签","高级角色搜索：启用后，使用模糊匹配并搜索所有角色数据字段，而不仅仅是名称。","优先角色提示词：如果启用，则在可用时使用角色卡的系统提示词覆盖。","优先角色指令：如果启用，则在可用时使用角色卡的历史记录后指令覆盖。","永不调整头像大小：防止导入的角色图片被裁剪/调整大小。禁用时，图片将调整为 512x768。","显示头像文件名：在角色列表中显示角色头像的实际文件名。","无剧透模式：在编辑器面板中将角色定义隐藏在剧透按钮后面。"]},{"l":"\uD83E\uDDF0 杂项","p":["重新加载聊天：重新加载并重绘当前聊天。","调试菜单：访问调试选项。","平滑流式传输：实现更流畅文本生成的实验性功能。包含速度控制滑块。","消息提示音：消息生成完成时播放声音。","仅后台提示音：仅在浏览器标签页未聚焦时播放声音。","宽松的 API URL：减少对 API URL 格式的要求。","背景知识库导入对话框：导入包含嵌入式背景知识的角色时，显示世界信息/背景知识库的导入对话框。","自动选择输入文本：单击时自动选择某些输入字段中的文本。","Markdown 热键：启用用于 Markdown 格式化的键盘快捷键。","恢复用户输入：刷新页面时保留未保存的用户输入。","可移动UI：允许通过拖动重新定位 UI 元素（仅限 PC）。","重置 按钮可恢复默认位置","用于保存/加载 UI 布局的预设系统"]},{"l":"\uD83D\uDCAC 聊天/消息处理"},{"l":"\uD83D\uDCC4 消息显示设置","p":["控制消息在聊天界面中的加载和显示方式。这些设置影响整体聊天体验和性能。","加载消息数：分页前加载的聊天历史消息数量 (0 = 全部)","流式传输 FPS：流式文本的更新速度 (5-100 FPS)","示例消息行为：","逐步推出","始终包含示例","从不包含示例"]},{"l":"⌨️ 输入与响应控制","p":["决定消息发送方式以及 AI 如何继续其响应的设置。","按 Enter 发送：在禁用、自动（PC）或启用之间选择","按“发送”继续：使用发送按钮继续 AI 响应","快速“继续”按钮：显示用于扩展 AI 最后消息的按钮","快速“扮演”按钮：显示用于单条消息角色扮演的按钮","滑动：显示用于获取 AI 替代响应的箭头按钮（PC 和移动设备）","手势：启用用于生成的手势（仅限移动设备）"]},{"l":"\uD83E\uDD16 自动管理","p":["有助于管理聊天流程和内容的自动化功能。","自动加载上次聊天：启动时自动加载最近的聊天","自动滚动聊天：自动滚动到最新消息","自动保存消息编辑：无需确认即可保存消息编辑","确认删除消息：删除消息前提示","自动修复 Markdown：自动更正 Markdown 格式"]},{"l":"\uD83D\uDD04 自动滑动 (Auto-swipe)","p":["根据可配置的标准自动拒绝并重新生成 AI 消息。","启用自动滑动：自动滑动功能的主开关","生成消息的最小长度：如果消息短于此值，则触发自动滑动","黑名单词：可以触发自动滑动的单词列表，用逗号分隔","触发滑动的黑名单词数量：必须检测到的最小黑名单词数量才能触发自动滑动"]},{"l":"\uD83D\uDD04 自动继续 (Auto-Continue)","p":["如果模型在达到一定长度之前停止，则自动继续响应。","这让您的 AI 可以分多个部分编写长响应，这样您可以在保持较短的 响应长度设置 的同时，仍然获得长回复。","它不会让 AI 写出比原本更多的内容。要求 AI 继续一条它认为“已完成”的消息通常不起作用。有关其他想法，请参阅 如何让 AI 写更多？。","启用自动继续：自动继续功能的主开关","允许用于聊天补全 API：为聊天补全 API 端点启用自动继续功能","目标长度（词元）：期望的消息长度（以词元为单位）- 如果消息短于此值，将触发继续 (0-1024)"]},{"l":"\uD83D\uDCDD 消息格式与显示","p":["控制消息的格式以及显示的内容。","禁止外部媒体：阻止来自外部域的嵌入式媒体","在响应中显示 {{char}}：：如果生成了，则在响应中保留角色名称前缀","在响应中显示 {{user}}：：如果生成了，则在响应中保留用户名称前缀","在响应中显示标签：允许（部分）HTML 标签在响应中显示为 HTML","在群聊中放宽消息修剪：允许 AI 在群聊中代表其他角色发言，而不是停止响应生成","显示群聊队列：在群聊的角色列表中显示响应顺序","固定问候消息样式：即使消息因延迟加载而未加载，也始终渲染问候语中的样式标签。"]},{"l":"\uD83D\uDD0D 提示词检查与调试","p":["将提示词记录到控制台：将提示词输出到浏览器控制台","请求词元概率：向 API 请求 AI 响应的词元概率。在可用的情况下，可以在 词元概率面板 中查看这些概率。"]},{"l":"\uD83D\uDD24 自动完成 (AutoComplete)","p":["自动隐藏详细信息","匹配样式（开头为/包含/模糊）","视觉样式（主题/深色/浅色）","键盘选择选项","字体缩放","宽度控制"]},{"l":"\uD83D\uDCDC STscript 设置","p":["STscript 解析器 的配置选项。"]},{"l":"STRICT_ESCAPING","p":["在带引号的值中，管道符不需要转义。","符号前面的反斜杠可以被转义，以提供字面意义上的反斜杠后跟功能符号。","更多信息请参阅 严格转义。"]},{"l":"REPLACE_GETVAR","p":["当变量值包含可能被解释为宏的文本时，有助于避免双重替换。","更多信息请参阅 替换变量宏。"]},{"l":"\uD83E\uDDF9 清理菜单","p":["清理菜单提供了一个数据维护工具，可帮助您识别和删除 SillyTavern 安装中不必要的文件。此功能有助于保持数据目录井然有序，并可释放大量磁盘空间。","清理工具将永久删除文件。 此操作无法撤销！","手动上传到 /data/user/files/ 和 /data/user/images/ 目录的文件，如果未与聊天消息或资料库条目关联，将被删除。","如果不确定，请在使用清理菜单前备份您的数据。"]},{"l":"\uD83D\uDEE0️ 如何使用清理","p":["单击 杂项 部分下的 清理 按钮","单击 扫描 以分析您的安装。根据数据目录的大小，这可能需要一些时间","查看找到的文件类别","使用 查看 在删除前预览文件内容","使用 下载 在删除前保存文件","根据需要删除单个文件或整个类别"]},{"l":"\uD83D\uDCC2 清理类别","p":["清理工具将松散文件扫描到以下类别中："]},{"l":"文件","p":["查找内容：未与聊天消息或资料库条目关联的文件","位置：/data/用户句柄/user/files/","风险：⚠️ 将删除未在聊天中引用的手动上传文件","清理时机：如果不需要未引用的文件，可以安全删除"]},{"l":"图片","p":["查找内容：未与聊天消息关联的图片","位置：/data/用户句柄/user/images/","风险：⚠️ 将删除未在聊天中引用的手动上传图片","清理时机：如果不需要未引用的图片，可以安全删除"]},{"l":"聊天记录","p":["查找内容：与已删除角色关联的聊天文件","位置： data/用户句柄/chats/","风险：⚠️ 孤立的聊天记录将永久丢失","清理时机：如果您已故意删除角色且不再需要其聊天历史，可以安全删除"]},{"l":"群聊记录","p":["查找内容：与已删除群组关联的聊天文件","位置： data/用户句柄/group chats/","风险：⚠️ 孤立的群聊记录将永久丢失","清理时机：如果您已故意删除群组且不再需要其聊天历史，可以安全删除"]},{"l":"头像缩略图","p":["查找内容：缺失或已删除角色的头像缩略图","位置： data/用户句柄/thumbnails/avatar","风险：✅ 可安全删除- 需要时会自动重新生成缩略图","清理时机：始终可以安全清理，有助于释放空间"]},{"l":"背景缩略图","p":["查找内容：缺失或已删除背景的缩略图","位置： data/用户句柄/thumbnails/bg","风险：✅ 可安全删除- 需要时会自动重新生成缩略图","清理时机：始终可以安全清理，有助于释放空间"]},{"l":"聊天备份","p":["查找内容：自动生成的聊天备份","位置： data/用户句柄/backups/chat_*","风险：⚠️ 备份文件将永久丢失","清理时机：考虑保留最近的备份，但可以安全删除较旧的备份"]},{"l":"设置备份","p":["查找内容：自动生成的设置备份","位置： data/用户句柄/backups/settings_*","风险：⚠️ 设置备份文件将永久丢失","清理时机：考虑保留最近的备份，但可以安全删除较旧的备份"]},{"l":"\uD83D\uDC1E 调试菜单","p":["除非您完全了解其后果，否则请勿使用。","调试菜单提供用于故障排除、维护和开发目的的功能。应谨慎使用这些功能，因为它们会严重影响您的 SillyTavern 安装。","由于扩展可以添加调试功能，可用选项将根据您安装的扩展而有所不同。"]},{"l":"\uD83C\uDF10 翻译与区域设置功能","p":["获取缺失的翻译：分析当前区域设置（如果选择英语，则分析所有区域设置）以查找缺失的翻译，并将结果输出到浏览器控制台","应用区域设置：通过重新应用选定的区域设置，强制刷新当前语言设置"]},{"l":"\uD83D\uDCBE 缓存与存储管理","p":["清除网络搜索缓存：从本地缓存中删除所有存储的搜索结果","清除所有向量索引：完全删除所有来源中存储的所有向量","重置词元缓存：清除存储的词元计数，强制对所有聊天进行完整的重新词元化","删除分项提示词：从本地存储中删除所有分项提示词"]},{"l":"\uD83D\uDCCA 数据与统计","p":["刷新统计文件：使用现有聊天数据重建统计文件","回填词元计数器：重新计算当前聊天中所有消息的词元计数","在切换使用不同分词器的模型时很有用","完成后触发聊天重新加载","仅视觉更改，不修改聊天内容"]},{"l":"\uD83D\uDD0C API 与扩展测试","p":["更改 Mancer 基础 URL：修改 Mancer API 服务器的基础 URL","测试网络搜索扩展：使用当前设置执行测试搜索","发送生成请求：使用当前选定的 API 测试文本生成"]},{"l":"\uD83D\uDDA5️ 系统与调试工具","p":["强制引导：重新启动引导过程","切换事件跟踪：启用/禁用用于调试的事件跟踪","复制 ST 设置：[进行中] 将系统配置数据复制到剪贴板以用于错误报告","每个功能都可以使用其描述下方的“执行”按钮来运行。在使用这些工具之前，请考虑备份您的数据，因为某些操作无法撤销。"]}],[{"l":"\uD83C\uDFA8 界面自定义"},{"l":"\uD83C\uDFAD 界面主题"},{"l":"主题管理","p":["主题文件允许您保存、共享和重复使用您的界面自定义设置。您可以维护多个主题以适应不同的心情或用途，并可以即时切换它们。","导入/导出主题文件","删除现有主题","将更改保存到当前主题","另存为新主题","本节中的所有设置都会保存到当前主题中。如果您切换主题，设置将被新主题的设置替换。"]},{"l":"显示设置","p":["这些显示选项会影响角色和消息在聊天界面中的呈现方式。"]},{"l":"头像样式","p":["在圆形、方形、矩形或圆角方形之间选择。此设置同时适用于用户和 AI 头像。"]},{"l":"聊天样式","p":["样式","描述","斜杠命令","扁平","简洁连续的“聊天日志”风格，一个平坦的画布，让您的 AI 互动栩栩如生。","/flat/default","气泡","“即时通讯器”风格，每条消息都有独特的气泡、令人愉悦的圆角和微妙的 3D 效果。","/bubble/bubbles","文档","紧凑、类似文档的外观，采用以文本为中心的布局。隐藏过去消息的头像、时间戳和消息控制按钮。","/single/story"]},{"l":"通知","p":["设置通知弹出框（ toast 消息）在屏幕上出现的位置。","左上角","顶部居中（默认）","右上角","左下角","底部居中","右下角"]},{"l":"主题颜色","p":["自定义每个 UI 元素的配色方案，创建您完美的主题。可以使用颜色选择器选择颜色，并在适用的情况下包含透明度选项。","主文本","斜体文本","下划线文本","引用文本","文本阴影","聊天背景","界面背景","界面边框","用户消息","AI 消息"]},{"l":"布局与视觉设置","p":["使用这些滑块微调界面的视觉呈现。","聊天宽度：调整聊天窗口宽度（屏幕的 25-100%）","字体缩放：自定义文本大小（0.5-1.5 倍）","模糊强度：控制 UI 面板模糊度（0-30）","阴影宽度：调整文本阴影强度（0-5）"]},{"l":"主题切换开关","p":["减少动效：禁用动画和过渡效果","头像悬停放大：头像悬停时的缩放效果","展开消息操作：始终显示完整的消息上下文菜单","所有消息显示滑动编号：在所有消息上显示滑动编号","无文本阴影：禁用文本阴影效果","无模糊效果：移除背景模糊以提高性能","标签作为文件夹：使用标签作为文件夹来组织角色","模型图标：为消息显示 AI 模型图标","消息 ID：显示顺序消息编号","消息计时器：显示 AI 响应生成时间","消息词元计数：显示每条消息的词元数量","点击编辑：点击消息即可快速打开消息编辑器","疯狂实验室模式：无限制的参数范围","视觉小说模式：紧凑聊天界面，带有背景立绘","禅意滑块：简化的参数控件","紧凑输入区域：单行输入（仅限移动设备）","聊天时间戳：显示消息时间戳","角色热切换：收藏角色的快速选择按钮","这些开关控制各种 UI 功能和行为。某些选项可以提高低端设备上的性能，而其他选项则为聊天界面添加有用的信息或功能。","隐藏聊天头像：从聊天中移除头像"]},{"l":"自定义 CSS","p":["允许您应用自定义 CSS 样式以进一步自定义聊天界面的外观。","使用 展开 来展开编辑器窗口，以获得更好的可见性和编辑体验。","如果您切换主题，您的自定义 CSS 将被新主题的自定义 CSS 替换。如果您希望在切换主题时保留自定义 CSS，请确保将其保存到主题中。","如果您使用大量自定义 CSS，或者希望将相同的自定义 CSS 用于多个主题，非官方的 CSS 代码片段扩展 可以帮助您管理和组织您的自定义 CSS。"]},{"l":"\uD83D\uDD0A 消息提示音","p":["要在收到机器人的新消息时播放您自定义的声音，请在您的 SillyTavern 文件夹中替换以下 MP3 文件：","public/sounds/message.mp3","以 80% 的音量播放。","如果启用了“ 仅后台声音”选项，则仅在 SillyTavern 窗口 未聚焦 时播放声音。"]},{"l":"\uD83D\uDCD0 公式渲染","p":["要启用数学公式渲染，请使用 LaTeX 扩展。要获取该扩展，您需要通过 SillyTavern 中的“下载扩展和资源”菜单进行安装。","分别在代码块中使用 latex 或 asciimath 语言标识符来键入您的 LaTeX 和 AsciiMath 公式。该扩展使用 KaTeX 进行渲染。","不再支持旧的 $ 和 $$ 包装语法。请使用以下正则表达式脚本来填充旧语法：","$$ - LaTeX","$ - AsciiMath"]}],[{"l":"\uD83C\uDFAE 视觉小说模式","p":["视觉小说（VN）模式是 SillyTavern 的一种特殊屏幕布局，让你能与带有立绘（或角色卡片图像）的角色聊天，体验类似于《心跳文学部》、《灰色的果实》、《Fate/stay night》等著名视觉小说游戏。"]},{"l":"\uD83D\uDD04 切换视觉小说模式"},{"l":"✅ 启用视觉小说模式","p":["视觉小说模式内置于 SillyTavern。可通过进入 用户设置（用户设置图标），在 无文字阴影 选项下方勾选 视觉小说模式 来启用。","用户设置"]},{"l":"❌ 禁用视觉小说模式","p":["禁用步骤与启用相同。取消勾选视觉小说模式即可返回常规聊天界面。","某些扩展（如 Prome VN 扩展）在使用其自带的 VN 模式时会自动开启‘视觉小说模式’。通过 用户设置 菜单启用/禁用 VN 模式同样会影响这些扩展。"]},{"l":"\uD83D\uDDA5️ 视觉小说界面","p":["VN 显示","在视觉小说模式下，界面略有调整，以容纳显示在中央的角色立绘（或角色卡片图像）。然而，在包含多个角色的群聊中，角色立绘会分散开来，相互适应，如下图所示。","群组 VN 显示"]},{"l":"\uD83E\uDDED 搭配 MovingUI 使用 VN 模式","p":["要切换 MovingUI，请进入 用户设置 并勾选 MovingUI。请注意，此功能 仅 在桌面端有效。","如果在 用户设置 中启用了 MovingUI，你可以随意移动立绘（或角色卡片图像），将它们放置在屏幕上更具体的位置。","如果你的角色立绘尺寸较大，使用 MovingUI 移动特定立绘可能会比较困难，因为拖拽按钮可能被其他立绘遮盖。你可能需要比平常更多地移动它们，尤其是在屏幕上有更多角色时，以获得更好的布局。","群组 VN 显示 (MovingUI)"]},{"l":"\uD83D\uDDBC️ 获取角色立绘","p":["获取角色立绘可以通过在网上搜索现有立绘来实现，例如，来自现有视觉小说或使用视觉小说功能（如 DDLC 或《CounterSide》）的游戏中的角色。如果你想要的角色没有现成的立绘，你还有几个选择。","在角色帖子中搜索精灵 ZIP 包或链接。","有些机器人创作者可能会随他们的机器人发布精灵包（或在同一帖子中，或在专门的精灵频道中）。搜索这些帖子，看看是否已经有人为你想要的角色制作了立绘。","使用 LoRAs 和 Stable Diffusion 自己创建。","从头开始生成立绘非常耗时（尤其是在你的角色没有现成 LoRA 和/或你想用的 Stable Diffusion 模型没有对应资源的情况下），并且需要不错的硬件来生成。如果你计划制作 28 种表情立绘而不是 6 种，或者使用 SDXL 和/或将立绘升级到更高分辨率，则对硬件要求更高。","使用角色卡片图像。它可能不像立绘，但至少屏幕上有东西可看。但是， VN 模式中无法使用多个角色卡片图像。","在 Prome 视觉小说扩展 1.0.6+ 版本中，有一个名为 模拟角色卡片为立绘 的功能，允许你在群聊中同时使用带有立绘和不带立绘的角色，方法是将后者的角色卡片图像在聊天中当作立绘使用。","角色卡片群聊"]},{"l":"\uD83D\uDD0C VN 扩展"},{"l":"✨ Prome 视觉小说扩展","p":["Prome 视觉小说扩展是由 Bronya Rand 和 Prometheus 认可的第三方扩展，它通过诸如“Letterbox 模式”（使视觉小说界面更具“电影感”）、“聚焦模式与立绘变暗”、“传统 VN 模式”（仅显示聊天中的最后一条消息）等功能，进一步增强了 SillyTavern 的视觉小说体验，并且还有更多功能计划中！","Letterbox 模式","传统 VN 模式","横向 Letterbox 模式","隐藏对话框 (Message Box)","聚焦模式 (含立绘变暗)","隐藏对话框","聚焦模式含立绘变暗","要安装 Prome 视觉小说扩展，你可以通过 下载扩展与资源 找到 Prome Visual Novel Extension，或按照 Prome Visual Novel Extension Github 页面上的安装说明进行操作。调整 Prome 的设置可以在 扩展-> Prome (Visual Novel Extension) 或通过 \uD83E\uDE84 (魔杖) 菜单找到。"]}],[{"l":"\uD83D\uDC64 人设系统"},{"l":"何为“人设”？","p":["在 SillyTavern 中，人设（Persona）是您在聊天中所使用的身份——本质上是您的显示名称、头像及可选描述文本的组合。人设功能让您轻松切换扮演的角色或“人物”，无需每次都手动更新用户名和头像。","注意： 旧版中未与人设关联的用户头像/名称已被移除。现有数据将迁移至人设系统。若原未指定名称，人设将被命名为“【未命名人设】”。"]},{"l":"如何创建人设？","p":["打开 人设管理 面板（顶部菜单中的 按钮）。","点击 创建 按钮新建一个空白人设，并为其命名。","在人设列表中，选中新创建的人设。","在右侧，您可以填写描述并通过“更改人设图像”按钮设置头像。两者均为可选。","现在，您的人设即可在聊天中使用了。"]},{"l":"将角色转换为人设","p":["也可以通过转换任何现有角色来创建人设。只需打开角色，选择“更多…”，然后点击“转换为人设”。系统将创建一个具有相同名称和描述的人设。角色卡中的其他字段（如场景或性格）不会被使用。原角色不会被删除。","由于 {{user}} 和 {{char}} 宏在人设描述和角色描述中含义相反，如果转换后的描述包含任一宏，系统将提示您交换它们。"]},{"l":"人设描述","p":["每个人设都可以存储一段自定义文本描述——包括心理和生理特征、年龄、职业或任何个人细节。这些描述也可包含模板宏，例如 {{char}} 或 {{user}}（参见 宏）。","您的人设描述注入到 AI 提示词（prompt）中的位置取决于 人设管理 面板中的 位置（Position） 设置：","无（禁用）","在故事字符串 / 提示管理器内（默认）","作者笔记顶部/ 作者笔记底部（仅在存在作者笔记时添加）","在聊天@深度（这将打开配置选项以设置深度和角色）","该位置设置 按人设保存。"]},{"l":"人设标题","p":["标题是一个可选的文本字段，可用于存储关于人设的附加信息，它 不用于提示词，但会在人设管理面板中显示。","要设置标题，请点击人设管理面板中的** 重命名人设** 按钮，并在“人设标题”字段中输入，或在创建人设时指定。若标题已存在，将其设置为空值则会移除它。"]},{"l":"人设关联 / 锁定","p":["人设关联确保在特定情况下自动选用指定的人设。如果未关联任何人设，则将保持当前选中的人设。","共有三种锁定类型：","聊天锁定– 将人设锁定到当前聊天。","角色锁定– 将人设锁定到特定角色。","默认人设– 一个在没有其他锁适用时始终使用的人设。"]},{"l":"1. 锁定到聊天","p":["如果将人设锁定到某个聊天，则将来打开该聊天时会自动将您的活跃人设切换为锁定的那个人设。","锁定：选中所需人设，然后点击“关联”部分下的 聊天 按钮（或使用 /persona-lock type=chat on）。","解锁：再次点击该按钮（或使用 /persona-lock type=chat off）。"]},{"l":"2. 锁定到角色","p":["您也可以将人设链接到特定角色。打开与该角色的任何聊天都会自动选择您锁定的人设。","锁定：选中所需人设，然后点击“关联”部分下的 角色 按钮（或使用 /persona-lock type=character on）。","解锁：再次点击该按钮（或使用 /persona-lock type=character off）。","人设管理面板也会显示哪些角色链接到了该人设（显示为小头像）。点击它们可直接导航到该角色的聊天窗口。"]},{"l":"将多个人设锁定到同一角色","p":["如果该角色已链接了另一个人设，则默认情况下原链接会自动解除。","若要允许多个人设同时链接，可使用全局设置 允许每个角色存在多个人设关联。 如果多个人设链接到同一角色，则每次打开或新建该角色的聊天时，您都会看到一个弹出窗口，询问要使用哪个人设（除非已有人设绑定到该聊天）。"]},{"l":"3. 默认人设","p":["您的 默认人设 会在没有其他相关锁定时使用。默认人设可通过其头像周围的黄色边框识别。","设置/取消默认：选中所需人设，然后点击“关联”部分下的 默认 按钮（或使用 /persona-lock type=default）。","只能选择一个人设作为默认人设。"]},{"l":"临时人设","p":["如果三种关联选项中的任何一种将某人设连接到当前角色/聊天，您仍然可以选择使用不同的人设。此人设将在人设面板中标记为“临时人设”。任何浏览器窗口的重载或切换到其他聊天再返回的操作都会将其重置回链接的人设。","您可以通过将其链接到聊天，手动将 临时人设 转换 为持久关联。"]},{"l":"全局人设设置","p":["当前人设 下的所有设置都是按人设保存的。也存在一些全局设置，这些可以在人设管理面板的 全局人设设置 下找到。","切换人设时显示通知","启用人设相关的提示消息（例如，“人设已自动选择”、“临时人设”）。","允许每个角色存在多个人设关联","启用 后，您可以将多个人设链接到单个角色。打开该角色的聊天时会提示您选择要使用的人设。若禁用，则一个角色一次只能连接一个人设。","自动将选中的人设锁定到聊天","启用 后，每当您选择一个人设（手动或自动选择）或创建新聊天时，都会将此人设锁定到该聊天。 结合“允许多个”设置，这提供了按角色选择人设，但一旦为聊天选定即保持绑定的选项。"]},{"l":"人设相关斜杠命令"},{"l":"/persona-lock type=类型?","p":["chat 将当前人设锁定到您的活跃聊天。","character 将当前人设锁定到正在使用的角色。","none（或无参数）解锁/清除当前上下文的人设锁定。","如果无参数使用，则返回当前锁定状态（如果未设置则返回错误）。","锁定状态可通过 on、 off 或 toggle 选择。默认为 toggle。"]},{"l":"/persona 名称","p":["无需打开人设管理面板，即可按名称快速切换您的活跃人设。","示例：/persona Blaze。","使用 mode=temp 允许临时设置 当前 人设的名称，即使同名人设可能已存在（会保留您当前的头像和描述）。"]},{"l":"/persona-sync","p":["将活跃聊天中的所有用户消息重新归属（re-attribute）到 当前 人设及其名称。","注意： 旧的 /lock 和 /unlock 命令为向后兼容而保留，但未来可能会移除。请使用 /persona-lock。"]},{"l":"\uD83D\uDCA1 高级技巧","p":["在聊天中途切换人设 不会将您过去的用户消息重新归属到新的人设；这些消息仍归属于您发送时使用的人设。","批量重新归属：如果您需要所有先前的消息都匹配新的人设，请点击 同步 按钮或使用 /persona-sync。","更换人设图像 而不丢失描述或锁定：选择您的人设并点击 更改人设图像 按钮。","角色链接弹出窗口：如果多个人设链接到同一角色，每次打开聊天时都会弹出窗口让您选择人设。这是一种为特定角色准备少量人设以供选择的便捷方法。","备份：您可以使用人设管理中的 备份 按钮备份整个人设列表（名称、角色关联、描述），并在需要时恢复。","图像和聊天关联不会与人设一起保存，也不会通过此方式备份。","这些备份包含内部链接，并非设计用于共享。"]}],[{"l":"\uD83E\uDDD1‍\uD83E\uDD1D‍\uD83E\uDDD1 角色管理","p":["角色是您可创建与管理的AI身份，用以塑造对话中AI的角色定位。每个角色均具备名称、个性及对话历史。您可自由创建多个角色，并随时切换使用。","角色既可用于单人聊天，也可加入群聊实现多角色互动。"]},{"l":"\uD83D\uDDA5️ 角色管理面板","p":["通过导航栏打开 角色 面板即可访问角色列表。点击角色或群组即可对话或编辑，或选择 创建新角色 添加新角色。"]},{"l":"⚙️ 面板控件","p":["固定面板：交互时保持面板开启","角色列表：返回角色列表视图","快速切换栏：一键访问收藏角色"]},{"l":"\uD83D\uDDC2️ 角色列表","p":["创建新角色：新增角色","导入角色：从文件加载角色","外部导入：通过URL导入","创建群组：开启新群聊"]},{"l":"\uD83D\uDD0D 搜索与排序","p":["搜索栏：按名称或属性筛选角色","排序下拉菜单：支持多种排序方式：","字母序（A-Z, Z-A）","时间序（最新, 最旧）","使用频次（最近, 聊天最多/最少）","令牌数量（最多/最少）","特殊筛选（收藏, 随机）"]},{"l":"\uD83C\uDFF7️ 按类型/标签筛选","p":["收藏筛选：显示收藏角色","群组筛选：仅显示群聊","标签文件夹：按标签层级管理","管理标签： 标签配置","标签列表：查看所有可用标签","清除筛选：重置所有筛选条件"]},{"l":"✏️ 角色创建/编辑面板","p":["头像图片：上传预览角色头像","令牌计数：角色 令牌使用情况","数据统计：聊天历史与使用统计","标签管理"]},{"l":"⚡ 快捷操作","p":["收藏切换","高级定义","角色背景知识","聊天背景：关联 世界信息","导出角色","复制角色","删除角色"]},{"l":"\uD83E\uDDE9 扩展功能","p":["世界信息关联","卡片背景导入","场景覆盖","人格转换","角色重命名","源链接设置","替换/更新","标签导入","图库视图"]},{"l":"\uD83D\uDCDD 内容字段","p":["角色描述：角色概要说明","首条消息：新聊天初始问候/提示","替代问候语：可滑动切换的多组初始消息"]},{"l":"\uD83E\uDDE0 高级定义面板","p":["点击 高级定义 按钮访问扩展设置。"]},{"l":"\uD83D\uDD04 提示词覆盖（聊天补全/指令模式）","p":["主提示词：替换默认 主提示词/系统提示词，支持通过{{original}}占位符保留原提示词","历史记录后指令：覆盖默认 历史记录后指令"]},{"l":"\uD83D\uDCCB 创作者元数据","p":["角色非提示词信息：","创作者名称/联系方式","角色版本号","创作者注释","嵌入式标签列表"]},{"l":"\uD83C\uDF1F 角色个性","p":["性格摘要：角色特质概览","场景设定：对话背景与环境","角色注释：可设置深度与消息角色的自定义内容（参见 作者注）","活跃度（群聊）：害羞→正常→健谈 滑动调节","示例消息：角色写作风格范例"]},{"l":"\uD83D\uDC65 群聊管理","p":["群聊场景下可通过本面板管理成员及设置。","详情参见 群聊功能。"]}],[{"l":"\uD83C\uDFAD 角色设计","p":["角色名称是唯一必填项。其余部分均可留空，您仍可在聊天中使用该角色。"]},{"l":"\uD83D\uDCDD 角色描述","p":["用于添加角色描述及其他相关AI信息。这些信息始终会包含在提示词中，因此所有重要事实都应在此处说明。","例如，您可以添加故事发生的世界背景信息，描述角色的外貌、性格和背景故事。","描述长度不限（无论是200还是2000个令牌），格式亦无限制（自由文本、伪代码对话风格等均可）。"]},{"l":"方法与格式","p":["角色格式设置方法是个复杂话题，已超出本文档范围。","推荐以下经过SillyTavern功能测试或依赖其功能的指南：","Trappu的PLists + Ali:Chat指南： https://wikia.schneedc.com/bot-creation/trappu/creation","AliCat的Ali:Chat指南： https://rentry.co/alichat","kingbri的极简指南： https://rentry.co/kingbri-chara-guide"]},{"l":"\uD83D\uDD22 角色令牌","p":["简明总结：若您使用的AI模型上下文令牌限制为2048，那么一个1000令牌的角色定义会将AI的“记忆”容量削减一半。","具体来说，一个优质AI的得体回复通常约为200-300令牌。在此情况下，AI仅能“记住”约3轮对话历史。"]},{"l":"为何我的角色令牌计数器变红了？","p":["当检测到角色定义令牌数超过模型定义上下文长度的一半时，系统会进行高亮提示，因为这可能会降低AI提供愉快对话体验的能力。"]},{"l":"角色令牌过多会怎样？","p":["请放心——这不会造成任何破坏。最坏情况下，如果角色的永久令牌过多，仅仅意味着上下文中留给其他内容的剩余空间减少（详见下文）。","唯一可能产生的负面影响是AI的“记忆”会变差，因为它能处理的聊天历史记录更少。","这是因为每个AI模型单次能处理的上下文内容都存在上限。"]},{"l":"\uD83D\uDCD6 何为“上下文”？","p":["这是每次请求AI生成回复时发送给它的信息。SillyTavern在将信息发送给AI模型前，会自动计算分配可用上下文令牌的最佳方式。","更多关于上下文构建方式的信息，请阅读 提示词 章节。"]},{"l":"什么是角色的“永久令牌”？","p":["以下内容会在每次生成请求时始终发送给AI：","角色名称","角色描述框","角色性格框","场景框"]},{"l":"角色定义中哪些部分非永久性？","p":["首条消息框 - 仅在聊天开始时发送一次。","示例消息框 - 仅在聊天历史未填满上下文前保留（可选强制将其保留在上下文中）"]},{"l":"常见AI模型上下文令牌限制","p":["LLaMA 3及其微调版 - 8192","OpenAI GPT-4 - 最高128k","Google Gemini - 最高2M","Anthropic的Claude - 200k (Claude 3)","NovelAI - 8192 (Erato与Kayra，Opus层级；Clio，所有层级)、6144 (Kayra，Scroll层级) 或 3072 (Kayra，Tablet层级)"]},{"l":"✉️ 首条消息","p":["首条消息是定义角色交流方式与风格的重要元素。模型极有可能从首条消息中获取风格和长度限制，而非其他内容，因此请以您期望的回复方式（简洁精炼、详尽细致等）来撰写它。","支持Markdown和HTML格式。","例如："]},{"l":"\uD83D\uDD00 备用问候语","p":["此处添加的消息在开始新聊天时，会作为角色首条消息的附加“滑动选项”显示。若角色参与群聊，系统会随机选择其中一条问候语来开启对话。"]},{"l":"⭐ 收藏角色","p":["点击** 添加到收藏** 按钮可将角色标记为收藏，以便在侧边菜单栏选择“收藏”排序选项时快速筛选。收藏角色在列表中会有金色高亮显示。这也会使角色肖像出现在热切换区域（若在用户设置中已启用）。"]},{"l":"⚙️ 高级定义","p":["以下字段默认隐藏。要访问和编辑它们，您需要点击角色定义页面菜单栏上的** 高级定义** 按钮。"]},{"l":"提示词覆盖","p":["主提示词：若启用“首选角色提示词”用户设置，您在此处输入的任何文本将覆盖该角色的 主/系统提示词。","历史记录后指令：若启用“首选角色指令”用户设置，您在此处输入的任何文本将用作该角色的 历史记录后指令。","在任一框中插入{{original}} 可在指定位置包含系统设置中的相应默认提示词。"]},{"l":"创作者元数据","p":["不用于提示词构建，但提供关于角色的额外元数据。","创建者：角色创建者的名称。若“角色列表副标题”用户设置相应配置，可在角色列表中显示。","角色版本：角色的版本号。若“角色列表副标题”用户设置相应配置，可在角色列表中显示。","创作者注释：创作者希望分享的关于角色的任何额外说明。前几行会显示在角色列表中，全文则显示在角色页面的“创作者注释”部分。支持Markdown/HTML格式。","要嵌入的标签：以逗号分隔的标签列表，这些标签将嵌入角色描述中。导入角色时默认不会导入这些标签，但您可以通过角色页面“更多...”菜单中的“导入标签”选项将其与现有标签合并。"]},{"l":"性格摘要","p":["角色性格的简要总结。"]},{"l":"场景","p":["对话的情境与背景。"]},{"l":"角色注释","p":["用于在特定消息深度作为角色聊天中的提示词注入的文本。通常用于强化某些角色特质，因为它始终保持在聊天历史中的静态深度，无论对话如何进展。","@ 深度：此注释将被注入时，聊天历史中的消息数量（从最新到最旧计数）。若设置为0，则将在最后一条消息后注入。","角色：消息的角色。可为“用户”、“系统”或“助理”。"]},{"l":"健谈度","p":["决定在群聊中使用 自然 激活顺序时，触发角色回复的概率。范围从0%到100%，默认值为50%。"]},{"l":"对话示例","p":["描述角色的说话方式。每个示例前需添加 START 标签。示例对话块仅在上下文中有空闲空间时插入，并按块被挤出上下文区块。 START 不会出现在提示词中，它仅是一个标记；对于文本补全API，它将被“示例分隔符”（来自高级格式化设置）替换；对于聊天补全API，它将被“新示例聊天”实用提示词的内容替换。","使用{{char}}: 前缀表示角色消息。","使用{{user}}: 前缀表示用户消息。","示例："]}],[{"l":"\uD83D\uDD00 宏（替换标签）","p":["此列表可能不完整或已过时。在任何SillyTavern聊天中使用 /help macros 斜杠命令可获取当前实例中可用的宏列表。","宏可用于角色描述、作者注释、世界信息等许多地方，并在生成回复时替换为相应值。它们可用于向提示词中插入动态内容，例如用户名称、角色描述或当前时间。宏由双花括号包裹，例如 {{user}}，且通常不区分大小写。 请注意，目前不支持宏嵌套。","注意：某些扩展可能还会添加特殊的上下文相关宏，这些宏仅在特定区域有效（例如扩展提示词的特殊占位符）。除非宏不绑定特定功能，否则此处不会记录它们。"]},{"l":"\uD83C\uDF10 通用宏","p":["{{// (note)}}","{{banned text here}}","{{bias text here}}","{{char}} 或 BOT","{{charDepthPrompt}}","{{charJailbreak}}","{{charPrompt}}","{{charVersion}}","{{currentSwipeId}}","{{date}}","{{datetimeformat ...}}","{{description}}","{{firstIncludedMessageId}}","{{group}} 或 {{charIfNotGroup}}","{{groupNotMuted}}","{{idle_duration}}","{{input}}","{{isodate}}","{{isotime}}","{{lastCharMessage}}","{{lastGenerationType}}","{{lastMessage}}","{{lastMessageId}}","{{lastSwipeId}}","{{lastUserMessage}}","{{mesExamples}}","{{mesExamplesRaw}}","{{model}}","{{newline}}","{{noop}}","{{original}}","{{persona}}","{{personality}}","{{pick::(args)}}","{{pipe}}","{{random::arg1::arg2}}","{{random:(args)}}","{{reverse:(content)}}","{{roll:(formula)}}","{{scenario}}","{{time_UTC±X}}","{{time}}","{{timeDiff::(time1)::(time2)}}","{{trim}}","{{user}} 或 USER","{{weekday}}","time1 和 time2 之间的时间差。接受时间和日期宏。","上下文中包含的第一条消息的ID。需要在当前会话中至少运行一次生成。","为AI设置行为偏差，直到下一次用户输入。文本周围的引号是必需的。","仅用于斜杠命令批处理。替换为前一个命令返回的结果。","从列表中返回一个随机项（例如 {{random:1,2,3,4}} 将随机返回4个数字中的1个）。","使用D&D骰子语法生成随机值：XdY+Z（例如 {{roll:d6}} 生成1-6的值）。","修剪此宏周围的换行符。","允许留下将被替换为空白内容的注释。对AI不可见。","最后一条聊天消息ID。","最后一条聊天消息中的滑动选项数量。","最后一条聊天消息文本。","最后排队的生成请求类型。值：\"normal\"（正常）、\"impersonate\"（冒充）、\"regenerate\"（重新生成）、\"quiet\"（安静）、\"swipe\"（滑动）、\"continue\"（继续）。","动态将引用的文本添加到Text Generation WebUI后端的禁止词序列中。对其他后端无效。需要引号。","反转宏的内容。","可在提示词覆盖字段中使用，以包含系统设置中的默认提示词。仅适用于聊天补全API和指令模式。","同 {{group}}，但排除被静音的成员。","宏","当前ISO日期（YYYY-MM-DD）。","当前ISO时间（24小时制）。","当前所选API的文本生成模型名称。 可能不准确！","当前星期几。","当前显示的最后一条消息滑动选项的基于1的ID。","当前系统日期。","当前系统时间。","指定UTC偏移（时区）的当前时间，例如对于UTC+02:00使用 {{time_UTC+2}}。","指定格式的当前日期/时间（例如 {{datetimeformat DD.MM.YYYY HH:mm}}）。","描述","插入换行符。","插入自最后一条用户消息发送以来时间范围的人性化字符串（例如：4小时、1天）。","支持参数中包含逗号的随机宏的替代语法。","无操作，仅为空字符串。","用户发送的最后一条聊天消息。","用户名称。","用户的角色描述。","用户输入栏的内容。","群组成员名称的逗号分隔列表，或在单人聊天中为角色名称。","角色发送的最后一条聊天消息。","角色名称。","角色场景或聊天场景覆盖（如果已设置）。","角色性格。","角色描述。","角色的主提示词覆盖内容。","角色的历史记录后指令提示词覆盖内容。","角色的对话示例（指令格式）。","角色的对话示例（未经更改和未拆分）。","角色的指定深度提示词。","角色的版本号。","随机的替代方案，但如果源字符串保持不变，则在当前聊天的后续评估中选定的参数是稳定的。"]},{"l":"\uD83D\uDCCB 指令模式与上下文模板宏","p":["（在高级格式化设置中启用）","{{chatStart}}","{{defaultSystemPrompt}}","{{exampleSeparator}}","{{instructAssistantPrefix}}","{{instructAssistantSuffix}}","{{instructFirstAssistantPrefix}}","{{instructFirstUserPrefix}}","{{instructLastAssistantPrefix}}","{{instructLastUserPrefix}}","{{instructStop}}","{{instructSystemInstructionPrefix}}","{{instructSystemPrefix}}","{{instructSystemPrompt}}","{{instructSystemPromptPrefix}}","{{instructSystemPromptSuffix}}","{{instructSystemSuffix}}","{{instructUserFiller}}","{{instructUserPrefix}}","{{instructUserSuffix}}","{{maxPrompt}}","{{systemPrompt}}","上下文模板示例对话分隔符。","上下文模板聊天开始行。","助理最后输出序列。","助理消息前缀序列。","助理消息后缀序列。","助理首次输出序列。","宏","指令停止序列。","指令用户最后输入序列。","指令用户首次输入序列。","指令系统提示词。","描述","提示词的最大令牌大小（上下文长度减去响应长度）。","用户填充消息文本。","用户消息前缀序列。","用户消息后缀序列。","系统指令前缀序列。","系统提示词内容，包括角色提示词覆盖（如果允许且可用）。","系统提示词内容（不包括角色提示词覆盖）。","系统提示词前缀序列。","系统提示词后缀序列。","系统消息前缀序列。","系统消息后缀序列。"]},{"l":"\uD83D\uDCAC 聊天变量宏","p":["{{addglobalvar::name::value}}","{{addvar::name::increment}}","{{decglobalvar::name}}","{{decvar::name}}","{{getglobalvar::name}}","{{getvar::name}}","{{incglobalvar::name}}","{{incvar::name}}","{{setglobalvar::name::value}}","{{setvar::name::value}}","{{var::name::index}}","{{var::name}}","全局变量 = 可在任何聊天中用于任何角色","宏","局部变量 = 仅当前聊天独有","描述","替换为作用域变量“name”在索引处的值（用于STscript中的数组/对象）。","替换为作用域变量“name”的值（仅限STscript）。","替换为全局变量“name”的值。","替换为将全局变量“name”的值减少1的结果。","替换为将全局变量“name”的值增加1的结果。","替换为将变量“name”的值减少1的结果。","替换为将变量“name”的值增加1的结果。","替换为局部变量“name”的值。","替换为空字符串，将全局变量“name”设置为“value”。允许空值。","替换为空字符串，将局部变量“name”设置为“value”。允许空值。","替换为空字符串，将数字值“increment”加到全局变量“name”上。","替换为空字符串，将数字值“increment”加到局部变量“name”上。"]},{"l":"\uD83D\uDD27 扩展特定宏","p":["由扩展添加，仅在特定条件下工作。","宏","描述","{{summary}}","替换为当前聊天会话的摘要（如果可用）。","{{authorsNote}}","替换为作者注释的内容。","{{charAuthorsNote}}","替换为角色作者注释的内容。","{{defaultAuthorsNote}}","替换为默认作者注释的内容。","{{charPrefix}}","替换为角色特定的图像生成正面提示词前缀（如果可用）。","{{charNegativePrefix}}","替换为角色特定的图像生成负面提示词前缀（如果可用）。"]}],[{"l":"\uD83D\uDCC1 聊天文件管理","p":["本页介绍如何管理您的 AI 聊天文件。","部分选项可在左下角选项菜单中的“管理聊天文件”对话框中找到。"]},{"l":"私聊 \uD83C\uDD9A 群聊","p":["使用角色卡最简单的方式是 私聊：只需点击角色卡即可开始对话。","拥有多个角色卡后，您还可以使用“创建新聊天群组”按钮来创建包含多个角色的 群聊，这些角色将相互互动并与您交流。"]},{"l":"聊天记录导入","p":["将 Character.AI 的聊天记录导入至 SillyTavern。","要导入 Character.AI 的聊天记录和机器人，请使用 CAI Tools 浏览器扩展： https://github.com/irsat000/CAI-Tools。","其他支持导入聊天记录的程序和工具包括：","TavernAI (原版)： https://github.com/TavernAI/TavernAI","Text Generation WebUI (oobabooga)： https://github.com/oobabooga/text-generation-webui","Agnai： https://github.com/agnaistic/agnai","KoboldAI Lite： https://github.com/LostRuins/lite.koboldai.net","RisuAI： https://github.com/kwaroran/RisuAI"]},{"l":"导出为 .jsonl \uD83D\uDCE4","p":["点击“管理聊天文件”后，聊天文件列表中的每个条目都有一个按钮，可将其导出为能够原样重新导入的格式。使用此功能可分享或迁移包含所有元数据（但不包括图片和文件附件）的聊天记录。","如果您注重隐私，请务必检查导出的 JSONL 文件并清理任何不希望分享的内容。"]},{"l":"导出为 .txt \uD83D\uDCDD","p":["您也可以使用“下载聊天记录为纯文本文档”按钮导出简化的纯文本版本。该版本无法重新导入，因为它丢失了重要的元数据！"]},{"l":"检查点 ⚓","p":["“检查点”是当前聊天记录的克隆副本，它们会复制给定聊天记录截至某一时间点的所有消息，并存储指向源文件的链接（通过聊天文件名）。","在每个聊天消息右侧的三点按钮中，您有两种创建检查点的方式：","“创建分支”：将克隆当前聊天记录至该消息，并切换至该分支","“创建检查点”：将克隆当前聊天记录至该消息，要求输入名称并创建，但 不会 切换至该检查点","您可以将其大致理解为浏览器中的“在新标签页中打开链接”和“在后台新标签页中打开链接”。","您可以通过点击消息文本框左侧的汉堡菜单按钮，然后点击“返回父级聊天”，从检查点返回父级聊天。"]},{"l":"重命名聊天 ✏️","p":["默认情况下，聊天文件会以开始聊天的日期和时间命名。","您可以通过点击铅笔图标并输入新名称来更改它。","请注意，这将破坏从检查点指向该聊天的链接（因为它们是通过聊天文件名链接的）。"]}],[{"l":"\uD83D\uDCAC 群聊功能"},{"l":"\uD83E\uDD16 回复顺序策略","p":["决定群聊中角色回复的选定方式。"]},{"l":"✋ 手动","p":["您可以从菜单中选择或使用 /trigger 命令手动选择回复的角色。选定的群成员将是唯一回复者。用户消息不会自动触发任何回复。使用空用户输入触发生成时，将随机触发一位未静音的群成员进行回复。"]},{"l":"\uD83D\uDD04 自然顺序","p":["尝试模拟真实人类对话的流程。算法如下：","从上一条聊天消息中提取群成员名称的提及（Mentions）。","只有完整单词才会被识别为提及！如果您的角色名为“Misaka Mikoto”，他们只会对“Misaka”或“Mikoto”作出反应，而永远不会对“Misa”、“Railgun”等作出反应。","除非启用了“允许自我回复”设置，否则角色不会对自己消息中提及自己名称作出回复！","角色通过“健谈度”（Talkativeness）因素激活。","健谈度定义了角色在未被提及时主动发言的频率。请在角色编辑器的“高级定义”界面调整此值。滑块值为 0% / 害羞（除非被提及，否则从不发言）到 100% / 健谈（总是回复）的线性比例。新角色的默认值为50%的几率。","随机选择一名角色。","如果前几步均未激活任何角色，则将忽略所有其他条件，随机选择一名发言者。"]},{"l":"\uD83D\uDCDC 列表顺序","p":["角色根据其在群成员列表中的呈现顺序依次被选定回复。不适用其他规则。"]},{"l":"\uD83C\uDFB1 轮盘顺序","p":["激活一名自上次用户消息以来尚未发言的随机角色。如果所有角色都已发言，则随机选择一名，直到下一次用户消息。"]},{"l":"\uD83E\uDDE0 群生成处理模式","p":["此设置决定如何处理群聊成员的角色信息。无论选择何种模式，群聊历史记录始终在所有成员之间共享。"]},{"l":"\uD83D\uDD04 切换角色卡","p":["默认模式。每次生成消息时，上下文中仅包含当前活跃发言者的角色卡信息。"]},{"l":"\uD83E\uDDE9 合并角色卡","p":["将所有群成员的信息按其列表顺序合并到一个联合提示（joint prompt）中。这在需要避免大幅更改上下文的情况下（例如使用 llama.cpp 的提示缓存时）会有所帮助。","此模式有两种子模式（必须选择一种）：","包含静音成员- 静音角色将始终包含在联合提示中。","排除静音成员- 静音角色如果并非当前发言者，则不会被包含。","以下字段会被合并：","描述（Description）","场景（Scenario），如果未在聊天中覆盖","人格（Personality）","消息示例（Message examples）","角色笔记 / 深度提示（Character notes / Depth prompts）","请注意，由于典型角色卡的结构方式，使用此模式可能导致意外行为，包括但不限于：角色对自身感到困惑、人格融合、特质不确定等。"]},{"l":"\uD83E\uDDE9 合并前缀与后缀","p":["当选择“合并角色卡”时，所有相应字段将被合并在一起。这意味着在最终的提示中，所有角色描述将合并成一大段文本。如果您希望这些字段是分开的，可以定义前缀（prefix）和/或后缀（suffix）。","这些选项支持普通宏（macros），并且会将 `` 替换为相关角色的名称，将 FIELDNAME 替换为部分的名称（例如：description, personality, scenario 等）。"]},{"l":"⚙️ 其他群聊菜单选项"},{"l":"\uD83D\uDD07 静音角色","p":["群聊菜单中角色头像旁划有斜线的语音气泡图标可禁用或启用特定角色在聊天中的回复。"]},{"l":"\uD83D\uDDE3️ 强制发言","p":["群聊菜单中角色头像旁的语音气泡图标将触发特定角色的回复，绕过回复顺序策略。即使该群成员被静音，此功能也会生效。"]},{"l":"\uD83E\uDD16 自动模式","p":["启用自动模式后，群聊将遵循回复顺序并在无需用户交互的情况下触发消息生成。在上一位选定的角色发送其消息后，经过 5 秒延迟会触发下一个自动模式回合。当用户开始在发送消息文本区域中输入时，自动模式将被禁用，但已排队的生成不会自动停止。"]},{"l":"\uD83D\uDD01 允许自我回复","p":["当选择“自然顺序”时，如果角色因被自我提及而触发，将允许其在每回合中连续回复（即上一条消息的发送者可以再次回复）。对列表顺序无效。"]},{"l":"\uD83D\uDCDD 群聊场景覆盖","p":["所有群成员将使用此处输入的场景文本，而非其角色卡中指定的场景。分支聊天从其父级继承场景覆盖设置，之后可以单独更改。"]},{"l":"\uD83D\uDC40 查看角色定义","p":["点击群聊菜单中头像旁的角色卡图标可快速导航至通常的角色定义界面。在此处进行的任何更改都将保存至角色卡本身。","要返回群聊，请点击群组名称标题链接。"]},{"l":"\uD83D\uDC65 成员管理","p":["您现有的任何角色都可以在群聊中添加、移除、静音或重新排序。默认情况下，新成员会添加到群成员列表的顶部，之后可以使用箭头图标重新排序。"]},{"l":"\uD83E\uDE9F 群聊菜单弹出窗口","p":["点击“当前成员”字段旁的图标可激活群聊菜单弹出窗口。启用用户设置中的 MovingUI 后，可以调整此菜单的大小并将其拖动到界面内的任何位置，其功能与常规群聊菜单完全相同。"]}],[{"l":"\uD83C\uDFF7️ 标签管理","p":["角色卡和群组可以被分配零个或多个标签。它们可用于按主题、质量、来源或任何您喜欢的标准来快速整理日益增长的收藏。"]},{"l":"\uD83D\uDD8D️ 添加标签","p":["有几种方法可以为角色卡添加或移除标签：","在导入过程中嵌入标签。","从角色管理面板打开一张角色卡。在那里您可以为角色卡分配标签。","批量添加标签。","要进行批量添加标签，请点击“批量编辑角色”按钮（铅笔图标），选择要标记的角色卡，右键单击其中任意一张，然后在上下文菜单中点击“添加标签”。","请注意，群组无法进行批量添加标签。","在此界面，您可以：","使用组合框添加或移除标签。","移除所选角色卡上的所有标签（“全部”）。","从所选角色卡中移除所有卡共有的标签（“共有”）。","导入（在本地创建）角色卡中存储的所有标签，以防您已导入该卡（“导入全部”）。","导入（在本地创建）角色卡中存储的、且本地已存在同名标签（“导入现有”）。"]},{"l":"\uD83D\uDDC2️ 管理标签","p":["要查看和管理所有现有标签，请打开角色管理面板，然后点击“管理标签”按钮（齿轮图标）。","您可以使用右上角的按钮备份和恢复此处的所有信息（标签列表、标签分配给卡的情况、颜色、文件夹设置等）。","您可以使用左侧的抓取按钮（grip buttons）重新排序标签，它们将按此顺序显示在角色管理的标签筛选器中。","标签备份 JSON 文件不旨在与他人共享，因为它包含仅特定于您实例的信息，例如内部实体名称！"]},{"l":"\uD83D\uDCE5 导入角色卡时导入标签","p":["当从下载的图像（或通过“从外部 URL 导入内容”按钮）导入外部角色卡时，系统会提示您选择性地导入其包含的标签。这些标签并非角色卡运行所必需；它们仅用于组织目的。","嵌入的角色卡标签存储在角色编辑器“高级定义”菜单的“创作者元数据”部分。如果您希望向导入该角色的其他用户推荐一些标签，请在“要嵌入的标签”字段中填入一个逗号分隔的标签列表。","仅当用户设置中的“导入卡片标签”选项设置为“询问”时，此弹出窗口才会出现。","在打开的“为[角色名]导入标签”弹出窗口中，您将看到：","现有标签 列表（您本地已存在且名称匹配的标签）","新标签 列表（您本地尚未存在的标签）","您可以：","按需修剪列表，然后点击“导入”——剩余的 现有标签 将被添加到导入的角色卡中，剩余的 新标签 将在本地创建并添加到卡中。","或者直接点击“不导入”以忽略角色卡中包含的标签，仅导入角色卡本身。","或者点击“全部导入”作为快捷方式，导入在角色卡中找到的所有标签（注意：包括您从上述列表中修剪掉的任何标签；如果您修剪过，请使用“导入”按钮）。","或者点击“导入现有”作为快捷方式，仅导入本地已存在且名称匹配的标签。"]},{"l":"\uD83D\uDD0D 筛选角色卡","p":["创建标签后，您将在角色管理面板的一行中看到它们。您可以点击这些标签来切换标签筛选状态；依次为：","点击一次将显示带有此标签的卡片。","再次点击将仅显示未带此标签的卡片。","再次点击将重置按此标签的筛选。","您可以同时按任意数量的标签进行筛选。"]},{"l":"\uD83D\uDCC1 标签作为文件夹","p":["要使用此功能，必须首先在“用户设置”中的“UI 主题”列下启用它。此开关的状态也会随 UI 主题保存。","在“管理标签”按钮（齿轮图标）界面中，每个标签条目都有一个多状态切换按钮，用于在这些“标签即文件夹”模式（代码中称为“bogus folder”）之间循环：","点击一次可将此标签变为“打开文件夹”模式。它将作为虚拟条目出现在卡片列表中；点击进入该虚拟条目将仅显示带有该标签的卡片。","再点击一次可将此标签变为“关闭文件夹”模式。同上，但默认情况下不会显示带有此标签的卡片——您需要点击进入该文件夹才能看到它们。","再点击一次可重置此标签的“标签即文件夹”状态。"]}],[{"l":"\uD83D\uDCDD 作者注释"},{"l":"✨ 它是什么？","p":["作者注释是一个强大的工具，用于定制 AI 的回复。它可以将一段文本按您期望的任何频率插入到提示（Prompt）中的任何位置。"]},{"l":"\uD83D\uDDB1️ 如何使用","p":["作者注释功能位于聊天输入栏左侧的“选项”（Options）菜单中。","选项菜单","作者注释面板"]},{"l":"⚙️ 配置作者注释"},{"l":"\uD83D\uDCAC 特定聊天的作者注释","p":["作者注释面板顶部的输入框包含您当前聊天的作者注释。","此框中的内容不会自动转移到任何新聊天中。"]},{"l":"\uD83D\uDCCD 插入位置"},{"l":"场景之后 (After Scenario)","p":["此选项将作者注释放在上下文（Context）中较靠前的位置，紧接在角色定义的“场景”（Scenario）部分之后。如果未指定场景，则会放在角色定义最后一部分之后、示例消息（Example messages）之前。"]},{"l":"插入聊天历史 (In-chat)","p":["此选项将作者注释插入到聊天历史中指定的深度（Depth）。","深度 0 = 放置在聊天历史的最末尾。","深度 4 = 放置在最近 3 条聊天历史消息之前，使其成为聊天历史中的第 4 个实体。","作者注释在提示中的位置越靠后，对 AI 下一次回复的影响就越大。"]},{"l":"\uD83D\uDD01 插入频率","p":["这决定了您希望作者注释被包含在聊天中的频率。","频率 0 = 作者注释永远不会被插入。","频率 1 = 每次处理用户输入提示时都会插入作者注释。","频率 4 = 每处理第 4 次用户输入提示时插入一次作者注释。"]},{"l":"⚙️ 默认作者注释","p":["面板底部的输入框包含的是 默认作者注释，它将被应用到每一个新创建的聊天中。"]},{"l":"\uD83C\uDFAF 常见用例"},{"l":"\uD83E\uDD16 提醒 AI 回复格式","p":["作者注释可用于指定 AI 应如何撰写其回复。","[你的下一次回复必须长达 300 个词元 (tokens)。]","[以埃德加·爱伦·坡的风格撰写你的下一次回复。]","[使用 Markdown 斜体表示未说出口的动作，使用引号指定说出口的言语。]"]},{"l":"\uD83E\uDDE0 强化指令","p":["[记住你在本次聊天开始时收到的指令。]"]},{"l":"\uD83C\uDF0D 作为临时世界信息、角色偏向或对非指令模型的指令","p":["[ 在图书馆里。]","[ 腿部有新伤，因此无法逃跑。]","[ 不能说话，必须用手势交流。]"]}],[{"l":"\uD83D\uDDC3️ 资料库 (RAG)","p":["检索增强生成（RAG）是一项为大型语言模型（LLM）提供外部知识源的技术。它通过访问模型训练数据之外的信息，有助于提高AI回答的准确性。","SillyTavern 提供了一套工具，可从多种来源构建多用途知识库，并在LLM提示中使用收集到的数据。"]},{"l":"\uD83D\uDD0D 访问资料库","p":["内置的聊天附件扩展（在 ≥1.12.0 的发布版本中默认包含）在“魔法棒”菜单中添加了一个新选项——资料库(Data Bank)。这是您管理SillyTavern中可用于RAG的文档的中心枢纽。"]},{"l":"\uD83D\uDCC4 关于文档","p":["资料库存储文件附件，也称为文档。这些文档按可用范围分为三种：","全局附件- 在每个聊天（单人或多人群聊）中都可用。","角色附件- 仅对当前选定的角色可用，包括其在群聊中回复时。 附件保存在本地，不会随角色卡导出！","聊天附件- 仅在当前打开的聊天中可用。聊天中的每个角色都可以从中获取信息。","虽然形式上不属于资料库的一部分，但您甚至可以将文件附加到单个消息上。使用“魔法棒”菜单中的“附加文件”选项，或消息操作行中的回形针图标。","什么可以作为文档？实际上任何可以表示为纯文本形式的内容都可以！","包括但不限于：","\uD83D\uDCC1 本地文件（书籍、科学论文等）","\uD83C\uDF10 网页（维基百科、文章、新闻）","\uD83D\uDCFA 视频转录稿","各种扩展和插件也可以提供收集和处理数据的新方法，下文将详细介绍。"]},{"l":"\uD83D\uDCE5 数据源","p":["要向任何范围添加文档，请单击“添加”并选择可用的来源之一。"]},{"l":"\uD83D\uDCDD 记事本","p":["从头创建文本文件，或编辑现有附件。"]},{"l":"\uD83D\uDCC2 文件","p":["从计算机硬盘上传文件。SillyTavern 为流行文件格式提供了内置转换器：","PDF（仅文本）","HTML","Markdown","ePUB","TXT","您还可以附加任何具有非标准扩展名的文本文件，例如 JSON、YAML、源代码等。如果所选文件类型没有已知的转换方式，并且文件无法作为纯文本文档解析，则文件上传将被拒绝，这意味着不允许原始二进制文件。","导入 Microsoft Office (DOCX, PPTX, XLSX) 和 LibreOffice 文档 (ODT, ODP, ODS) 需要安装并加载 服务器插件。安装说明请参见插件的 README 页面。"]},{"l":"\uD83C\uDF10 网页","p":["通过 URL 抓取网页文本。HTML 文档随后通过 Readability 库处理，仅提取可用的文本。","某些 Web 服务器可能会拒绝获取请求、受到 Cloudflare 保护或严重依赖 JavaScript 才能运行。如果您遇到任何特定网站的问题，请通过 Web 浏览器手动下载页面，然后使用文件上传器附加它。"]},{"l":"▶️ YouTube","p":["通过视频 ID 或 URL 下载 YouTube 视频的转录稿，可以是创作者上传的，也可以是 Google 自动生成的。某些视频可能禁用了转录稿，并且年龄限制视频的解析不可用，因为这需要登录。","脚本以视频的默认语言加载。或者，您可以指定双字母语言代码以尝试获取特定语言的转录稿。此功能并非始终可用且可能失败，请谨慎使用。"]},{"l":"\uD83D\uDD0D 网络搜索","p":["此数据源要求安装并正确配置 网络搜索 扩展。详情请参见链接页面。","执行网络搜索并下载搜索结果页面的文本。这与 Web 源类似，但完全是自动化的。选择的搜索引擎将从扩展设置继承，因此请提前设置。","首先，指定搜索查询、要访问的最大链接数以及输出类型：一个合并文件（根据扩展规则格式化）或每个页面的单独文件。您也可以选择保存页面摘要片段。"]},{"l":"\uD83C\uDFF0 Fandom","p":["此数据源要求安装并加载 服务器插件。安装说明请参见插件的 README 页面。","通过 ID 或 URL 从 Fandom wiki 抓取文章。由于某些 wiki 非常大，使用过滤器正则表达式限制范围可能有益，它将针对文章标题进行测试。如果未提供过滤器，则所有页面都将被导出。您可以将它们保存为每个页面的单独文件，或者合并到一个文档中。"]},{"l":"\uD83E\uDD84 Bronie 解析器扩展（第三方）","p":["此数据源来自第三方， 与 SillyTavern 团队无关。此数据源要求您安装 Bronya Rand 的 Bronie 解析器扩展 以及需要该解析器才能工作的服务器插件。","Bronya Rand 的 Bronie 解析器扩展允许在 SillyTavern 中使用第三方抓取工具，例如 miHoYo/HoYoverse 的 HoYoLab，类似于其他数据源。","目前，Bronya Rand 的 Bronie 解析器扩展支持以下内容：","miHoYo/HoYoverse 的 HoYoLab（用于《原神》/《崩坏：星穹铁道》），通过 HoYoWiki-Scraper-TS","首先，按照其 安装指南 安装 Bronya Rand 的 Bronie 解析器扩展，并将受支持的服务器插件安装到 SillyTavern 中。重新启动 SillyTavern 并转到_资料库_菜单。单击 + 添加，您应该看到最近安装的抓取工具已添加到可能的信息来源列表中。"]},{"l":"\uD83E\uDDEE 向量存储","p":["好了，您已经为自己构建了一个关于特定主题的完善且全面的信息库。接下来呢？","要将文档用于 RAG，您需要使用兼容的扩展，将相关数据插入到 LLM 提示中。","SillyTavern 捆绑的 Vector Storage（向量存储）就是此类扩展的一个参考实现。它使用嵌入（也称为向量）来搜索与您正在进行的聊天相关的文档。","嵌入是由专门的语言模型生成的、抽象表示一段文本的数字数组。更相似的文本其各自向量之间的距离更短。","向量存储扩展使用 Vectra 库来跟踪文件嵌入。它们存储在用户数据目录的 /vectors 文件夹中的 JSON 文件里。每个文档在内部由其自己的索引/集合文件表示。","由于向量功能默认是禁用的，您需要打开扩展面板（顶部工具栏上的“堆叠立方体”图标），然后导航到“Vector Storage”部分，并在“文件向量化设置”下勾选“Enabled for files”复选框。","向量存储本身并不生成向量，您需要使用兼容的嵌入提供程序。"]},{"l":"\uD83D\uDD0C 向量提供程序","p":["只有当使用生成它们时相同的模型来检索时，嵌入才可用。更改嵌入模型或源时，需要重新计算向量。"]},{"l":"\uD83D\uDCBB 本地 (Local)","p":["这些来源是免费且无限制的，使用您的 CPU/GPU 来计算嵌入。","本地 (Transformers)- 在 Node 服务器上运行。SillyTavern 将自动从 HuggingFace 下载 ONNX 格式的兼容模型。默认模型： jina-embeddings-v2-base-en。","WebLLM- 需要安装扩展且 Web 浏览器 支持 WebGPU。直接在浏览器中运行，可以使用硬件加速。自动从 HuggingFace 下载支持的模型。从此处安装扩展： https://github.com/SillyTavern/Extension-WebLLM。","Ollama- 从 https://ollama.com/ 获取。在 API 连接菜单中设置 API URL（在文本补全下，默认值： http://localhost:11434）。必须先下载兼容模型，然后在扩展设置中设置其名称。示例模型： mxbai-embed-large。可选地，勾选一个选项以将模型保持在内存中加载。","llama.cpp server- 从 ggerganov/llama.cpp 获取并使用 --embedding 标志运行服务器可执行文件。从 HuggingFace 加载兼容的 GGUF 嵌入模型，例如 nomic-ai/nomic-embed-text-v1.5-GGUF。","vLLM- 从 vllm-project/vllm 获取。首先在 API 连接菜单中设置 API URL 和 API 密钥。","Extras (已弃用)- 使用 SentenceTransformers 加载器在 Extras API 下运行。默认模型： all-mpnet-base-v2。此来源不再维护，最终将在未来移除。"]},{"l":"\uD83C\uDF10 API 来源","p":["所有这些来源都需要相应服务的 API 密钥，并且通常有使用成本，但通常计算嵌入相当便宜。","OpenAI","Cohere","Google AI Studio","Google Vertex AI","TogetherAI","MistralAI","NomicAI"]},{"l":"⚙️ 向量化设置","p":["选择嵌入提供程序后，不要忘记配置其他设置，这些设置将定义处理和检索文档的规则。","附件的拆分、向量化和信息检索需要一些时间。虽然文件的初始摄取可能需要一段时间，但 RAG 搜索查询通常足够快，不会产生明显的延迟。"]},{"l":"\uD83D\uDCAC 消息附件","p":["这些设置控制直接附加到消息的文件。","适用以下规则：","只有适合 LLM 上下文窗口的消息才能检索其附件。","当向量存储扩展被禁用时，文件附件及其附随的消息会完全插入到提示中。","当文件向量化启用时，文件将被拆分成块，并且只插入最相关的部分，从而节省上下文空间并使模型保持专注。","大小阈值 (KB)- 设置分块拆分阈值。只有大于指定大小的文件才会被拆分。","块大小 (字符数)- 设置单个块的目标大小（以文本字符计，非模型令牌！）。","块重叠 (%)- 设置相邻块之间共享的块大小百分比。这允许块之间更平滑地过渡，但也可能引入一些冗余。","检索块数- 设置要检索的最相关文件块的最大数量。它们将按原始顺序插入。"]},{"l":"\uD83D\uDDC3️ 资料库文件","p":["这些设置控制资料库文档的处理方式。","适用以下规则：","当文件向量化禁用时，不使用资料库。","否则，当前范围（见上文）的所有可用文档都会被考虑用于查询。只检索所有文件中最相关的块。同一文件的多个块按原始顺序插入。","插入的块将在适配聊天消息之前保留一部分上下文。","大小阈值 (KB)- 设置分块拆分阈值。只有大于指定大小的文件才会被拆分。","块大小 (字符数)- 设置单个块的目标大小（以文本字符计，非模型令牌！）。","块重叠 (%)- 设置相邻块之间共享的块大小百分比。这允许块之间更平滑地过渡，但也可能引入一些冗余。","检索块数- 设置要检索的文件块的最大数量。此限额在所有文件之间共享。","注入模板- 定义检索到的信息将如何插入到提示中。您可以使用特殊的 `` 宏来指定检索文本的位置，以及任何其他宏。","注入位置- 设置提示注入的位置。与作者注和世界信息相同的规则适用。"]},{"l":"\uD83E\uDD1D 共享设置","p":["查询消息数- 将使用多少条最新的聊天消息来查询文档块。","分数阈值- 调整以允许根据相关性分数（0 - 完全不匹配，1 - 完全匹配）筛选检索到的块。较高的值允许更准确的检索，并防止完全随机的信息进入上下文。合理的值范围在 0.2（更宽松）和 0.5（更专注）之间。","块边界- 一个自定义字符串，在将文件拆分成块时将优先考虑。如果未指定，默认是按（按顺序）双换行符、单换行符和单词之间的空格进行拆分。","仅在自定义边界分块- 如果启用，分块将仅发生在指定的块边界上。否则，分块也会发生在默认边界上。","处理前将文件翻译成英文- 如果启用，将使用 聊天翻译 扩展中配置的翻译 API 在处理前将文件翻译成英文。当使用仅支持英文文本的嵌入模型时，这非常有用。","包含在世界信息扫描中- 检查是否希望注入的内容激活 lore book 条目。","向量化全部- 强制摄取所有未处理文件的嵌入。","清除向量- 清除文件嵌入，允许重新计算其向量。","有关“聊天向量化”设置，请参见 聊天向量化。"]},{"l":"\uD83C\uDF89 结语","p":["恭喜！您的聊天体验现在因 RAG 的力量而增强。其能力仅受您的想象力限制。一如既往，不要害怕尝试！"]}],[{"l":"\uD83C\uDFAF 欢迎页面助手","p":["SillyTavern 设有欢迎屏幕功能，可通过指定的\"助手\"角色向您致意。当您启动 SillyTavern 时若无活跃聊天，或在关闭最后一个聊天会话后，此屏幕便会显现。","若应用启动时未显示欢迎屏幕，请确保在 用户设置 面板的\"聊天/消息处理\"章节中，\"自动加载上次聊天\"选项处于禁用状态。启用此选项后，SillyTavern 将自动加载您上次的聊天而非显示欢迎屏幕。"]},{"l":"\uD83D\uDDA5️ 欢迎屏幕","p":["当无活跃聊天时，欢迎屏幕提供多项实用元素：","SillyTavern 版本： 显示应用logo及当前版本号。","\uD83D\uDD17 快捷链接： 轻松访问：","文档： 打开官方 SillyTavern 文档（您正在此处查阅！）。","GitHub： 带您前往 SillyTavern GitHub 代码库 ( https://github.com/SillyTavern/SillyTavern)。","Discord： 提供官方 SillyTavern Discord 服务器链接 ( https://discord.gg/sillytavern)。","\uD83D\uDCAC 临时聊天按钮： 允许您快速与默认的中立助手开启一个新的临时聊天会话，此会话不会被保存至聊天历史记录，除非您明确保存它。","\uD83D\uDCC3 最近聊天区： 列出您最近的对话以供快速访问。您可以：","显示或隐藏此区域。","若有超过 3 个聊天可用（最多 15 个最近聊天），可展开列表。"]},{"l":"\uD83D\uDCAC 临时聊天","p":["由于技术限制，临时聊天功能 不会 使用您自定义的欢迎页面助手。它将始终启动一个不包含任何额外提示词或角色信息的空聊天。","“临时聊天”按钮允许您快速开始一个新的聊天会话，而不会将其保存到聊天历史记录中。这对于测试或临时对话非常有用，避免了已保存聊天记录的混乱。此聊天将在您关闭它或切换到另一个聊天时立即被删除。","保存 按钮允许您将临时聊天导出为 JSONL 文件，之后您可以再导入。","加载 按钮允许您恢复之前保存的临时聊天文件。"]},{"l":"\uD83E\uDD14 何为欢迎页面助手？","p":["欢迎页面助手是您选择在欢迎屏幕上展示的角色。这能实现个性化问候，并提供一种直接从开始界面与熟悉角色快速展开聊天的方式。"]},{"l":"⚙️ 设置与取消助手","p":["您可以选择任意角色作为您的欢迎页面助手。","设置助手：","导航至 角色管理 面板（通常通过右侧边栏的 图标找到）。","在列表中找到您希望设为助手的角色。","点击“更多...”(More...) 并从下拉菜单中选择 “设为/取消设为欢迎页面助手”(Set / Unset as Welcome Page Assistant)。","一个小的 图标将出现在角色名称旁，表明其现在是您的活跃欢迎页面助手。","取消设置助手：","前往角色管理面板。","找到您当前的欢迎页面助手（其旁会有 图标）。","点击“更多...”(More...) 并再次选择 “设为/取消设为欢迎页面助手”(Set / Unset as Welcome Page Assistant)。","该角色将不再是您的助手，且 图标会消失。","SillyTavern 将恢复使用默认助手（见下文）。"]},{"l":"\uD83D\uDCAC 与助手互动","p":["一旦欢迎屏幕显示出您选择的助手，只需在屏幕底部的聊天输入栏中输入您的消息并按 Enter 或点击发送按钮即可。这将开启一个与您欢迎页面助手的新聊天会话。","要打开之前与该助手的聊天，请使用“最近聊天”区域，或在 管理聊天文件 对话框（通过 选项 菜单访问）中找到该聊天。"]},{"l":"⚙️ 默认助手","p":["当您首次与欢迎屏幕互动时，SillyTavern 会自动创建一个名为“Assistant”（助手）的默认角色。此角色作为后备选项，以防您未设置特定角色为欢迎页面助手。","该默认助手没有任何特定的提示词附加，您可以随意自定义它（例如重命名、添加图片或设置个性）。","若您未明确设置某个角色为欢迎页面助手，则将使用此默认助手。","若您取消了已选择的助手，系统将恢复使用此默认助手。","若您设置为助手的角色被删除，系统同样将恢复使用默认助手。","注意： 您无法以取消您所选角色的相同方式去“取消设置”这个默认的系统助手。要更改默认助手，您必须将您的另一个角色设置为助手。"]}],[{"l":"Extensions","p":["SillyTavern comes with many extensions that can be enabled or disabled in the Extensions panel. Extensions can add new features, change the behaviour of existing features, or provide additional content for your AI to use. More extensions can be installed from the \"Download Extensions & Assets\" menu in the Extensions panel."]},{"l":"Extensions panel","p":["To open or close the Extensions panel, choose Extensions in the top bar.","Manage extensions: Activate, deactivate, and update extensions","Download Extensions & Assets: Install more extensions, characters, sounds, and backgrounds from the SillyTavern repository","Notify on extension updates: Check to be notified when there are updates available for installed extensions","Install extension: Import a third-party extension from a Git repository URL"]},{"l":"Built-in extensions","p":["Auto-summary of the chat history","Chat Translation","Chat Vectorization","Converts text into tokens and counts the number of tokens","Expression Images","Finds relevant messages from chat history and adds them into the context","Generates text from images so your AI can \"see\" and respond to visual content in your conversations","Image Captioning","Image Generation","Images (aka 'sprites') of your AI character, shown next to or behind the chat window","Quick Reply","Reply to chat messages with a single click, run commands and STscripts, and more","Summarize","Text To Speech","These extensions are built into SillyTavern and do not need to be installed. They can be enabled or disabled in the Extensions panel.","Token Counter","Translate chat messages to a different language","Use local or cloud-based Stable Diffusion, FLUX or DALL-E APIs to generate images","Voice narration for your chat messages via ElevenLabs, Silero, your system TTS, AllTalk, XTTS, and more"]},{"l":"Installable extensions","p":["A set of 7 classic D&D dice for all your dice rolling needs.","AccuWeather","Adds \"idle prompting\" after the user has been idle for some time to organically continue the conversation.","Adds a button to quickly insert a /sendas command template for the selected group member.","Adds a button to quickly insert emojis into a chat message.","Adds a dropdown menu for selecting user personas from the chat bar.","Adds a place to store your notes. Supports rich text formatting.","Adds a silence audio player to the extensions menu. Can help if the browser tab is being killed in a background.","Adds a timeline navigation to the chat history.","Adds a top bar to the chat window with shortcuts to quick actions.","Adds ability to randomize API settings sliders with every generation.","Adds an ability to cluster characters by similarity groups to easily find duplicates.","Adds an option to inspect and edit output prompts before sending them to the server.","Adds immersive background music and ambient sounds to your chats.","Adds Mermaid diagrams & flowcharts rendering to SillyTavern chats.","Adds Realtime Voice Cloning capabilities to the Text-to-Speech module.","Adds support for live2d models. Customizable expressions, animations and interactions.","Adds support for VRM models. Customizable expressions, animations and interactions.","Adds web search results to LLM prompts.","Allows running JavaScript and STscript code from code blocks in chat.","Allows setting alternate greetings that are specific to group chats.","Allows to receive push notifications for incoming chat messages.","Animate the text of character messages with variable speed and play sound along the animation.","Blip","Chat Top Bar","Chess","Code Runner","Convert your speech to text using browser or extras.","D&D Dice","Duplicate Finder","Dynamic Audio","Easy way to view and modify variables.","Emoji Picker","EmulatorJS","Enhances the current visual novel experience with more features (Focus Mode, Letterbox Mode, and more)!","Gets the latest news from RSS feeds as a slash command or a function tool.","Group Greetings","Group SendAs","HypeBot","Idle","Image Metadata Viewer","LaTeX","Live2d","Mermaid","Notebook","Objective","Parameter Randomizer","Play retro console games directly in SillyTavern chats.","Play the game of chess with the LLM.","Prome Visual Novel Extension","Prompt Inspector","Provides an interface for extensions to use language models directly in the browser.","Provides the screen image for multimodal models when you send a message.","Provides weather information using the AccuWeather API as a slash command or a function tool.","Push Notifications","Quick Persona","Render LaTeX and AsciiMath formulas in chat messages.","RSS","RVC","Screen Share","Set an Objective for the AI to aim for during the chat.","Show personalized suggestions based on your recent chats using the NovelAI's HypeBot engine. Requires an active NovelAI subscription.","Silence Player","Speech Recognition","The Extras project was discontinued in April 2024. You do not need to install Extras to use extensions.","Timelines","Variable Viewer","View metadata of enlarged images attached to a chat.","VRM","Web Search","WebLLM","You can browse a list of all available extensions directly from the app by going to the Extensions=> Download Extensions & Assets menu and clicking the Load Asset List button. To install an extension, click the Download button. To read more about an extension, click the Link button next to its name to open its GitHub page.","You must have git installed to download extensions. Follow the instructions on the Git installation page if you don't have it installed."]},{"l":"Third-party extensions","p":["Using third-party extensions can have unintended side effects and may pose security risks. Always make sure you trust the source before importing an extension via Install extension. We are not responsible for any damage caused by third-party extensions.","To install a third-party extension, go to the Extensions=> Install Extension menu and paste the URL of the extension repository. Optionally, specify the branch and (in multi-user scenarios) the installation target: all users or just the current user. The extension will be downloaded and loaded automatically."]}],[{"l":"Blip","p":["This guide will walk you through setting up and customizing blip extension for your SillyTavern experience. This extension animate the text of messages with variable speed and play sound along the animation. You can use audio file or generate the sound."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Make sure you're on the latest version of SillyTavern.","Install the \"Blip\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon)."]},{"l":"Blip global settings","p":["Blip user message:","Enable checkbox to play animation on user message.","Set a profile for the user or a default profile if you want blip animation for user.","Blip only for certain text:","Enable checkbox to only blip for text inside quotes.","Enable checkbox to ignore everything inside asterisks.","Automatic scroll down:","Enable checkbox to make the chat go down to follow the text animation, disable it if you wanna scroll freely during animation.","Audio volume","Mute the audio if just the animation of the text is desired.","You can adjust the global volume of blip audio."]},{"l":"Character animation/voice profile","p":["Any profile can be deleted using the remove button.","Audio parameters:","Blip origin: file:","Blip origin: Generated sound:","Choose a file in the list.","Enable the checkbox to force to wait entire file is played before playing again if needed.","If it does not have a profile yet the current parameters will become his profile settings.","If min/max are different a random sound in this range is played each time.","If only the current chat characters are shown in the list, click the checkbox to show all your characters.","including the user and an optional default profile that will be used when character have no profile.","Or put file directly into: \\SillyTavern\\data\\user-handle\\assets\\blip.","Select a character, if he have a profile it will be loaded.","Select the character to assign/update profile:","Set a volume multiplier that will only affect this voice profile if needed.","Set audio speed: the delay between each blip sound, independant of text speed.","Set comma/phrase delay superior to 0 to add a pause when special character are printed, can add more liveliness to animation. Audio is paused too in this case.","Set Min/max speed multiplier different to 1.0 for randomness of speed animation.","Set the text speed: the delay in milliseconds between each letter printed.","Text animation settings:","Thank you for following this guide! Your SillyTavern experience is now enriched with text animation and blip voices.","Use refresh button if your character does not appear in the list.","Use the min/max frequency slider to customize the blip sound played.","You can get official ST blip assets from the assets extension menu.","You can save a profile for each character:"]}],[{"l":"Character Expressions"},{"l":"What is it?","p":["Expression images are images (aka 'sprites') of your AI character which are shown next to (or behind) the chat window.","Expression images can automatically change based on a classification, adjusting to the sentiment expressed in the AI's most recent chat response."]},{"l":"Adding Character Expression Images","p":["Open the Extensions Panel and expand the 'Character Expressions' section. If you have the character chat open, you will see a grid of image placeholders. Expression Drawer","Click the 'Upload image' button at the top left of each image in the grid, and select the image you want to apply to that emotion. This will save the image with the correct filename inside the /data/user-handle/characters/(character_name_here)/ folder.","Repeat this for all expressions you want to assign an image to."]},{"l":"Importing an Expression images ZIP file","p":["Using the ' Upload sprite pack (ZIP)' button, you can import a zip file that contains a collection of expression images, and those images will automatically be added to the correct folder for your currently selected character. The ZIP file must contain all images in a flat structure (no subfolders) and correctly named files. Importing a zip will not automatically rename any images to make them match the emotions."]},{"l":"Change Expressions Manually","p":["Click on any of the uploaded expression images (sprites) to display them near the chat interface (with default UI mode) or at the center of the screen (in Visual Novel mode).","Use the /expression-set (name) slash command or matching Quick Reply to set the sprite without opening the extensions menu."]},{"l":"Change Expressions Automatically","p":["To automatically set expressions when the character replies, you have multiple options. Expressions change per message or at regular intervals when message streaming is enabled."]},{"l":"How does the classify module work?","p":["The classify module uses a small 'sentiment parsing' model that runs alongside the SillyTavern server. This model takes the new output from the AI and detects what kind of sentiment, or emotion, the text is expressing. While multiple sentiments may be expressed in a single message, the model only picks the most likely one and returns that to the SillyTavern. The frontend extension then displays the image that is associated with that sentiment."]},{"l":"Setup Instructions (Local)","p":["Open the extensions panel and expand the \"Character Expressions\" extension menu.","Select \"Local\" in the classification source dropdown.","This will start a one-time download of the classification model from HuggingFace Hub (about ~ 100 Mb).","Generate any message to verify that the classification works and the sprite appears. You may also check the server console for debug logs.","Local classification defaults to 28 possible image labels: Cohee/distilbert-base-uncased-go-emotions-onnx","To use the 6-option classification model, change the value of extensions.models.classification variable in the config.yaml file to: Cohee/bert-base-uncased-emotion-onnx"]},{"l":"Setup Instructions (with LLM)","p":["Connect to any of the supported and properly configured APIs via API Connections.","Import the expression images the same way as mentioned above.","Select \"Main API\" in the classification source dropdown.","Optionally, configure the classification instruction prompt.","Generate any message to verify that the classification works and the sprite appears. You may also check the server console for debug logs."]},{"l":"Prompt Building Strategies","p":["Main LLM source allows to choose how the classification prompt will be built:","Limited Context: Only the last message and a system instruction prompt are sent.","Full Context: The entire chat history, including the character card are sent."]},{"l":"Setup Instructions (WebLLM)","p":["Install the official WebLLM extension.","Import the expression images the same way as mentioned above.","Select \"WebLLM\" in the classification source dropdown.","Optionally, configure the classification instruction prompt.","Generate any message to verify that the classification works and the sprite appears. You may also check the server console for debug logs."]},{"l":"Setup Instructions (with Extras)","p":["Extras is deprecated and may be removed in future updates.","Have Extras installed and running with the classify module enabled: python server.py --enable-modules=classify","Import the expression images the same way as mentioned above.","Select \"Extras\" in the classification source dropdown.","The appropriate expression image will display automatically whenever the AI sends you a response.","Extras API uses a classification model with 6 options by default: nateraw/bert-base-uncased-emotion","There is also a model with 28 options: joeddav/distilbert-base-uncased-go-emotions-student","To use this model you need to change your Extras command line to include the following argument (with a space before and after): --classification-model=joeddav/distilbert-base-uncased-go-emotions-student"]},{"l":"Custom Expressions","p":["How to get more expression options than provided by default? You can set up Custom Expressions in the extension settings. You can assign any name to Custom Expressions. They will appear in the expression image list and can be assigned images like other expressions. They will have an indicator showing that those are custom.","Both Local and Extras only support a limited list of expressions.","If you want Custom Expressions to be displayed, you either need to train a classification model with supported labels (outside the scope of this guide), or you can use LLM or WebLLM as classification source, which both will automatically use all existing expressions - both the default and any custom ones."]},{"l":"What image formats are supported for Expressions?","p":["Any image format is allowed, including webp and animated gifs.","The most common format is a PNG file with a transparent background."]},{"l":"Using Default Expressions","p":["If you don't have expression images for all expressions of a character, or no images at all, there are multiple options on what to display by default. All of those can be selected via the dropdown under 'Default / Fallback Expression'.","Choose a Fallback Expression: If an expression gets chosen where you don't have an image for, the fallback expression gets shown instead. Simply select one of the available expressions from the dropdown.","[No Fallback]: When no image exists, show nothing.","[Default emojis]: You can use the built-in default expressions which are included with in SillyTavern. These are simple emoji-style images."]},{"l":"Using Multiple Images per Expression","p":["It is possible to add multiple images per expression to allow for more variety in displayed expressions. To enable this, simply toggle Allow multiple sprites per expression. You can now upload more than one image, and any additional images will be displayed with a small marker.","Individual images can be manually chosen by selecting them with a click, or via /expression-set type=sprite, which will list available sprite images, instead of expressions.","Whenever an expression with multiple images gets automatically chosen, one of the existing images will be selected at random. If you want to force a new image of that expression to be chosen when the same expression gets used multiple times, you can enable Re-roll if same sprite is used again."]},{"l":"Naming Convention for Multiple Images per Expression","p":["In case of multiple images per expressions, files need to be named a specic way. The files need to start with the name of the expressions, and then followed by a suffix, either separated by a dot or a dash. Examples: joy.png, joy-1.png, joy.expressive.png File names must follow this format for both direct uploads and ZIP imports."]},{"l":"Sprite Folder Override","p":["Display names (not character card filenames) dictate which image set is used","If you have more than one character with the same display name, they will both use the same set of expression images.","If you want a different image set to be used for each version of the same-named character, you can use the sprites folder override. Folder overrides can also be used to define different sprite sets (outfits, etc.) of the same character."]},{"l":"How to set an override","p":["Create a folder in the /data/user-handle/characters with any name and put images there, e.g. /data/user-handle/characters/Boris.","Open the chat with the character whose sprites you'd like to override.","Enter the name of the override folder into the \"Sprite Folder Override\" input and click \"Submit\".","The Sprites list will reload and the \"Sprite set\" indicator should show the override folder.","Alternatively, you can use the /costume slash command to achieve the same result: /costume Boris.","By prepending a backslash to the override folder name, it will resolve to a subfolder in the current character sprites folder, e.g. /costume \\tracksuit for the character named Boris will resolve to the /data/user-handle/characters/Boris/tracksuit folder."]}],[{"l":"Chat Translation"},{"l":"Overview","p":["The Chat Translation Extension enables real-time translation of chat messages between different languages using various translation providers. It supports both manual and automatic translation modes.","Character message translated from English to Chinese using 'Translate Message/翻譯訊息' message action button","Translate Chat, Translate Input","翻译聊天, 翻译输入","翻譯聊天內容, 翻譯輸入內容","채팅 번역하기, 입력 번역하기","Перевести чат, Перевести моё сообщение"]},{"l":"Usage","p":["All the ways to translate chat messages:","Translate Chat button in the Extensions menu","Translates the entire chat history at once","Translate Input button in the Extensions menu","Translates just the current input text","Useful before sending a message","Translate Message icon in the Message Actions toolbar of any message","Click to translate just that message","Click again to revert to original text","Auto-mode configuration in the Chat Translation drawer of the Extensions panel","Automatically translates user inputs, AI responses, or both","/translate slash command","Use /translate [target=language_code] text to translate text"]},{"l":"Configuration","p":["Configuration options are available in the Chat Translation drawer of the Extensions panel."]},{"l":"Provider","p":["Choose your preferred translation service","Click the API Key icon, if it appears, to enter an API key","Click the Custom URL icon, if it appears, to enter a custom API URL"]},{"l":"Target Language","p":["Select the language you want to write your messages in, or read AI responses in."]},{"l":"Auto-mode","p":["Configure automatic translation behavior.","None: No automatic translation","Translate responses: Automatically translates AI responses into the target language","Translate inputs: Automatically translates user inputs into English","Translate both: Translates both user inputs and AI responses"]},{"l":"Clear Translations","p":["The Clear Translations button removes all translations from messages in the current chat. The original messages are preserved."]},{"l":"Configuration Example: Chinese to English Chatting","p":["To set up a workflow where a Chinese-speaking user can chat in Chinese with an AI that operates in English:","Set Auto-mode to \"Translate both\"","Set Target Language to \"Chinese (Simplified)\" or \"Chinese (Traditional)\"","Choose a translation provider with good language auto-detection (e.g., Google or DeepL)","This setup will:","Translate user's Chinese input to English for the AI","Translate AI's English responses back to Chinese for the user","This setup relies on automatic language detection for input. For more precise control, future updates may include explicit source language selection."]},{"l":"Translation providers","p":["Alternative front-end for Google Translate, open source (AGPL-3.0), privacy-focused","Bing Translator","Cloud-based Local, custom URL Requires API key","DeepL","DeepLX","Features","Good for Russian and Eastern European languages","Google Translate","High-quality translations, especially for European languages","Libre Translate","Lingva Translate","Location","Microsoft's translation service, integrates with Azure services","OneRing Translator","Provider","Self-hosted (AGPL-3.0) alternative to proprietary translation services, with cloud-hosted Pro tier","Self-hosted DeepL proxy, open source (MIT), free but proxying DeepL Pro requires DeepL API key","Self-hosted front-end to Google Translate and other providers, privacy-focused, open source (AGPL-3.0)","Widely used, supports many languages, good accuracy","Yandex Translate"]},{"l":"DeepL-specific configuration","p":["Formality levels available for German, French, Italian, Spanish, Dutch, Japanese, and Russian","Configure via deepl.formality in config.yaml"]},{"l":"Slash Commands","p":["Use /translate command for quick translations. Syntax: /translate [target=language_code] text. If target language is not provided, the value from the extension settings will be used."]},{"l":"Basic usage","p":["Translate text to the current target language and show it in a popup:","Popup in Chinese (Simplified), '欢迎来到酒馆/Welcome to the Tavern'","Translate text to Spanish and add it to the chat:","User message in Spanish, 'Hola Mundo/Hello world'"]},{"l":"Testing, pipeline translation, localization","p":["Prompt the user for a message and a language, translate the message into that language, then re-translate it into the configured target language and show both translations in a popup. This example uses the /input and /buttons commands to gather user input:","This is useful for checking the quality of a translation into a language that you don't speak, before writing it somewhere important.","Popup, 'Welcome to the Tavern/欢迎来到酒馆/welcome to the pub', en, zh-CN, en Popup, 'My hovercraft is full of eels/我的氣墊船裡裝滿了鰻魚/My hovercraft is filled with eels', en, zh-TW, en","The UI controls are shown in the current locale, independent of the configured target language.","/input","/buttons","Input dialog, '发送测试消息/Send Test Message'","Buttons dialog, '语言/Language'","Popup, '我的氣墊船裡裝滿了鰻魚/My hovercraft is full of eels', zh-TW - en - zh-TW","Input language detection is relatively effective in the following examples:","Popup, '(My hovercraft is full of eels)/A légpárnás hajóm tele van angolnával/我的氣墊船裡裝滿了鰻魚', zh-TW - hu - zh-TW Popup, '我的氣墊船裡裝滿了鰻魚/Mi aerodeslizador está lleno de anguilas/My hovercraft is full of eels', zh-TW - es - en Popup, 'Il mio hovercraft è pieno di anguille/我的气垫船里装满了鳗鱼/My hovercraft is filled with eels', it - zh-CN - en"]},{"l":"Technical Notes","p":["UTF-8 encoding, special characters, and emojis are supported","Handles large messages by splitting into chunks when needed","Preserves formatting and embedded images in messages","Caches translations to avoid redundant API calls"]},{"l":"AI input language","p":["internal_language controls the language into which user messages are auto-translated before being sent to the AI. It is hardcoded to 'en' in the default settings and cannot be changed through the UI. Thus, the translation target language for messages to the AI is always English. Previous testing showed that AI performance was better when receiving English messages, but this may change as more LLMs are being trained on more varied language data. I suppose one could change internal_language in settings.json and find out."]},{"l":"Chinese variant handling","p":["The extension supports both Simplified and Traditional Chinese, but not all translation providers do. The UI presents these as 'Chinese (Simplified)' and 'Chinese (Traditional)' respectively, with language codes 'zh-CN' and 'zh-TW'. They are mapped to the following language codes for translation providers:","Libre Translate: 'zh-CN' to 'zh' and 'zh-TW' to 'zt'.","DeepL and DeepLX: both variants to 'ZH'.","Bing: 'zh-CN' to 'zh-Hans', 'zh-TW' as-is.","Other providers use 'zh-CN' and 'zh-TW' as provided."]},{"l":"Text length limits","p":["Some providers have character limits per request:","Yandex: 5000 characters","DeepLX: 1500 characters","Bing: 1000 characters","Google: 5000 characters","Longer texts are automatically split into chunks for translation."]}],[{"l":"Chat Vectorization","p":["The use of this extension does not guarantee a better chatting experience or improved memory of any sort. Only use if you understand all the implications of vector database utilization.","Chat vectorization searches for messages in your current chat history that seem relevant to your most recent messages. It temporarily shuffles the most relevant messages to the beginning or end of the chat history. This happens when the model's reply to your last message is generated.","The messages at the start and end of the chat history tend to have the greatest impact on the model's reply. Therefore, shuffling relevant messages to these locations can help the model focus on relevant information in its reply.","In particular, chat vectorization can find relevant messages that are too far back in the message history to fit into the request context. Shuffling these messages into context provides the model with information that it would not have otherwise.","Chat vectorization is a kind of retrieval-augmented generation (RAG). Retrieval-augmented generation increases the quality of responses generated by a model, by providing additional relevant information in the prompt.","Retrieval: the most recent messages are used to retrieve relevant past messages","Augmented: the model's context is augmented by inserting past messages in a useful way","Generation: the model is instructed to use the past messages when generating the response","A vector is a set of numbers that could represent the themes, content, style, or other characteristics of a piece of text.","Vectorization is calculating the vector that represents a piece of text. This is done by a vectorizing model. Just as text generation models make text from text, vectorizing models make vectors from text.","Vector search finds relevant results by comparing vectors rather than, say, keywords. If we calculate the vector for a search query, we can compare it to the stored vectors for a collection of pieces of text. This finds the texts in our collection that are most similar to the text in the search query. In the case of chat vectorization, the\"search query\" is the most recent 2 messages, and the \"texts in our collection\" are all the other messages in the chat."]},{"l":"Setting up","p":["Like any dynamic prompt source (World Info, Summarization, etc.), Chat Vectorization restructures the prompt prefix between the LLM calls, which can lead to frequent cache misses. When used with caching, vectorization is often counter-productive, as the modified prompts rarely hit the cache – effectively making caching useless. You have to choose one or the other, but not both.","To enable Chat vectorization, select \"Extensions\" > \"Vector Storage\" > \"Enabled for chat messages\".","Configure a vectorization source and vectorization model. Chat vectorization uses the same vector source as Data Bank, so you may have set this up already. The settings for the Vectorization Source and Vectorization Model are documented in Data Bank.","Chat vectorization uses the same vector storage as Data Bank, but this does not need to be set up or configured. There is also information about Vector Storage in Data Bank.","Chat vectorization does not use Data Bank to store the chat messages. The messages are stored in the chat."]},{"l":"Preparing chat messages for search (vector storage)","p":["So that chat messages can be searched, a vector is calculated for each message and stored.","Vectorizing occurs in the background, whenever you send or receive a message.","Each message is stored individually, so that it can be found and shuffled individually during generation.","Large messages are split into \"chunks\" so that the model can be given the most relevant part of a long message. The chunk size is 400 characters. You can change this with \"Chunk size (chars)\".","Messages are divided into chunks by finding a chunk boundary such as a paragraph break, line break, or space between words. This is so that the all the chunks make sense, as far as possible. If your chat messages have some other way to mark natural splitting points, such as ----, you can add this to \"Chunk boundary\". The setting for \"Chunk boundary\" is shared with Data Bank."]},{"l":"Vector storage controls","p":["To calculate vectors for all messages in the current chat, without waiting for them to be processed in the background, choose \"Vectorize All\" from the settings.","To see how many messages in the current chat have been vectorized, choose \"View Stats\". This displays the total number of vectors stored. It also indicates the specific chat messages that have been vectorized, by marking them with a green ball.","To remove all the vectors for messages in the current chat, choose \"Purge Vectors\".","The controls for \"Vectorize All\" and \"Purge Vectors\" within Chat vectorization only affect the stored vectors for the current chat. However, there are identical buttons in File vectorization that affect the vectors for files in Data Bank. Ensure that you are purging the vectors that you intend to purge."]},{"l":"Finding relevant messages to shuffle (vector retrieval)","p":["To find the most relevant messages in the chat history, the most recent messages are converted (vectorized) into a query vector. By default, the 2 most recent messages are used. To change this, change the value of \"Query messages\". This value is also used when finding relevant content from Data Bank.","Past messages must have a relevance score of at least 25% to be included. You can change this with \"Score threshold\". The setting for score threshold is shared with Data Bank.","The 3 most relevant messages from chat history are shuffled. You can change this with \"Insert#\".","To avoid disturbing the most recent events in the chat, the 5 most recent messages are not shuffled. To change this, change the value of \"Retain#\"."]},{"l":"Shuffling messages (augmented generation)","p":["The messages are shuffled to one of 3 places:","The top of the chat, after the Main Prompt / Story String (the default)","The top of the chat and before the Main Prompt / Story String","The end of the chat, before the last 2 messages (\"In-chat @ Depth 2\"). Since you just sent a message, this position is usually just before the previous reply from the model.","You can change this with \"Injection Position\" and \"Depth\".","The messages are included in order of relevance, with more relevant messages shown after less relevant messages.","The name of the person or character who sent each message is included.","The messages are shown to the model as \"past events\". This assists the model to understand that the messages contain information from a different point in the chat history than the point at which they are inserted. You can change this with \"Injection Template\".","You can see the final prompt to the model using the Prompt Itemization popup, the terminal logs, or the browser console logs. The browser console logs are useful for understanding what all the steps in Chat vectorization are doing."]},{"l":"Vector summarization","p":["The Vector summarization feature is experimental.","Vector summarization does not create summaries of your chat. It does not turn the retrieved messages into summaries. It does not make your chat history shorter. It is not \"like Summarize but better\".","Vector summarization is intended to make vector search of chat messages more effective. It does this by introducing a summarizing step prior to vectorizing. The summarizing step extracts the most important parts of the message, so that the resulting vector is a better indicator of what the message relates to.","Vector summarization may make vector search less effective.","To summarize the messages in the chat history, and generate a vector for each summarized message, choose \"Summarize chat messages for vector generation\".","The summarized message does not replace the original message in chat. If a vector search matches the vector of a summarized message, the original message is retrieved from chat history and shuffled into context. The summarized versions of the messages are retained in Vector Storage, which may be of interest for debugging.","To summarize the content of the messages used to search the chat history (the last 2 messages by default), choose \"Summarize chat messages when sending\".","Each time a message is summarized for vectorising, a separate request is made to the summarizing model. You can choose which summarizing source is used with \"Summarize with\". Choosing \"Main API\" will generate the summaries using the same model and connection settings that you use for generating chat or text completions.","The request consists of the raw message content and an instruction about how the model should produce the summary. You can change the instruction with \"Summary Prompt\"."]}],[{"l":"Dynamic Audio","p":["This guide will walk you through setting up and customizing dynamic audio assets for your SillyTavern experience."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Make sure you're on the latest version of SillyTavern.","Install the \"Dynamic Audio\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon)."]},{"l":"Dynamic Audio Setup (Browser)","p":["Connect to the Assets Repository:","Launch SillyTavern and navigate to Extensions> Assets.","Click on the \"Connect\" button to establish a connection to the official assets repository.","Download the desired audio assets, such as background music (BGM) or ambient sounds, that correspond to the backgrounds you intend to use.","Enable Dynamic Audio Extension:","In SillyTavern, go to Extensions> Dynamic Audio.","Enable the extension, unmute and adjust the volume of BGM and ambient sounds to your preference.","When bgm end another one will play randomly, click on loop button to keep current bgm playing","Click on roll button to pick another bgm randomly","Expression based BGM:","Enable expression BGM switch if you want bgm to follow character expression (require bgm in character folder see below).","Adjust the cooldown timer (in seconds) between BGM updates. Increase it if you find the BGM changes too frequently in group chats or when using character-specific BGM with emotion detection."]},{"l":"Importing Music for Characters","p":["To set up custom music for your characters' emotions, follow these steps:","Navigate to Character Folder:","Go to the characters folder, e.g., \\SillyTavern\\data\\user-handle\\characters\\Seraphina.","Create BGM Folder:","Inside the character folder, create a subfolder named bgm.","Import Emotion Music:","Within the bgm folder, import the music files for each emotion. Supported audio extensions include .mp3, .ogg, and .wav.","Naming convention: [emotion]_[number].mp3, e.g., anger_0.mp3, joy_0.mp3.","Multiple Tracks for Emotions:","You can import multiple tracks for the same emotion by incrementing the number, e.g., neutral_1.mp3, neutral_2.mp3.","Default Music Selection:","When no emotion is detected, a random neutral track will play as the default. Emotions are detected similarly to updating sprites; refer to the expression images documentation for details."]},{"l":"Changing Default BGM Music","p":["If a character doesn't have custom BGM in their folder, a default track will play. Here's how you can change it:","Navigate to BGM Folder:","Go to the following folder: \\SillyTavern\\data\\user-handle\\assets\\bgm.","Replace/Add Music:","Replace or add music files (.mp3, .ogg, .wav) to this folder.","These are the official audio assets downloaded using the assets extension.","One of these tracks will play randomly when no character-specific BGM is found (solo or group chat)."]},{"l":"Changing Ambient Sounds","p":["Ambient sounds add depth to your scenes. Here's how you can customize them:","Navigate to Ambient Folder:","Go to the following folder: \\SillyTavern\\data\\user-handle\\assets\\ambient.","File Naming Convention:","Ambient audio filenames correspond to background image filenames, replacing spaces with dashes.","Example: bedroom-clean.mp3 corresponds to the \"bedroom clean.jpg\" background.","If the lock button is unlock the audio file corresponding to the background will play. Activating lock will keep current ambient playing.","Custom Ambients:","You can add your own ambient sounds for custom or existing backgrounds by following the same naming pattern.","Thank you for following this guide! Your SillyTavern experience is now enriched with dynamic audio."]}],[{"l":"EmulatorJS","p":["This extension allows you to play retro console games right from the SillyTavern chat."]},{"l":"Installation","p":["Prerequisites:","Latest release version of SillyTavern.","ROM files downloaded from the net. You can find them anywhere.","How to install:","Install using SillyTavern's extensions downloader.","Or use this link: https://github.com/SillyTavern/SillyTavern-EmulatorJS"]},{"l":"Usage","p":["Open the \"EmulatorJS\" extension menu.","Click \"Add ROM file\". ROMs are saved to your browser storage and not stored on a server.","Select the game file to add. Input the name and core (if it wasn't auto-detected). If the core requires a BIOS file, add it too.","Click the \"Play\" button in the list or launch via the wand menu.","You can customize controls and other settings in the emulator frame after launching the game.","Use save/load state functions if you need to take a break.","Check the EmulatorJS docs to see the list of available cores and their requirements: Cores."]},{"l":"Comments mode","p":["With the power of multimodal models, your AI bots can see your gameplay and provide witty in-character comments."]},{"l":"Requirements","p":["A browser that supports ImageCapture. Tested on desktop Chrome. Firefox requires to enable it with config. Safari won't work.","Chat Completion API with image inlining mode is recommended. Check the API documentation to see if the chosen model supports multimodal prompts.","If image inlining is disabled, make sure that the Image Captioning extension is enabled, then select the \"Multimodal\" captioning source."]},{"l":"How to enable comments","p":["Make sure you set the interval of providing comments in the EmulatorJS extension settings. This setting defines how often the character is queried for comments using an image of your current gameplay. A value of 0 indicates that no comments are provided.","Select a character chat and launch the game. For the best performance, make sure that the ROM file is properly named so that AI can have more background context.","Start playing as you normally would. The vision model will be queried periodically to write a comment based on the latest screenshot it \"sees\"."]},{"l":"Settings","p":["Caption template - a prompt used to describe the in-game screenshot.{{game}} and {{core}} additional macros are supported.","Comment template - a prompt used to write a comment based on the generated caption. {{game}}, {{core}}, {{caption}} additional macros are supported. For image inlining mode, {{caption}} is replaced with see included image.","Force captions - will force the use of multimodal captioning even if image inlining is supported and enabled."]},{"l":"Why I'm not seeing any comments?","p":["Comments are temporarily paused (interval step skipped) if:","Emulator is paused (with a pause button, not in-game).","The browser window is out of focus.","The user input area is not empty. This is to let you type your reply in peace.","Another reply generation is currently in progress.","TTS voice is being read aloud. Comment is held off (30 seconds maximum) until it finishes, but not skipped.","A character card or group is currently open. Comment mode is disabled when starting the game from a welcome screen.","Other common issues:","Make sure you've set a commenting interval before launching the game.","Make sure you have set a multimodal API key and there are no errors in the ST server console.","Still doesn't work? Send us your browser debug console logs (press F12)."]},{"l":"Credits","p":["EmulatorJS engine (GPLv3): https://github.com/EmulatorJS/EmulatorJS"]}],[{"l":"Image Captioning","p":["Image Captioning allows SillyTavern to automatically generate text descriptions for images used in chats.","Use Image Captioning when you want your AI character to \"see\" and respond to visual content in your conversations.","Create captions for images you upload or paste into messages","Add context to existing images in the chat history","Use various sources for generation, including local models, cloud APIs, and crowdsourced networks","There are options that require no setup, no money, and no GPU. There are also options that require some or all of those things. Choose the one that fits your needs and resources.","The image captioning extension is built-in to SillyTavern and does not need to be installed separately."]},{"l":"Quick start","p":["Set up:","Open the Image Captioning panel in the Extensions panel","Choose a captioning source (most likely \"Local\" or \"Multimodal\")","For \"Multimodal\" ensure you've set up the connection in the API Connections tab","Generate a caption:","Choose \" Generate Caption\" from the Extensions popup menu","Select an image file when prompted","Wait for the caption to be generated","Review and send:","The captioned image will be inserted into your message","See the caption using the image tooltip","Click Send to see what your character thinks of the image!"]},{"l":"Panel controls"},{"l":"Source Selection","p":["Choose the source for image captioning. Supported options:","Source","Description","Multimodal","Cloud: OpenAI, Anthropic, Google, MistralAI, and others. Local: Ollama, llama.cpp, KoboldCpp, Text Generation WebUI, and vLLM. Supports custom prompts so you can ask your images questions.","Local","Uses transformers.js running locally inside your SillyTavern server. Zero setup!","Horde","Uses the AI Horde network, a crowdsourced distributed network of image generation models. Nothing to download, configure, or pay for. Variable response times.","Extras","The Extras project was discontinued in April 2024 and is not maintained or supported."]},{"l":"Caption Configuration","p":["Caption Prompt: Enter a custom prompt for captioning. The default prompt is \"What's in this image?\"","Ask every time: Toggle to request a custom prompt for each image caption"]},{"l":"Message Template","p":["Message Template: Customize the caption message template. Use {{caption}} macro to insert the generated caption. The default template is [{{user}} sends {{char}} a picture that contains: {{caption}}]"]},{"l":"Auto-captioning","p":["Automatically caption images: Toggle to enable automatic captioning of images pasted or attached to messages","Edit captions before saving: Toggle to allow editing captions before they are saved"]},{"l":"Captioning images","p":["All the ways to caption images in SillyTavern:","Choose \" Generate Caption\" from the Extensions popup menu and select an image file when prompted","Click the Caption icon at the top of an image already in a message","Paste an image directly into the chat input with auto-captioning enabled","Attach an image file to a message using the Embed File or Image button in the actions of a message.","Send a message with an embedded image","Use the /caption slash command"]},{"i":"auto-captioning-1","l":"Auto-Captioning","p":["The auto-captioning feature allows you to automatically generate captions for images as they are added to the chat, without manually triggering the captioning process each time.","To enable, select the \"Automatically caption images\" checkbox in the Image Captioning panel. You can also choose to edit captions before they are saved by checking the \"Edit captions before saving\" box.","Once enabled, auto-captioning will trigger in the following scenarios:","When an image is pasted directly into the chat input.","When an image file is attached to a message.","When a message with an embedded image is sent.","The system will use your selected captioning source (Local, Extras, Horde, or Multimodal) and the configured settings to generate a caption for the image."]},{"l":"Editing captions before saving (Refine Mode)","p":["If you've enabled the \"Edit captions before saving\" option:","After an image is added, a popup will appear with the generated caption.","You can review and edit the caption as needed.","Click \"OK\" to apply the caption, or \"Cancel\" to discard the caption without saving."]},{"l":"Caption sending","p":["The generated (and optionally edited) caption will be automatically inserted into the prompt using the Message Template you've configured. By default, it will be sent in this format:"]},{"l":"Slash Command: /caption","p":["The extension provides a /caption slash command to use in the chatbox or in scripts."]},{"l":"Usage","p":["prompt(optional): A custom prompt for the captioning model. Only supported by multimodal sources.","quiet=true|false: If set to true, suppresses sending a captioned message to the chat. Default is false.","mesId=number: Specifies a message ID to caption an image from an existing message instead of uploading a new one.","If no mesId is provided, the command will prompt you to upload an image. When quiet is false (default), a new message with the captioned image will be sent to the chat. The generated caption can be used as input for other commands."]},{"l":"Examples","p":["Caption a new image with the default settings:","Caption a new image with a custom prompt:","Caption an image from message #5 without sending a new message:","Caption an image from message #10 with a custom prompt then generate a new image based on the caption:"]},{"l":"Local source","p":["You can change the model in config.yaml. The key is called extensions.models.captioning. Enter the Hugging Face model ID you want to use. The default is Xenova/vit-gpt2-image-captioning.","You can use any model that supports image captioning ( VisionEncoderDecoderModel or \"image-to-text\" pipeline). The model needs be to compatible with the transformers.js library. That is, it needs ONNX weights. Look for models with the ONNX and image-to-text tags, or that have a folder called onnx full of .onnx files."]},{"l":"Multimodal source"},{"l":"General configuration","p":["Model: Choose the model for image captioning. Options vary based on the selected API.","Allow reverse proxy: Toggle to allow using a reverse proxy if defined and valid (OpenAI, Anthropic, Google, Mistral, xAI)","API keys and endpoint URLs for captioning sources are managed in the API Connections panel. Set the connection up in API Connections first, then select it as your captions source in Captioning.","One last time: configure the API key/address/port in API Connections and use the connection in Captioning.","You can still use Claude for chats and Google AI Studio for image captioning, or whatever. Just set them both up in the 'API Connections' tab first. Then flip your Chat Completion source to Claude and your Captioning source to Google AI Studio.","For most local backends, you will need to set some options in the model backend rather than in SillyTavern. If your backend can only run one model at a time and doesn't support automatic switching, you have several options to use different models for chat and captioning:","Secondary endpoints: Use the secondary endpoint feature (see Secondary endpoints section below) to connect to a different API server for captioning","Multiple connection types: Connect to your backend using both Text Completion and Chat Completion modes in API Connections - this gives you two separate connections to the same backend type"]},{"l":"Sources","p":["\"I don't want to pay anything or run anything\": Google AI Studio free tier","\"I want the best captioning possible, and I don't mind paying for it\": Anthropic","\"I want to caption images locally and have it just work\": Ollama","\"I want to complain when it doesn't work\": Extras","\"I want to keep the dream of local AI alive\": KoboldCpp","01.AI (Yi)","AI/ML API","Anthropic","API Provider","Cloud, free","Cloud, free tier then paid, Gemini Flash/Pro","Cloud, free tier, Gemini Flash/Pro","Cloud, llama-3.2-vision in 11B/90B, LLaVA","Cloud, paid (maybe free options), many models, pick from what's available within Captioning after configuring in API connections","Cloud, paid, Aya Vision 8B / 32B","Cloud, paid, Claude models with vision capabilities: claude-3-5-sonnet/haiku, claude-3-opus/sonnet","Cloud, paid, GPT-4 Vision, 4-turbo, 4o, 4o-mini","Cloud, paid, grok-vision","Cloud, paid, pixtral-large, pixtral-12B","Cloud, paid, various GPT, Claude, and Gemini models with vision capabilities","Cloud, paid, yi-vision","Cohere","Custom (OpenAI-compatible)","Description","For custom OpenAI-compatible APIs, uses currently configured model in API Connections tab","Google AI Studio","Google Vertex AI","Groq","KoboldCpp","llama.cpp","Local","Local, can switch between available models and download additional vision models within Captioning after configuring in API Connections","Local, must configure model in KoboldCpp","Local, must configure model in llama.cpp","Local, must configure model in ooba","MistralAI","Ollama","OpenAI","OpenRouter","Pollinations","Text Generation WebUI (oobabooga)","To use one of these caption sources, select Multimodal in the Source dropdown.","vLLM","xAI (Grok)"]},{"l":"Secondary endpoints","p":["By default, the Multimodal source uses the primary endpoint configured in the API Connections tab. You can also set up a secondary endpoint specifically for multimodal captioning.","Open the Image Captioning panel in the Extensions panel.","Select \"Multimodal\" as the captioning source and a preferred API provider.","Enter a valid URL for the secondary endpoint in the \"Secondary captioning endpoint URL\" field.","Check the \"Use secondary URL\" box to enable the secondary endpoint.","Do not append /v1 or /chat/completions to the end of the URL. The extension will handle that automatically.","This is only supported by the following APIs:","KoboldCpp","llama.cpp","Ollama","Text Generation WebUI (oobabooga)","vLLM"]},{"l":"Source-specific guides"},{"l":"KoboldCpp","p":["For general information on installing and using KoboldCpp, see the KoboldCpp documentation.","To use KoboldCpp for multimodal captioning:","get a multimodal-capable model, trained to process text and image prompts at the same time.","also get the multimodal projections for the model. These weights allow the model to understand how the text and image parts of the input relate to each other.","load the model and projections in the KoboldCpp launch GUI or command line interface.","The original and classic local multimodal model is LLaVA. GGUF-format files for the model and projections are available from Mozilla/llava-v1.5-7b-llamafile. To load them from the command line, set the model and projections with the --model and --mmproj flags. For example:","Some LLaVA finetunes you can try: xtuner/llava-llama-3-8b-v1_1-gguf, xtuner/llava-phi-3-mini-gguf.","You can use multimodal projections for the base model that your particular finetune was built from. Projections for some common base models are available from koboldcpp/mmproj."]}],[{"l":"Image Generation","p":["Ability to view all generated images in a character gallery","Advanced ComfyUI integration for highly customizable workflows","Automatically generate images as replies to your messages for full immersion, generate from chat history and character information from the wand menu or slash commands, or use the /sd (anything_here) command in the chat input bar to make an image with your own prompt.","Character-specific prompt prefixes for tailored character images","Customizable prompt templates and prefixes for consistent style and quality","Flexible visibility options for generated images in chat","Image swipes feature to regenerate images while keeping the same prompt","Integration with AI function calling for automatic image generation detection","Interactive mode to trigger image generation based on natural language requests","Most common Stable Diffusion generation settings are customizable within the SillyTavern UI.","Options to edit prompts before generation and extend free-mode prompts","Slash commands for easy image generation within chats","Style presets to quickly switch between different image generation settings","Supports multiple image generation sources, both local and cloud-based","Use local or cloud-based Stable Diffusion, FLUX or DALL-E APIs to generate images.","Various generation modes for characters, scenes, and custom prompts"]},{"l":"Supported sources","p":["AI.ML API","Black Forest Labs","Cloud","Cloud, free of charge","Cloud, open source (AGPL3), free of charge","Cloud, open source (MIT), free of charge","Cloud, paid","Cloud, paid. Imagen model series. AI Studio only supports Imagen 3.0 002 model.","Cloud, requires an active subscription","ComfyUI","Deprecated, not recommended","Draw Things","FAL.AI","Google AI Studio/ Google Vertex AI","HuggingFace Serverless","Local, Mac/iOS, free of charge","Local, open source (AGPL3), free of charge","Local, open source (GPL3), free of charge, see ComfyUI Configuration.","NanoGPT","NovelAI Diffusion","OpenAI","Pollinations","Remarks","SD.Next / vladmandic","SillyTavern Extras","Source","Stability AI","Stable Diffusion WebUI / AUTOMATIC1111","Stable Horde","TogetherAI","x.AI"]},{"l":"Generation modes","p":["-","\"Background\"","\"Me\"","\"Raw Last Message\"","\"The Last Message\"","\"The Whole Story\"","\"Your Face\"","\"Yourself\"","A chat background based on story context.","A close-up portrait of the current character.","A full-body portrait of the current character.","A portrait of the user persona.","A visual recap of the chat events.","A visual recap of the last chat message.","background","Description","face","Forces a portrait aspect ratio.","Forces a wide landscape aspect ratio.","last","Last message used as a prompt verbatim.","me","raw_last","Remarks","scene","Slash command argument","Wand menu item","you"]},{"l":"How to generate an image","p":["Use the \"Image Generation\" item in the extensions context menu (wand).","Type a /sd (argument) slash command with an argument from the Generation modes table. Anything else would trigger a \"free mode\" to make SD generate whatever you prompted. Example: /sd apple tree would generate a picture of an apple tree.","Look for a paintbrush icon in the context actions for chat messages. This will force the \"Raw Message\" mode for the selected message.","Every generation mode besides raw message and free mode will trigger a prompt generation using your currently selected main generation API to convert chat context into the SD prompt. You can configure the instruction template for generating prompts for every generation mode using the \"SD Prompt Templates\" settings drawer in the extensions panel."]},{"l":"Tips and tricks for the /sd command usage"},{"l":"View all generated images","p":["To view all saved images for a character (including other chats), open a gallery from a \"More...\" dropdown menu on a character info panel, or use a /show-gallery slash command."]},{"l":"Specify a negative prompt","p":["Use a negative named argument before the prompt to enforce a specific negative prompt for this generation."]},{"l":"Include a character-specific prefix","p":["Use a special {{charPrefix}} macro in free-prompt mode to include positive and negative prompt prefixes (if defined) for the current character."]},{"l":"Suppress a chat message","p":["You can avoid posting a generated image into the chat by passing a quiet=true named argument. The image will still be added into the character gallery, and the command will produce a relative URL to the image that can be consumed by other commands.","The example below will send the generated image using Markdown as a user persona."]},{"l":"Image swipes","p":["Images swipes allow to reroll the image generation while keeping the same prompt. If a fixed seed is set, it will be randomized for the next generation.","To cycle through images, hover a mouse cursor (tap on mobile) over a generated image to reveal arrow buttons and swipes counter. Tapping right arrow on the latest image will generate a new one.","'Swipes' here is just a name, don't try the actual swiping gesture, as this will regenerate the message itself, not the attached image."]},{"l":"Options"},{"l":"Edit prompts before generation","p":["Allow to edit the automatically generated prompts manually before sending them to the Stable Diffusion API."]},{"l":"Use function tool","p":["Uses function calling to automatically detect the intention to generate an image.","Requirements:","Must have image generation configured with a supported source.","Must use a supported Chat Completion API model and have function tool calling enabled in the AI Response settings.","The \"Use function tool\" option must be enabled in the Image Generation settings.","The user should express an intent to generate an image in the chat message, e.g. \"Send me a picture of a cat\".","The interactive mode will not trigger when the function tool is enabled."]},{"l":"Use interactive mode","p":["Allows to trigger an image generation instead of text as a reply to a user message that follows the special pattern:","Contains one of the following verbs: send, mail, imagine, generate, make, create, draw, paint, render","Followed by one of the following nouns (not further than 10 characters away): pic, picture, image, drawing, painting, photo, photograph","Followed by a target subject of image generation, could be optionally preceded by phrases like \"of a\" or \"of this\".","Examples of valid requests and captured subjects:","Can you please send me a picture of a cat=> cat","Generate a picture of the Eiffel tower=> Eiffel tower","Let's draw a painting of Mona Lisa=> Mona Lisa","Some special subjects trigger a predefined generation mode:","'you, 'yourself' => \"Yourself\"","'your face', 'your portrait', 'your selfie' => \"Your Face\"","'me', 'myself' => \"Me\"","'story', 'scenario', 'whole story' => \"The Whole Story\"","'last message' => \"The Last Message\"","'background', 'scene background', 'scene', 'scenery', 'surroundings', 'environment' => \"Background\""]},{"l":"Extend free-mode prompts","p":["When using the interactive mode of the slash command, automatically extend free-mode generation subject descriptions by prompting your main API."]},{"l":"Snap auto-adjusted resolutions","p":["Snap image generation requests with a forced aspect ratio (portraits, backgrounds) to the nearest known resolution, while trying to preserve the absolute pixel counts. Refer to the \"Resolution\" dropdown for the list of possible options.","Recommended for SDXL models."]},{"l":"Common prompt prefix","p":["Use {prompt} macro to specify where exactly the generated prompt will be inserted.","Added before every generated or free-mode prompt. Commonly used for setting the overall style of the picture.","Example: best quality, anime lineart."]},{"l":"Negative prompt","p":["Characteristics of the image you don't want to be present in the output.","Example: bad quality, watermark."]},{"l":"Character-specific prompt prefix","p":["If supported by the generation source, you can also use LoRAs/embeddings here, for example: lora:DonaldDuck:1.","Any characteristics that describe the currently selected character. Will be added after a common prefix.","Example: female, green eyes, brown hair, pink shirt.","You can also specify a negative prompt prefix for any unwanted content. It will be combined with the general negative prompt.","Limitations:","Works only in 1-to-1 chats. Will not be used in groups.","Won't be used for backgrounds and free mode generations.","To force include a character prefix into a free mode prompt, use the {{charPrefix}} macro anywhere in the prompt.","If you want to share the prefixes with others, tick the \"Shareable\" checkbox. This will save them with the character data, rather than your local settings."]},{"l":"Styles","p":["Use this to quickly save and restore your favorite style/quality presets to use them later or when switching between models. The following is included in the Style preset:","Common Prompt Prefix","Negative Prompt","You can also switch between styles using the /imagine-style command (or /sd-style or /img-style)."]},{"l":"Chat Message Visibility","p":["Generated images inserted into the chat are hidden in the main API prompts by default, but this can be overriden individually per generation initiator (\"Magic wand\" icon, slash command, interactive mode). This can be used for making the experience more immersive by letting the characters \"acknowledge\" the images. Multimodal models in Chat Completions API may also 'see' the images if \"Send inline images\" is enabled.","A text message can be customized by changing the \"Chat Message Template\" under Image Prompt Templates. All regular macros can be used in this template, plus a special {{prompt}} macro to specify where the image prompt will be added."]},{"l":"ComfyUI Configuration","p":["ComfyUI is a fast and very flexible option for image generation.","If you're familiar with ComfyUI, the tl;dr is: make your workflow in ComfyUI, download it in API format, and paste it into the SillyTavern ComfyUI Workflow Editor. ST will submit your workflow to ComfyUI's API and you will get an image in your chat. But with great power comes great responsibility, and the main responsibility is inserting placeholders in your workflow JSON so you can change settings from SillyTavern.","If you're not familiar with ComfyUI, you can still use it to generate images in SillyTavern using the default workflow. Later, when you want great power, you can learn how to use ComfyUI..."]},{"l":"Controls","p":["This panel allows you to configure and manage your ComfyUI integration with SillyTavern.","Enter the URL of your ComfyUI server in the ComfyUI URL input field. The default value is http://127.0.0.1:8188. If you are using SwarmUI, the default port for the managed ComfyUI server is 7821, 20 ports higher than the default port for SwarmUI.","After entering the URL, choose Connect to validate and establish a connection. The ComfyUI server must be accessible from the SillyTavern host machine."]},{"l":"Workflow Management","p":["Select a ComfyUI workflow from the dropdown menu. Two default workflows are provided:","Default_Comfy_Workflow.json: A basic text-to-image workflow supporting the most common image generation settings.","Char_Avatar_Comfy_Workflow.json: A sample image-to-image workflow that uses the character avatar, plus the prompt, to generate an image.","Use the following buttons to manage your workflows:","Open workflow editor to view and modify the selected workflow.","Create new workflow to create a new workflow with a custom name.","Delete workflow to remove the selected workflow."]},{"l":"Workflow Editor","p":["The ComfyUI Workflow Editor allows you to view and modify ComfyUI workflows for use with SillyTavern.","The main component of the editor is a large text area where you can insert or edit your ComfyUI workflow in JSON format.","To add a ComfyUI workflow to the editor, follow these steps:","Enable 'Dev Mode' in ComfyUI settings.","Use the 'Save (API Format)' option in ComfyUI to download the JSON data.","Create a new workflow in SillyTavern and open the editor.","Paste the downloaded JSON data into the text area.","Replace specific values with placeholders as needed for your use case.","You can add the API-format JSON file directly to the data/default-user/user/workflows directory in your SillyTavern installation. This will save you from steps 3 and 4.","Retain the original JSON file. If you need to open the workflow again in ComfyUI to make changes, it is much more convenient to edit the original file than the one with all the placeholders."]},{"l":"Placeholders","p":["The editor provides a list of predefined placeholders that can be used in your workflow JSON. These placeholders are replaced with dynamic values when the workflow is executed in SillyTavern.","Placeholders marked with ✅ are present in your workflow JSON. Placeholders marked with ❌ are not present in your workflow JSON. You can add these placeholders to your workflow JSON as needed. You do not need to add all the placeholders, only the ones that your workflow uses and you want to replace dynamically."]},{"l":"Prompts","p":["The %prompt% and %negative_prompt% placeholders are used to insert the image generation prompts into the workflow. These contain the final prompts generated by SillyTavern, including the generated prompt for your chosen /sd mode, the common prompt prefix, negative prompt, and character-specific prompt prefix.","For example, you may have tested your workflow with a prompt like \"forest elf\" in ComfyUI. To use this workflow in SillyTavern, you can replace the \"forest elf\" prompt with the %prompt% placeholder:","Notice that the placeholder is wrapped in double quotes. This is important for the JSON format, and required by SillyTavern's placeholder replacement system. Even for numbers, you must use double quotes in the template JSON.","Sometimes the prompt (or other value) doesn't appear where you might expect. ComfyUI will remove nodes from the API version of the workflow if they are not necessary for the workflow to function in API mode.","For instance, this workflow uses a LoRA tag loader node with a prompt primitive so the workflow is clearer in UI mode:","Prompt primitive and LoRA loader","The prompt primitive node will be removed from the API version of the workflow, so you insert the placeholder in the LoraTagLoader node. Find the text \"apple tree\" in the workflow and replace it with the %prompt% placeholder:","In some cases you may need to make several replacements in the workflow JSON, even if the prompt appears only once in the UI."]},{"l":"Model","p":["The %model% placeholder will insert the value of the selected model in the image generation settings.","An example from the default text-to-image workflow:","To load GGUF-quantized UNets, use a UNet Loader (GGUF) node in your workflow, choose a GGUF model in the SillyTavern model dropdown, and use the %model% placeholder in the node's settings like this:","Stable Diffusion checkpoints, SD UNets, and GGUF-quantized UNets all appear in the Model dropdown. Models of one type will not work with workflows/loader nodes expecting another type. If you choose an incompatible model type in ST, ComfyUI will report a problem with the loader node."]},{"l":"Avatar images","p":["Use the %user_avatar% and %char_avatar% placeholders to include the user and character avatars in the workflow. These placeholders are replaced with the PNG data of the avatars when the workflow is executed. The image data is encoded in base64 format, so you must decode it in your workflow. A popular choice for this task is the Load image (Base64) node.","In this example, the character avatar is loaded with a Load Image (Base64) node. It also uses an Image Resize node to rescale the image to whatever size is specified in the image generation settings:","Load image from base64 string and resize","Insert the %char_avatar%, %width%, and %height% placeholders into the JSON for the Load Image (Base64) and Image Resize nodes:","To get a base64-encoded image string for testing your workflow in ComfyUI, use any online tool that converts images to base64 strings. Here's an example string you can use for initial testing: sd-comfy-base64-test-string.txt."]},{"l":"Other placeholders","p":["Most other placeholders use the values of the corresponding controls in image generation settings, or the values that you specify with the /sd command:","%vae%, but most SD models include a VAE so the default workflows do not use this placeholder. Use it with custom workflows to load a VAE alongside a UNet, override the default VAE, etc.","%sampler%","%scheduler%","%steps%","%scale%","%width%","%height%","%denoise%: for the sample image-to-image workflow, vary the denoise amount between about 0.5 (barely-noticeable changes to the source image) and 1.0 (a completely different image as if no source image was used). Not used by the default text-to-image workflow because there's no point using a value other than 1.0 for text-to-image.","%clip_skip%: not used by the default workflows but available for custom workflows.","The %seed% placeholder will insert the seed value from the control if you have specified one. If you set the seed to -1, SillyTavern will generate a new random seed for each image in %seed%."]},{"l":"Custom placeholders","p":["You can add custom placeholders to your workflow:","Look for the \"Custom\" section below the predefined placeholders.","Click the \"+\" button to add a new custom placeholder.","Enter a name for the placeholder in the find field.","Enter the value that you want to replace the placeholder with in the replace field.","Custom placeholders will appear in a separate list below the predefined ones.","For example, you could replace the \"SillyTavern\" prefix for saved image filenames in the default workflow with a custom placeholder. Add a new custom placeholder with find set to filename_prefix and replace set to ServiceTesnor. Insert the new %filename_prefix% placeholder into your workflow JSON. Now you can change the filename prefix from SillyTavern to ServiceTesnor by changing the value of the custom placeholder."]},{"l":"Comfy tricks","p":["Read all the general information on this page so you're familiar with the image generation options. Options such as switchable styles and common prompt prefixes, when combined wih the total flexibility of ComfyUI workflows, allow you to create a wide variety of image generation setups."]},{"l":"Loading LoRAs","p":["Use a LoRA tag loader node (such as Load LoRA Tag) to load any LoRAs specified in the prompt. Now you can add as many LoRAs as you like to your prompt with tags like lora:CroissantStyle:0.8, and they will be loaded into your workflow. This will also make the \"pro-tip\" of using LoRAs in character-specific prompt prefixes work with ComfyUI."]},{"l":"Setting workflow values from styles or slash-commands","p":["You can use macros in custom placeholder values. As a practical example, let's say you sometimes want to generate images without a background, and you'd like this to be switchable with a slash-command or image style. Here's how you could do it:","Make a ComfyUI workflow that removes the image background, or not, depending on the value of an input","Use a custom placeholder to set the value of that input, but use {{getvar::remove_background}} as the replace value","Now you can set the value of remove_background with /setvar key=remove_background true or /setvar key=remove_background false before generating an image","The workflow will use the value you set to determine whether to remove the background","Make an image style \"No background\" with common prompt prefix {{setvar::remove_background::true}}","Use the style control or /imagine-style No background to set the value of remove_background to true before generating an image"]}],[{"l":"Live2D","p":["This guide will walk you through the process of setting up and customizing the Live2D extension for your SillyTavern experience. This extension allows you to use Live2D animated models for your character, providing a dynamic and interactive element to your virtual character."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Branch Selection: Make sure you're using the latest version of SillyTavern to access the latest features and updates.","Extension Installation: Install the \"Live2D\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (represented by the stacked blocks icon).","Model Folder Placement: Place your Live2D model folders into the /data/user-handle/assets/live2d directory. A properly organized live2d assets folder might look like this:","Asset folder example","A Live2D model folder should include all necessary components for the Live2D model, such as expressions, motions, textures, sounds, and settings files. Notably the ***.model.json file must be at the root of the Live2D model folder for the model to be detected by the extension. In this example the shizuku live2d model folder may look like this:","Live2d model folder example","Note: Models can also be placed in character-specific folders, such as /data/user-handle/characters/Shizuku/live2d/. However, models in character folders will only be accessible for that specific character."]},{"l":"Extension Settings","p":["The Live2D extension offers various settings to customize the behavior of your animated model. Here are the key settings:","UI global settings"]},{"l":"Global Settings","p":["Enabled:","Enable this checkbox to activate the extension, allowing your Live2D model to interact within SillyTavern.","You can disable the extension if you want to use normal sprites only.","You can disable the extension when you want to move normal sprites in a group chat and enable it again when you're ready to use Live2D models.","Follow Cursor:","Enable this checkbox to make the Live2D model follow your cursor, provided that the model supports this feature.","Auto-send Interaction:","Enable this checkbox to automatically trigger character interactions when you click on areas with mapped messages (refer to the hit areas section for details)."]},{"l":"Debug Settings","p":["These settings help you control the behavior and visibility of your Live2D model for debugging purposes.","Reset Model Before Animation:","Enable this checkbox to reload the model before any animation. This forces the animation to start and allows you to spam clicks if necessary. Some models may require this to ensure that animations begin from a compatible state.","Show Model Frames:","Enable this checkbox to display the model frame, making it easier to identify where to click to drag the model around. It also shows the hit area, if available. Hovering over a hit area will show its name.","Reload button","Click this button to reload every live2d model. Use it in case something glitches."]},{"l":"Character Selection","p":["These settings allow you to manage characters and assign Live2D models to them.","Refresh Button:","Click the refresh button to update the list of characters in the current chat.","Select Character:","Use the drop-down list to choose a character to assign a Live2D model to.","Remove Button:","Click this button to delete all assigned models for a character. A confirmation prompt will appear to confirm the deletion."]},{"l":"Model Selection","p":["UI model list","Refresh Button:","Click the refresh button if your Live2D model does not appear in the list.","Select Model:","Choose a model from the list to assign it to the selected character.","The model can be located in the asset folder or the current character's folder.","The list displays the model folder name, its origin (asset or character), and the name of the detected model setting file.","Note that some model folders may contain different versions of the same model. You can try different model files to see which one works best.","Selecting none will use normal sprites if there is any","Settings are saved per character and model"]},{"l":"Model Settings","p":["UI model settings","Model Scale:","Use the slider to adjust the size of the model, making it larger or smaller.","Model Center X Offset:","Use the slider to change the horizontal position of the model relative to the window center.","Model Center Y Offset:","Use the slider to adjust the vertical position of the model relative to the window center."]},{"l":"Remarks","p":["The settings are saved and carry over different chats.","You can also drag the model with your mouse, and those settings will be updated and saved.","Use these UI settings to bring your model back on the screen if you somehow made it out of view. Also, check the \"Show frame\" checkbox to see clearly where you can click to drag the model."]},{"l":"Model Talk","p":["UI model talk","Param mouth open Y id","Select from the list the ID of the parameter corresponding to the model's mouth Y value. Not all models have one, and names may vary from model to model. Usually something like \"PARAM_MOUTH_OPEN_Y\" or \"ParamMouthOpenY\". Check the model when selecting an element from the list; it will try to run the speak animation. If the mouth moves, you got it!","Mouth movement speed","Adjust the slider to change the movement speed of the mouth animation.","Time per character","Set the time duration of each character. The duration of the talk animation will be this time multiplied by the number of characters of the message."]},{"i":"remarks-1","l":"Remarks","p":["This mouth animation does not work on every model and every animation. Even if your model has animations where the mouth moves, it does not mean the mouth animation can be controlled by this extension. If nothing shows in the parameter list, your model is probably made with a too old version of Live2D to access the parameters properly."]},{"l":"Model Animations","p":["UI model animations","Starter animation","Select an expression and motion from the lists that will play when starting a chat with the character. You can also add a delay during which the model will be invisible if you need to hide the character for some time to achieve a perfect effect.","Default animation","Select an expression and motion from the list that will play when the character sends a message. Use a fallback animation when using the classify expression extension."]},{"i":"remarks-2","l":"Remarks","p":["Animations will play when you select one in the lists.","Use the replay button to replay the selected animation.","Some models have expressions defined as motions.","If nothing shows in the lists, it's probable your model's setting file has no expressions/motions defined."]},{"l":"Hit areas mapping","p":["UI model mapping","Default click animation","Select an expression and motion from the list that will play when you click on the model. You can also set a message that will be sent as a user message.","Hit areas","If the model has hit areas, they will be listed, and you can assign an animation/message to each of them."]},{"i":"remarks-3","l":"Remarks","p":["Some models have no hit areas, but the default click is detected for all.","The default click will trigger if you click on a hit area with nothing mapped or if you click outside of any hit area.","Hit areas have priority defined in the model; for example, \"mouth\" is inside \"head.\" If it does not behave properly, it may be due to the model file.","For some models, animations need to be finished before starting another one. Use the debug checkbox if you want to force the refresh and spam animations."]},{"l":"Classified Expressions Mapping","p":["UI model classify","Requirements","Requires the use of the classify expression extension; otherwise, it will fall back to the default animation.","Mapping","For each detected emotion by the classify extension, you can assign an expression/motion animation."]},{"i":"remarks-4","l":"Remarks","p":["If the previous animation did not finish when a new message is received, it's possible that the new animation will not play. This behavior is dependent on the Live2D model. Use the debug checkbox if you want to force the animation to play.","Thank you for following this guide! Your SillyTavern experience is now enriched with animated and interactive Live2D models."]}],[{"l":"Objective"},{"l":"What is it?","p":["The Objective extension lets the user specify an Objective for the AI to strive towards during the chat. This objective is broken down into step-by-step tasks. Tasks may be branched, where child tasks can be created automatically or manually. This gives the ability to create complex task trees. The completion status of each task in the list will be checked at certain intervals.","This differs from adding static direction through prompting in that it adds sequential and paced directives for the AI to follow without user intervention. It gives a more genuine experience of the AI autonomously striving to reach a goal."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Make sure you're on the latest version of SillyTavern.","Install the \"Objective\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon)."]},{"l":"Common Use Cases","p":["Your imagination is the limit, you can give the AI any objective you wish and it will plan out how to achieve it. You can ask it to plan how to slay a demon, rob a temple, throw a lavish party, or even take over the world.","Objective Settings Panel"]},{"l":"Configuration","p":["The extension is found in the Extensions menu under Objective.","Type an objective into the top text box, then click on Auto-Generate Tasks. This sends a request to the connected API and asks it to provide a list of tasks which match the objective you have typed in.","Note: Clicking Auto-Generate Tasks will delete all existing tasks for the currently selected Objective before adding new ones.","Upon receiving the response from the AI, a list of tasks will be created automatically in the space below the Objective input box. Tasks can be edited after creation.","At the bottom of the panel are two boxes: Position in Chat and Task Check Frequency","Position in Chat- This is how 'deep' in the chat section of the prompt you want the current task to be inserted. The lower the number, the more attention the AI will give to the task. Setting to 0 will make the task the primary thing in the AI's mind. Setting at high values will put the task in the background and allow the AI to focus on the conversation at hand, but setting it too high may cause the AI to never 'get around' to the task at all.","Task Check Frequency- This is how often you want the AI to check if the task has been completed. If it is set to 3, the AI will be asked if the current task has been completed every 3rd message.","Objectives, tasks, and their descriptions are saved in real-time to the current chat session. Custom prompts are saved globally."]},{"l":"Custom Prompts","p":["You can customize the prompts sent to the LLM to generate tasks, check task completion, and for prompt injection. Editing prompts will save them for the current session. Custom prompts can be saved and loaded for persistence.","Click Edit Prompts to open the prompt editor window. You can edit your prompts as desired.","To save prompts, enter a name and click Save Prompt.","To load prompts, select the prompt from the dropdown list.","To delete a saved prompt, select it from the dropdown list and click Delete Prompt","WARNING: Task Checking happens in a separate API request. Setting Task Check Frequency to 1 will double your API calls to the LLM service. Be careful with this if you are using a paid service."]},{"l":"Usage","p":["By default the Objective extension will keep track of all tasks and their respective completion status automatically.","The User can also manually create, update, delete, and complete tasks at any time."]},{"l":"Current Task Selection","p":["The current task will always be the first listed incomplete task. Any manual updates to tasks will trigger a check for what the current task should be. So if you add a task above a bunch of completed tasks, it will be set as the current task. Once it's completed, previously completed tasks will be skipped and the next incomplete task will be selected as 'Current'.","When using parent/child tasks in a task tree, tasks are selected depth-first, meaning all child tasks will be selected in order first, then continue down the list of tasks for the current Objective/Task."]},{"l":"Branch Tasks","p":["Click the Branch Task button to set the current task as an Objective where you can auto generate or manually create tasks as child tasks. You can continue to turn any child task into an Objective and keep generating to your hearts content.","Marking a parent task as complete will cause the extension to skip all subtasks. When all child tasks are complete, the parent task will be marked as complete"]},{"l":"Manually Complete Tasks","p":["You can manually toggle the completion status of a task by clicking the checkbox next to it. This will set the next incomplete task to be selected."]},{"l":"Manual Task Check","p":["If you want to manually trigger the AI to check for task completion, click on the Extras Extension button (the magic wand on the right side of the chat input bar) and select Manual Task Check."]},{"l":"Manually Add Tasks","p":["When no tasks are present, an Add Task button is visible, allowing you to manually create the first task.","If other tasks are already present, click the + button to the right of any task to insert a new task after it."]},{"l":"Delete Tasks","p":["Click the red x to delete an existing task. The next incomplete task will be selected as the current task automatically.","Deleting a task with child tasks will delete all child tasks and their descendants."]},{"l":"Hiding Tasks","p":["If you want to remain unaware of what tasks the AI is attempting to complete, check the Hide Tasks box to hide the task list and make the AI's intentions a mystery. For 100% mysteriousness, do this before clicking Auto-Generate Tasks!"]}],[{"l":"Regex"},{"l":"What is it?","p":["The Regex extension lets the user automatically detect specific patterns in a string of text (called 'sequences') and apply manipulations (replacements) to them. It can be a powerful tool when used in conjuction with other SillyTavern features such as Quick Replies or STscript, or simply a way to remove certain words from a chat."]},{"l":"Helpful Links","p":["This document will not explain the process of writing a RegEx sequence in depth. There are many online resources to assist you with that.","https://regexr.com","https://regex101.com","https://extendsclass.com/regex-tester.html","https://en.wikipedia.org/wiki/Regular_expression"]},{"l":"Prerequisites","p":["Regex is a built-in extension of SillyTavern, so no additional setup is required.","You may find its settings in the Extensions panel."]},{"l":"Common Use Cases","p":["RegEx is often used to apply a find-replace function on certain words in the chat, to add markdown styles to certain words or sentence types, or to return a boolean value to an STscript."]},{"l":"Script List","p":["RegEx Extension Script List","The buttons at the top are used to make a new script.","'Global' scripts will apply to all characters and will be saved into settings.json.","'Scoped' scripts will only apply to the currently active character, and will be saved into the character card's data.","'Import' lets you import RegEx scripts which were exported from another instance of SillyTavern.","Below this is a list of your scripts with some action buttons.","Drag handles (three horizontal bars to the left of the script name) let you drag/drop the scripts into any order you like.","Primary on/off switch can be quickly toggled to enable or disable the script without changing anything else. Disabled scripts are shown with strikethrough styling. If a script is disabled here, it will be untriggerable by a Quick Reply or STscript.","'Edit' (pencil) button will open the RegEx script editor.","'Move to scoped' (down arrow) will convert a global script to a scoped script and apply it to the current character. In reverse (up arrow), it would convert a scoped script to global.","'Export' will cause your browser to download an exported .json file of the Script, which can then be shared and imported into another instance of SillyTavern.","'Delete' (trashcan) deletes the script."]},{"l":"RegEx Editor","p":["'AI Response': script will be run against the contents of the AI's response after it is received.","'Disabled' prevents the script from running. This is used as an override to prevent the script from running when you simply don't want to change any of the script's settings and/or don't want to disable it entirely via the switch on the script list (as doing so would prevent slash commands from triggering it).","'Don't Substitute' will cause any SillyTavern macros to be ignored so the RegEx script will treat them literally when searching.","'Escaped' will add a RegEx escape slash \\ before each character to ensure they do not accidentally alter the overall RegEx sequence. This can be useful if you have certain special characters in the values of the macro.","'Raw' will send in the value of the macro verbatim. This might alter the way your RegEx script searches the text if the value of the macro contains certain special characters.","'Reasoning': script will be run against the contents of the 'reasoning' object returned by Chat Completion API's like Gemini or Deepseek. If 'Alter Outgoing Prompt' is checked under Ephemerality, the script will also be applied to any reasoning blocks that are added into prompt in subsequent chat turns.","'Run on Edit' makes the script also run after a chat message has been edited. If this is unchecked, the contents of edited chat messages will not trigger the script.","'Slash Commands': script will be run against the values inserted into prompt/chat by slash commands.","'User Input': script will be run against the contents of the user's typed input after they hit Send.","'World Info': script will be run on against contents of World Info entries as they are injected into the prompt. Requires 'Alter Outgoing Prompt' to be checked (or both ephemerality boxes to be unchecked).","Adding the extension-specific macro {{match}} in this box will insert the full matched sequence of text. This is commonly used to apply styles to specific words. Going back to the above example, if **{{match}}** were put into the 'Replace With' box instead, all occurences of the word 'apple' would be replaced with **apple**, which would apply the bold markdown style to it.","Affects: This list of checkboxes defines the text sources to which the RegEx script will be applied.","Find Regex: This is the Regular Expression that is used to detect your targeted text pattern. This is usually the most complex part of any RegEx script, and is the easiest place to make mistakes. Refer to the links at the top of the page for information how to write a RegEx sequence. This box can resolve the values of common SillyTavern macros(such as {{user}}, {{char}}, etc) if the 'Macros in Find Regex' is set to do so (see below).","If everthing here is unchecked the script will never activate during normal chatting, but it can still be activated via slash command or STscript.","Macros in Find Regex: Select whether or not to replace macros (such as {{user}}, {{char}}, etc) that are present in the Find Regex box's sequence.","Name: The label for the script shown on the extension's script list. This is also used to target the script when triggering it via slash command or STscript.","Other Options:","Replace With: This is what will replace the matched sequence. In a very simple example, if your 'Find Regex' is apple, and your 'Replace With' is orange, the first occurence of 'apple' would be automatically changed to 'orange' in any text where the script is applied.","Test Mode: This will open a comparison view at the top of the editor. Type some text into the 'Input' box, and the results of your RegEx script will be shown in the Output box. It is a valuable debug tool as it will update the Output box in real time as you make changes to the script settings.","Trim Out: text put in this box will be removed from the matched text sequence before the 'Replace With' process is applied. For example, if our match was 'apple', and the Trim Out box contains 'le', then the letters 'le' would be removed first before the 'Replace With' process is applied. Since our 'Replace With' box contains **{{match}}** it would result in **app** being put in as the replacement for 'apple' (first 'le' is removed, and the remaining matched text is given the bold markdown style). Multiple trims can be applied by adding a newline between each string you want to remove.","Variables such as $1, $2, $3 etc can be used to insert what are called 'Capture Groups'. These are substrings located in the text sequence matched by the 'Find Regex' sequence. Note that using these variables requires the matching expression to contain sets of parentheses to define which part of the matched string counts as a captured group. Refer to the links at the top for reference on how to set up Capture Groups."]},{"l":"Depth Settings","p":["The Min/Max Depth settings provide precise control over which messages in the chat history your regex pattern will affect:","Min Depth: Only affects messages that are at least N levels deep in the chat history","0 = last message","1 = second-to-last message","etc.","When blank (set to 'Unlimited'), or -1, will also affect the message to continue on the Continue action","Max Depth: Only affects messages no deeper than N levels in the chat history","Must be greater than Min Depth for the regex to apply","System prompts and utility prompts are not affected by these settings","For example, setting Min Depth to 0 and Max Depth to 2 would only apply your regex to the three most recent messages in the chat."]},{"l":"Flags","p":["By default the Find Regex pattern is case-sensitive and applies only to the first match. To adjust this behavior, as well as other RegEx flags, you can add them like so:","Example: /yourpattern/gi will match all instances of 'yourpattern' in the text, regardless of case.","Some of the most common flags are:","i: case-insensitive","g: global (applies to all matches, not just the first)","s: dotAll (treats the input as a single line, so . will match newlines)","m: multi-line (treats the input as multiple lines, so ^ and $ match the start/end of each line, not just the whole string)","u: unicode (treats the input as unicode, so \\d, \\w, etc. will match unicode characters)","For more information on RegEx flags, see the following MDN page: Advanced searching with flags"]},{"l":"Ephemerality","p":["By default (when neither box here is checked) a RegEx script will directly edit the text values stored inside the chat's JSONL file. This ensures both the outgoing prompt and the chat display will always contain the same values. However, these changes to the chat file are irreversible.","If you do not want this to happen, you can enable either of the checkboxes here to limit the RegEx script's affects to only the display or the outgoing prompt.","If only one of the boxes is checked, there will be no changes made to the chat file, but only the checked item will be changed. This means you will be seeing one thing, but the LLM will be seeing another. Use this carefully.","If both are selected, the script will function as normal in all ways EXCEPT it will not write any changes to the chat file."]},{"l":"Advanced Use","p":["While RegEx is commonly used as a simple Find/Replace tool, it can also be used in more complex ways.","For example the 'Replace With' box could include a set of CSS rules and HTML to add a specific styled HTML element into your chat whenever a certain word is found. This will require the Show tags in responses box to be unchecked in the User Settings panel.","The script can also be set to never trigger during normal use, but could instead be triggered via slash command as part of a logic check inside an STscript. The 'Replace With' box would include a unique value the script recognizes to indicate if a logic check is true or false. This expands the utility of RegEx to the full capabilities of all slash commands, allowing for truly unlimited levels of control and automation based on the contents of the chat."]}],[{"l":"Retrieval-based Voice Conversion (RVC)","p":["This guide will walk you through using RVC, a technique that allows transferring voice features from one audio clip to another, enabling voices to speak in different tones and styles.","Ever enjoyed those famous \"Presidents Play X\" videos? They were created using RVC. With the RVC extension, you can make your SillyTavern characters speak in any voice you desire, be it anime, movie, or even your own unique voice.","RVC is NOT TTS: it's more like speech-to-speech. It takes an audio clip as its input. In the background, what RVC does is work in tandem with SillyTavern's TTS extension: it waits for TTS to generate an audio file (which TTS would've done regardless of whether you use RVC or not), then RVC will perform a second pass that takes the TTS audio file and transforms it into the cloned voice from your RVC configuration."]},{"l":"RVC Setup","p":["SillyTavern's RVC supports several API sources that perform audio conversion:","rvc-python","SillyTavern Extras(deprecated)"]},{"l":"Common prerequisites","p":["Before you begin, ensure you've met the following prerequisites."]},{"l":"ffmpeg","p":["Make sure you have ffmpeg binary in your PATH environment variable. This tool is used to convert incoming audio.","Windows:","Use the Toolbox in SillyTavern Launcher script to install ffmpeg automatically: https://github.com/SillyTavern/SillyTavern-Launcher","Or download the build here: https://www.gyan.dev/ffmpeg/builds/","How to modify PATH variable: https://www.architectryan.com/2018/03/17/add-to-the-path-on-windows-10/","To test whether you did things correctly, open a command prompt and run ffmpeg. It should print the ffmpeg version and info.","Linux:","Install ffmpeg using your package manager.","macOS:","Install ffmpeg using Homebrew:"]},{"l":"Make sure TTS is enabled and works","p":["RVC depends on TTS, you need to enable a TTS extension. Your TTS has to be already working properly and narrating your chats before you try to add RVC to the mix!","Please note, that:","System TTS engine does not support voice conversion at all.","Streaming TTS will wait for the audio stream to end before conversion."]},{"l":"Install the extension","p":["Install the \"RVC\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon)."]},{"l":"Enable RVC in SillyTavern*","p":["In SillyTavern, navigate to Extensions> RVC and enable it."]},{"l":"Pick the source","p":["In the extension settings, choose an RVC source to use. Then proceed to the source-specific installation instructions."]},{"l":"rvc-python Setup"},{"l":"1. Install the package","p":["Follow the installation instructions from the GitHub page: rvc-python Installation. It is recommended to follow CUDA installation instructions if you have an Nvidia GPU.","If you're experiencing problems when installing on Windows (e.g. building fairseq step fails), make sure the following software is installed on your PC:","Windows 10 SDK","Visual Studio Build Tools 2022"]},{"l":"2. Prepare the models","p":["Create a directory for storing RVC models. By default it is named rvc_models and is picked up from your current directory when starting up the server. Every model is a subfolder (its name will be visible in the UI) that should contain .pth(required) and .index(optional) files.","Read more: rvc-python Model Management"]},{"l":"3. Start the API server","p":["Start the API server by running the following command:","Arguments:","5050- sets a listening port for the server. Change if you want to host on a different port.","models_path- sets a path for models. Remove if you want to use the default rvc_models directory.","-l- sets the server to listen on all network interfaces. Remove to only listen on localhost."]},{"l":"4. Connect to the server","p":["In the RVC extension settings, set an appropriate rvc-python API URL. By default, it will be http://localhost:5050.","Check the Use CUDA checkbox if you have installed rvc-python to support CUDA acceleration.","Press \"Refresh\" to load a list of available voices."]},{"l":"5. Configure a voice map","p":["Voice map defines voice conversion settings for every character or user persona.","To set up a voice map, choose your character or persona name from the \"Character\" dropdown, then choose an RVC \"Voice\", then click Apply.","Optionally, you can also configure other related settings such as pitch correction or filtering.","If you did everything correctly, the Voice Map debug area will show something like 'Betty:MyVoice(rvpme)'."]},{"l":"SillyTavern Extras Setup"},{"l":"1. Prepare RVC Model Files","p":["In a file browser, navigate to: \\SillyTavern-extras\\data\\models\\rvc.","Create a subfolder like 'Betty' and place the .pth and .index files into it. (Hint: you can download voice files from https://voice-models.com, make sure the voice name says it's RVPME.)"]},{"l":"2. Install Requirements","p":["Install the necessary requirements using the command:"]},{"l":"3. Run SillyTavern-extras with RVC enabled","p":["Launch SillyTavern-extras with the RVC module enabled. This example invocation assumes you used Edge TTS which comes pre-installed with SillyTavern-extras:","Optionally, you may wish to run RVC on your GPU if you have a capable one, by adding --cuda to the startup command. Based on a quick test, VRAM usage was 3.4GB for narrating 50 tokens (~ 36 words), and 7.6GB for 200 tokens (~ 150 words)."]},{"l":"4. Set Up Voice Mapping","p":["Create a Voice map for RVC. Set your Character to your desired SillyTavern character name, and set Voice to the RVC folder you created at step 1, then click Apply. If you did things correctly, the Voice Map will show something like 'Betty:MyVoice(rvpme)'."]},{"l":"5. Select Pitch Extraction","p":["Choose \"rmvpe\" as the pitch extraction method.","If you have trouble with \"rmvpe\" try other methods (for example, \"harvest\" or \"torchcrepe\")."]},{"l":"6. (Optional) Configure RVC to save your generations to file","p":["If for testing or troubleshooting purposes you wish to save the generated RVC audio, add --rvc-save-file to your startup command. This will save the last generation under SillyTavern-extras/data/tmp/rvc_output.wav:"]},{"l":"Expression-Based Dynamic Voice"},{"l":"1. Configure RVC Models","p":["In your RVC model folder, have separate .pth and .index files for each classified expression (e.g., anger, fear, joy, love, sadness, surprise)."]},{"l":"2. Enable Modules","p":["Enable both RVC and classify modules:"]},{"l":"3. Use RVC Module","p":["The remaining setup is similar to using the RVC module alone (as explained above)."]},{"l":"Train Your Own RVC Model"},{"l":"Using RVC Easy Menu by Deffcolony (Windows Only)","p":["Automatically install and launch Mangio-RVC: https://github.com/deffcolony/rvc-easy-menu"]},{"l":"1. Clone Repository","p":["Clone the repository to your desired location:"]},{"l":"2. Launch RVC-Launcher.bat","p":["Open the RVC-Launcher.bat file.","Choose option 1 to install RVC."]},{"l":"3. Complete Installation","p":["When prompted, install required packages and dependencies."]},{"l":"4. Open WebUI for Voice Training","p":["After installation, choose option 2 to open the WebUI for voice training."]},{"l":"Mangio-RVC: Training a Voice Model","p":["1. Access Training Tab:","1. Prepare Audio:","2. Configure Experiment:","3. Process Data and Extract Features:","4. Training Parameters:","Click \"Process data\" and \"Feature extraction\".","Click \"Train feature index\" and \"Train model\".","Click on the training tab in the WebUI.","Dataset Preparation:","Ensure the audio is free of background noise – only raw voice is needed.","Enter an experiment name (e.g., my-epic-voice-model).","Longer audio makes a better output quality.","Place the audio you want to train in the datasets folder.","Set \"Save frequency\" to 50.","Set \"Total training epochs\" to 300.","Set version to v2.","WebUI Training:"]}],[{"l":"Speech Recognition","p":["This guide will walk you through setting up speech recognition to transcribe your voice into text within SillyTavern."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Make sure you're on the latest version of SillyTavern.","Install the \"Speech Recognition\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon).","Have ffmpeg binary installed. See RVC setup for more details."]},{"l":"Speech Recognition Setup (Browser)","p":["Append: Your message will be appended to the current user message text area.","Auto send: Your message will automatically be sent once the end of speech is detected.","Choose the \"Message Mode\" you want:","Choose the language you want to speak (Note: not every browser supports all languages).","Configure SillyTavern:","Enable Message Mapping(Optional):","For instance, by adding \"command delete = /del2\", the \"/del2\" command will replace your voice message when \"command delete\" is detected.","If your browser doesn't support voice recognition, an error popup will appear.","Launch SillyTavern and go to Extensions> Speech Recognition.","Recording:","Replace: Your message will replace the current user message in the text area.","Select \"Browser\" from the dropdown options.","Select Language:","Select Message Mode:","Setup phrases mapping for vocal shortcuts.","To start recording, click the microphone button to the right of the message area next to the send button. Click again to stop recording. Recording may stop automatically if no voice is detected.","Useful when combined with auto send mode for full voice control. Enable this by checking \"Enable messages mapping\"."]},{"l":"Speech Recognition Setup (Whisper/Vosk)","p":["Enable Provider:","Enable the desired speech recognition provider on the extras server using the following command:","or","You can also use a custom model by adding the option --stt-vosk-model-path or --stt-whisper-model-path with the path to the model.","Configure SillyTavern:","Launch SillyTavern and go to Extensions> Speech Recognition.","Select \"Vosk\" or \"Whisper\" from the dropdown options (whisper is more accurate).","The settings are similar to the \"Browser\" provider setup (except for language) see above."]},{"l":"Speech Recognition Setup (Streaming)","p":["Enable Provider:","Enable the streaming speech recognition module on Sillytavern-extras with the following command:","Configure SillyTavern:","(Optional) Specify a custom Whisper model as in the Whisper setup above.","(Optional but recommended) Set up trigger words in SillyTavern. Only messages starting with these trigger words will be sent to SillyTavern as actual messages. This prevents random speech or noise from being transcribed. Enable this with the checkbox. The trigger words can be included/excluded from the actual message using a checkbox.","Other settings are similar to other providers.","You're now ready to transcribe your voice into text using speech recognition in SillyTavern."]}],[{"l":"Summarize"},{"l":"What is it?","p":["This extension allows you to create, store, and utilize automatically generated summaries based on the events happening in your chats. Summarization can help with outlining general details of what is happening in the story, which could be interpreted as a long-term memory, but take that statement with a grain of salt. Since the summaries are generated by language models, the outputs may lose some important details or contain hallucinations, so you're always advised to keep track of the summary state and correct it manually if needed."]},{"l":"Common configuration","p":["The summarization extension is installed in SillyTavern by default, thus it will show up in ST's Extensions panel (stacked cubes icon) list like this:","Summarize Config Panel","Current summary- displays and provides an ability to modify the current summary. The summary is updated and embedded into the chat file's metadata for the message that was the last in context when the summary was generated. Deleting or editing a message from the chat that has a summary attached to it, will revert the state to the last valid summary.","Restore Previous- removes the current summary, rolling it back to the previous state. This is useful if the summarizer does a poor job at any given point.","Pause- check this to prevent the summary from being automatically updated. This is useful if you want to provide a custom summary of your own or to effectively disable the summary by clearing the box and stopping updates.","Popup window- allows to detach the summary into a movable UI panel on the sidebar. Useful for the desktop layout to easily have access to summarization settings without having to navigate through the extensions menu.","Injection Template- defines how the summary will be wrapped when being inserted into regular chat prompts. A special {{summary}} macro should be used to denote the exact location of the current summary state in the prompt injection text.","Injection Position- sets the location of the prompt injection. The options are the same as for Author's Notes: before or after the main prompt, or in-chat at designated depth."]},{"l":"Supported summary sources"},{"l":"Main API","p":["Summarization will be powered by your currently selected AI backend, model and settings. This method requires no additional setup, just a working API connection.","This option has the following sub-modes that differ depending on how the summary prompt is built:","Raw, blocking. The summary will be generated using nothing but the summarization prompt and the chat history. Subsequent prompts will also include the previous summary with messages that were sent after the summary was generated (see example). This mode can (and will) generate prompts that have a lot of variability between them, so it is not recommended to use it with backends that have slow prompt processing times, such as llama.cpp and its derivatives.","Raw, non-blocking. Same as above, but the chat generation will not be blocked during the summary generation. Not every backend supports simultaneous requests, so switch to blocking mode if summarization fails.","Classic, blocking. The summarization prompt will be sent at the end of your usual generation prompt, as a neutral system instruction, not omitting the character card, main prompt, example dialogues and other parts of chat prompts. This usually results in prompts that play nicely with reusing processed prompts, so it is recommended to use with llama.cpp and its siblings."]},{"l":"Summary Settings explained","p":["Summary Prompt- defines the prompt that will used for creating a summary. May include any of the known macros, as well as a special {{words}} macro (see below).","Target summary length (words)- defines the value of the {{words}} macro that can be inserted into the Summary Prompt. This setting is completely optional and has no effect at all if the macro is not used.","API response length (tokens)- allows to set an override API response length for generating summaries that are different from the globally set value.","Max messages per request (raw modes only)- set to limit the maximum number of messages that will be included in one summarization prompt. 0 means no explicit limitation, but the resulting number of messages to summarize will still depend on the maximum context size, calculated using the formula: max summary buffer = context size - summarization prompt - previous summary - response length. Use this when you want to get more focused summaries on models with large context sizes.","No WI/AN- omit World Info and Author's Note from text to be summarized. Only has an effect when using the Classic prompt builder. The Raw prompt builder always omits WI/AN.","Update every X messages- sets the interval at which the summary is generated. 0 means that the automatic summarization is disabled, but you can still trigger it manually by clicking the \"Summarize now\" button. This should be adjusted based on how quickly the prompt buffer entirely fills with chat messages. Ideally, you'd want to have the first summary generated when the messages are starting to get dropped out of the prompt.","Update every X words- same as above, but using words (not tokens!) instead of messages, theoretically can be a more accurate measurement due to how unpredictable the contents of chat messages usually are, but your mileage may vary.","If both \"Update every\" sliders are set to a non-zero value, then both will trigger summary updates at their respective intervals, depending on what happens first. It is strongly advised to update these values accordingly when you switch to another model that has differing context sizes, otherwise, the summary generation may trigger too often, or never at all.","If you're unsure about the interval settings, you can click the \"magic wand\" button above the \"Update every\" sliders to try and guess the optimal values based on some simple heuristics. A brief description of the algorithm is as follows:","Calculate token and word counts for all chat messages","Determine target summary length based on desired prompt words","Calculate the maximum number of messages that can fit in the prompt based on the average message length","If \"Max messages\" is set, adjust the average to account for messages that don't fit the summary limit","Round down the adjusted average messages per prompt to a multiple of 5"]},{"l":"Example prompts","p":["Raw prompt","Classic prompt"]},{"l":"Extras API","p":["Extras server with the summarize module could run an auxiliary summarization model (BART).","It has a very small context size (~ 1024 tokens), so its ability to handle large summaries is quite limited.","To configure the Extras summary source, do the following:","Install or Update Extras to the latest version.","Run Extras with the summarize module enabled: python server.py --enable-modules=summarize"]},{"l":"Changing Summary Model","p":["By default, Summarize uses the Qiliang/bart-large-cnn-samsum-ChatGPT_v3 model for summarization purposes.","This can be changed by using the command line argument --summarization-model=(###Hugging-Face-Model-URL-Here###)","A known alternate Summarize model is Qiliang/bart-large-cnn-samsum-ElectrifAi_v10."]}],[{"l":"TTS","p":["SillyTavern has a wide range of TTS options. This page explains the setup and use."]},{"l":"What is it?","p":["TTS is used to have a voice narrate parts of your chat."]},{"l":"Configuring TTS"},{"l":"TTS Provider Selectbox","p":["Used to select which TTS service you want to use.","ElevenLabs- paid subscription required, highest quality voices available at present.","Silero- free, runs on your PC, quality can vary widely","System- uses your OS TTS engine, if one exists. Quality can vary widely depending on the OS.","Edge- free, runs via Azure, generally quite fast, and voices feel natural but dry and emotionless. Like listening to the evening news or a radio announcer. When running with \"Plugin\" selected as the provider, you also need to install this server plugin, otherwise the TTS won't work.","Coqui-TTS- free, No API Implementation at this time. High-performance Text2Speech models (Tacotron, Tacotron2, Glow-TTS, SpeedySpeech) as well as Bark.","Novel- requires a paid NovelAI subscription, generated by NovelAI's TTS engine","RVC- free, voice cloning"]},{"l":"Checkboxes","p":["\"Good evening, senpai\"","\"Good evening, senpai\", she says.","\"nya\"... \"Good evening, senpai\"","Auto Generation- lets TTS start playing automatically when a new message enters the chat","Cohee approaches you with a faint \"nya\" \"Good evening, senpai\", she says.","Disabled","Enabled","Enabled- turns TTS playback on/off","Given the example text: *Cohee approaches you with a faint nya* Good evening, senpai, she says. Here's a table showing how the text will be modified based on the boolean states of Ignore *text, even \"quotes\", inside asterisks* and Only narrate \"quotes\":","having both \"only narrate quotes\" and \"ignore asterisks\" checkboxes both checked will result in the TTS only reading \"quotes\" which are not in asterisks, and ignoring everything else.","Ignore *text, even \"quotes\", inside asterisks*","Ignore *text, even \"quotes\", inside asterisks*- TTS will not play any text within *asterisks*, even \"quotes\" (internal variable name = narrate_dialogues_only)","Narrate only the translated text- this will make the TTS only narrate the translated text.","Only narrate \"quotes\"","Only narrate \"quotes\"- Limits TTS playback to only include text within quotation marks. This will *include quotes within asterisk lines*(internal variable name = narrate_quoted_only)","Output"]},{"l":"Sliders","p":["These will change depending on the API you select.","(explanation coming soon)"]},{"l":"Buttons","p":["Apply- this must be clicked after setting a TTS API and after editing the voice map.","Available voices- loads a popup with all voices available for your selected API, and lets you preview them with sample dialogues."]},{"l":"Using TTS","p":["Click the \"Enable\" checkbox, or nothing will ever happen.","Click the \"Auto-generation\" checkbox if you want the TTS to start automatically every time a new message arrives in chat.","Optionally, click the megaphone icon inside the top-right of any message to playback on demand.","Click the lower right \"Stop\" button (found inside the wand menu) to stop any playback."]},{"l":"Voice Map","p":["You must provide a voice map for the TTS to use, otherwise, it won't know what voices should be used for each character.","These must be in the exact format stated below:","CharacterName:TTSVoice,CharacterName2:TTSVoice2","For Coqui-TTS the format needs to include the speaker and language from the WebGUI:","CharacterName:TTSVoice[speakerid][langid] or Aqua:tts_models--multilingual--multi-dataset--your_tts\\model_file.pth[2][1]"]},{"l":"Bark ZeroShot Voice Cloning Speakers","p":["If using Bark you must create a voice folder with a voice file to clone. Ensure you add voices to homedir\\tts\\bark_v0\\speakers. On Windows it is probably C:\\Users\\USERACCOUNT\\AppData\\Local\\tts\\bark_v0\\speakers\\ type %appdata% in windows explorer then go UP a directory to local and you should see tts.","The directory should look like this:","homedir","tts","bark_v0","speakers","customvoice1","speaker.wav","speaker.npz","robinwilliams","speaker.mp3","me","One first load of this model and voice bark will clone the voice and create a .npz file, this is needed for faster TTS."]}],[{"l":"AllTalk TTS V2","p":["AllTalk is a voice cloning system based on Coqui XTTS, F5-TTS, VITS, Piper and other TTS model engines, designed to produce high-quality voice reproduction (either zero shot voice cloning or built-in voices). In AllTalk V2, significant updates enhance functionality and ease of use, including multiple TTS engine support, expanded customization, and performance optimizations. For a comprehensive list of features, refer to the AllTalk Wiki here."]},{"l":"\uD83D\uDFE9 Key Features in AllTalk V2","p":["Multi-engine Support: Easily switch between Coqui XTTS, VITS, Piper, Parler, F5, and custom engines.","Voice Conversion (RVC): Enhanced retrieval-based voice cloning pipeline.","Customizable Settings: Adjust per-engine settings and save startup configurations.","Narrator Functionality: Specify separate voices for narration and characters.","Standalone and Integrated Use: Seamless integration with SillyTavern.","DeepSpeed and Low VRAM Modes: Performance optimization for resource-limited environments.","Screenshots: See AllTalk V2’s interface here."]},{"l":"\uD83D\uDFE8 Setup and Installation Options","p":["AllTalk offers both standalone and integrated installation methods. The fastest setup involves using one of the quick installation options provided, with scripts automating most of the process.","Standalone Installation: Recommended for most users ( Standalone Guide)","Text-generation-webui Integration: For integration into Text-generation-webui ( TGWUI Installation Guide)"]},{"l":"\uD83D\uDFE9 Automated Installation","p":["This method is for Windows users only. For new users who want a quick setup, the automated installation uses the SillyTavern-Launcher. Note: This assumes you have already installed the SillyTavern-Launcher. If you haven’t, visit https://github.com/SillyTavern/SillyTavern-Launcher and follow the instructions in the readme.md file to install it. Once the SillyTavern-Launcher is installed:","Run Launcher.bat","Go to: Home Toolbox App Installer Voice Generation","Select the option labeled: Install AllTalk V2"]},{"l":"\uD83D\uDFE9 Manual Installation","p":["For advanced users requiring detailed control, follow the Manual Installation Guide for a step-by-step setup on Windows, Linux, or Mac (untested)."]},{"l":"\uD83D\uDFE9 Google Colab Installation","p":["Run AllTalk in a cloud environment with the Google Colab Installation for users who prefer not to install locally."]},{"l":"\uD83D\uDFE8 Using AllTalk within SillyTavern","p":["Once AllTalk is loaded, select it within SillyTavern on the TTS page, ensuring to select the correct AllTalk server version in the settings.","Settings Management: AllTalk may enable or disable specific settings based on your selected configuration.","Loading Sequence: If SillyTavern is loaded before AllTalk, reload the TTS extensions page.","Performance Optimization: Enable DeepSpeed and Low VRAM modes selectively to improve performance based on system resources.","Narrator function: Details of the Narrator function can be found on the AllTalk Wiki.","Full details of the SillyTavern AllTalk Extension will be updated on the AllTalk Wiki page for SillyTavern","TGWUI Users who user the AllTalk extension for TGWUI need to disable Enable TGWUI TTS in the TGWUI chat interface, otherwise you will have duplicate TTS audio generated."]},{"l":"\uD83D\uDFE8 Troubleshooting","p":["If you experience issues that you believe are specific to AllTalk within SillyTavern, please refer to the AllTalk Wiki page for SillyTavern for the lastest information."]},{"l":"\uD83D\uDFEA Support, Assistance, and Feature Requests","p":["For further assistance:","Refer to the Wiki and built-in documentation.","Join discussions on the Discussion Board.","Submit bugs or feature requests through the Issue Tracker."]}],[{"l":"XTTS with voice cloning","p":["Greetings! So, you've been blown away by those Reddit posts showcasing how far the technology went for the AI text-to-speech?","Feeling excited to give your robotic waifu/husbando a new shiny voice modulator?","Fear not, this stunning groundbreaking technology is already available at your local SillyTavern, you just need a simple..."]},{"l":"Prerequisites","p":["Latest version of SillyTavern.","Miniconda installed.","(Windows) Visual C++ Build Tools installed.","WAV files with voice clips to clone from (~ 10 seconds per file). File requirements: PCM, Mono, 22050Hz, 16-bit (convert via Audacity).","Create a folder with \"speakers\" and \"output\" subfolders. Put WAV files into \"speakers\".","Example folder structure:"]},{"l":"Installing","p":["daswer123 made an API server that runs the XTTSv2 model on your computer and connects to SillyTavern's TTS extension.","It's completely independent of Extras API and would use a separate environment.","Very important: Don't install the following requirements to your Extras environment or system Python. It will break your other packages, do unnecessary downgrades, etc.","The following instruction is provided using Miniconda, but you can also do it with venv (not covered here). Open the Anaconda command prompt and follow the instructions line by line."]},{"l":"Getting the server up and running","p":["Navigate to the folder you've created at step 4 of prerequisites.","Create a new conda env. From now on, we'll call it xtts.","Activate a newly created env.","Install Python 3.10 to your env. Confirm with \"y\" when prompted.","Install the XTTS server with its requirements.","Install PyTorch. This can take some time. The following line installs PyTorch with GPU acceleration support (CUDA). If you want to use just the CPU inference, drop the last part that starts with --index-url.","Start the XTTS server on the default host and port: http://localhost:8020","During your first startup, the model will be downloaded (about ~ 2 GB). Don't forget to read the legal notice from Coqui AI very carefully. Lol, I'm kidding, just hit \"y\" again."]},{"l":"Connecting to SillyTavern","p":["Open the extensions panel, expand the TTS menu, and pick \"XTTSv2\" in the provider list.","Choose your text-to-speech language in the Language dropdown (I'll be sad if it's not Polish).","Verify that the provider endpoint points to http://localhost:8020 and \"Available voices\" shows a list of your voice samples.","Pick any character and set a mapping between the voice sample and the character. If the characters list is empty, hit \"Reload\" a couple of times.","Configure the rest of the TTS settings according to your preferences."]},{"l":"You're all set now!","p":["Click on the bullhorn icon in the context actions menu for any message and hear the beautiful cloned voice emanating from your speakers. The generation takes some time and it's not real-time even on high-end RTX GPUs."]},{"l":"Streaming?","p":["It's possible to use HTTP streaming with the latest version of the XTTS server to get the chunks of generated audio as soon as it is available!"]},{"l":"This doesn't work with RVC!","p":["The audio will still be generated (assuming you're using the latest version of the RVC extension) and converted, but not streamed as RVC requires to have the full audio file before initiating the conversion. Streamed RVC is still being investigated..."]},{"l":"How to get streaming support?","p":["Update SillyTavern to the latest version.","Update the XTTS server to the latest version.","Start and connect XTTS to ST as usual.","Enable the \"Streaming\" XTTS extension setting in SillyTavern."]},{"l":"Choppy audio?","p":["Try increasing the \"chunk size\" setting.","For reference: with a chunk size of 200, RTX 3090 can produce uninterrupted audio at the cost of slightly increased audio latency."]},{"l":"How to restart the TTS server?","p":["Just do steps 1, 3 and 7 from the installation instruction."]},{"l":"Android??","p":["Unlikely, it can't run apps that require PyTorch without some arcane black magic that we don't provide support for. You can try it out at your own risk, but no support will be provided if you face any problems.","Your best solution is to host the TTS API on your PC over the local network, just don't forget to specify the host and port to listen on - see README."]}],[{"l":"VRM","p":["This guide will walk you through the process of setting up and customizing the VRM extension for your SillyTavern experience. This extension allows you to use VRM animated models for your character, providing a dynamic and interactive element to your virtual character."]},{"l":"Prerequisites","p":["Before you begin, ensure you've met the following prerequisites:","Branch Selection: Make sure you're using the latest version branch of SillyTavern to access the latest features and updates.","Extension Installation: Install the \"VRM\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (represented by the stacked blocks icon).","Model Folder Placement: Place your VRM model files (.vrm) into the /data/user-handle/assets/vrm/model directory and your animation files into the /data/user-handle/assets/vrm/animation directory. The currently supported animation file format are .fbx and .bvh that are compatible with VRM models. This include any animation you can get from Mixamo ( https://www.mixamo.com/) and any animation you can export from tools like XR Animator ( https://github.com/ButzYung/SystemAnimatorOnline)."]},{"l":"Extension Settings","p":["The VRM extension offers various settings to customize the behavior of your animated model. Here are the key settings:","UI global settings"]},{"l":"Global Settings","p":["Enabled:","Enable this checkbox to activate the extension, allowing your VRM model to interact within SillyTavern.","You can disable the extension if you want to use normal sprites only.","Look at camera:","Enable this checkbox to make the VRM model eyes look at the camera.","Blink:","Enable this checkbox to make the VRM model eyes blink at random intervals. Model expressions should define properly blinking weight property otherwize model can blink with closed eyes for example, if that happens either:","correct the model if you have the .vroid file","don't use that incorrect face experession","disable blinking completly with this checkbox","TTS Lip sync","Enable this checkbox to have the VRM mouth movement follow the sound of your TTS when it's played. Only work with TTS whose sound is played by Sillytavern itself like XTTS (not in streaming mode). If disabled, mouth will be animated according to the message text length when a new character message is received.","Auto-send Interaction:","Enable this checkbox to automatically trigger character interactions when you click on areas with mapped messages (refer to the hit areas section for details)."]},{"l":"Performances Settings","p":["Body hitboxes","Enable this checkbox to activate detection of click on several part of the VRM model depending on the model the following area can be detected: head/chest/hands/groin/butt/legs/feets. Hitboxes location are computed at each frames and follow the body animation, disabling this option can improve performance.","Use model cache","Enable this checkbox to keep in memory VRM model when switching models, allows to switch back to previous model faster. Usefull if you use different model for the same character to change outfit or form for example. Can affect performance.","Use animation cache","Enable this checkboxx to keep in memory all animations played during the session. All animation assigned to a model will also be loaded the first time the model appear. Will increase the time you load the model the first time but make all animation switch instant. Can affect performance."]},{"l":"Debug Settings","p":["Show grid","Enable this checkbox to visualize the 3d grid, model dragging box and body hitboxes.","Reload button","Click this button to reload the 3d scene, clear the cache and all VRM models. Use it if some bug occurs or if cache starts to hit performance."]},{"l":"Scene Settings","p":["UI scene settings","Light Color","Set the color of the light in the 3d scene. Click on the reset button to set it back to the default white color. Depending on your browser you can use a color picker, for example you can color pick the color of your background image to add more immersion.","Light intensity","Set the light intensity in percent using the slider. Click on the reset button to set it back to the default value of 100%. VRM model can react differently to light depending on the baked shaders into the model, play with the value and see how it goes.","UI model settings"]},{"l":"Character Selection","p":["These settings allow you to manage characters and assign VRM models to them.","Refresh Button:","Click the refresh button to update the list of characters in the current chat.","Select Character:","Use the drop-down list to choose a character to assign a VRM model to.","Remove Button:","Click this button to delete the assigned model for a character."]},{"l":"Model Selection","p":["Refresh Button:","Click the refresh button if your VRM model does not appear in the list.","Select Model:","Choose a model from the list to assign it to the selected character.","The model has to be located in /data/user-handle/assets/vrm/model directory.","Reset button","Click this button to reset the model settings to its default. If you have animation files that correspond to the default value they will be auto mapped. See the naming mapping at the end of this README."]},{"l":"Model Settings","p":["Model Scale:","Use the slider to adjust the size of the model, making it larger or smaller.","Model Center X/Y Offset:","Use those sliders to change the horizontal/vertical position of the model relative to the window center.","Model X/Y Rotation","Use those sliders to change the horizontal/vertical rotation of the model relative to the model hips."]},{"l":"Remarks","p":["UI hitboxes settings"]},{"l":"Hitboxes mapping","p":["UI classify settings"]},{"l":"Classified Expressions Mapping","p":["Requirements","Requires the use of the classify expression extension; otherwise, it will fallback to the default animation.","Mapping","For each detected emotion by the classify extension, you can assign an expression/motion/message. The message can contain commands."]},{"l":"Commands","p":["\"/vrmmotion idle\" or \"/vrmmotion character=Seraphina motion=idle loop=true random=false\"","/vrmexpression","/vrmlightcolor","/vrmlightintensity","/vrmmodel","/vrmmotion","arguments: character, expression","arguments: character, model","arguments: character, motion, loop, random","arguments: color","arguments: intensity","assign the vrm model to the character","change the animation of the model","change the expression of the model","example: \"/vrmexpression happy\" in solo chat or \"/vrmexpression character=Seraphina expression=happy\" in group chat","example: \"/vrmlightcolor white\" or \"/vrmlightcolor purple\".","example: \"/vrmlightintensity 0\" or \"/vrmlightintensity 100","example: \"/vrmmodel Seraphina.vrm\" in solo chat or \"/vrmmodel character=Seraphina model=Seraphina.vrm\" in group chat","set the light color","set the light intensity in percent"]},{"l":"Animations default mapping","p":["If your animation file are named in the following way they will be mapped automatically when reseting a model settings. For example the files named \"assets/vrm/animation/neutral.bvh\" and \"assets/vrm/animation/neutral1.fbx\" will be automatically mapped as a group for default and neutral classified animation. Same goes for the hitboxes.","Thank you for following this guide! Your SillyTavern experience is now enriched with animated and interactive 3D models."]},{"i":"remarks-1","l":"Remarks"}],[{"l":"Web Search","p":["Adds web search results to LLM prompts.","Some Chat Completion sources provide built-in web search functionality. In this case, this extension will be largely redundant. Check the AI Response Configuration panel for the \"Enable web search\" toggle. For example, this is available for Claude, Google AI Studio / Vertex AI, xAI, and OpenRouter backends."]},{"l":"Available sources"},{"l":"Selenium Plugin","p":["Requires an official server plugin to be installed and enabled.","See SillyTavern-WebSearch-Selenium for more details.","Supports Google and DuckDuckGo engines."]},{"l":"Extras API","p":["Requires a websearch module and Chrome/Firefox web browser installed on the host machine.","Supports Google and DuckDuckGo engines."]},{"l":"SerpApi","p":["Requires an API key.","Get the key here: https://serpapi.com/dashboard"]},{"l":"SearXNG","p":["Requires a SearXNG instance URL (either private or public). Uses HTML format for search results.","SearXNG preferences string: obtained from SearXNG - preferences - COOKIES - Copy preferences hash","Learn more: https://docs.searxng.org/"]},{"l":"Tavily AI","p":["Requires an API key.","Get the key here: https://app.tavily.com/"]},{"l":"KoboldCpp","p":["KoboldCpp URL must be provided in Text Completion API settings. KoboldCpp version must be >= 1.81.1 and WebSearch module must be enabled on startup: enable Network => Enable WebSearch in the GUI launcher or add --websearch to the command line.","See: https://github.com/LostRuins/koboldcpp/releases/tag/v1.81.1"]},{"l":"Serper","p":["Requires an API key.","Get the key here: https://serper.dev/"]},{"l":"How to use","p":["Make sure you use the latest version of SillyTavern.","Install the extension via the \"Download Extensions & Assets\" menu in SillyTavern.","Open the \"Web Search\" extension settings, set your API key or connect to Extras, and enable the extension.","The web search results will be added to the prompt organically as you chat. Only user messages trigger the search.","To include search results more organically, wrap search queries with single backticks: Tell me about the `latest Ryan Gosling movie`. will produce a search query latest Ryan Gosling movie.","Optionally, configure the settings to your liking."]},{"l":"Settings"},{"l":"General","p":["Enabled - toggles the extension on and off.","Sources = sets the search results source.","Cache Lifetime - how long (in seconds) the search results are cached for your prompt. Default = one week."]},{"l":"Prompt Settings","p":["Prompt Budget - sets the maximum capacity of the inserted text (in characters of text, NOT tokens). Rule of thumb: 1 token ~ 3-4 characters, adjust according to your model's context limits. Default = 1500 characters.","Insertion Template - how the result gets inserted into the prompt. Supports the usual macro + special macro: {{query}} for search query and {{text}} for search results.","Injection Position - where the result goes in the prompt. The same options as for the Author's Note: as in-chat injection or before/after system prompt."]},{"l":"Search Activation","p":["Use function tool - uses function calling to activate search or scrape web pages. Must use a supported Chat Completion API and be enabled in the AI Response settings. Disables all other activation methods when engaged.","Use Backticks - enables search activation using words encased in single backticks.","Use Trigger Phrases - enables search activation using trigger phrases.","Regular expressions - provide a JS-flavored regex to match the user message. If the regex matches, the search with a given query will be triggered. Search query supports `` and $1-syntax to reference the matched group. Example: /what is happening in (.*)/i regex for search query news in $1 will match a message containing what is happening in New York and trigger the search with the query news in New York.","Trigger Phrases - add phrases that will trigger the search, one by one. It can be anywhere in the message, and the query starts from the trigger word and spans to \"Max Words\" total. To exclude a specific message from processing, it must start with a period, e.g. .What do you think?. Priority of triggers: first by order in the textbox, then the first one in the user message.","Max Words - how many words are included in the search query (including the trigger phrase). Google has a limit of about 32 words per prompt. Default = 10 words."]},{"l":"Page Scraping","p":["Visit Links - text will be extracted from the visited search result pages and saved to a file attachment.","Visit Count - how many links will be visited and parsed for text.","Visit Domain Blacklist - site domains to be excluded from visiting. One per line.","File Header - file header template, inserted at the start of the text file, has an additional {{query}} macro.","Block Header - link block template, inserted with the parsed content of every link. Use {{link}} macro for page URL and {{text}} for page content.","Save Target - where to save the results of scraping. Possible options: trigger message attachments, or chat attachments of Data Bank, or just images (if the source supports them).","Include Images - attach relevant images to the chat. Requires a source that supports images (see below)."]},{"l":"More info","p":["Search results from the latest query will stay included in the prompt until the next valid query is found. If you want to ask additional questions without accidentally triggering the search, start your message with a period.","Web Search function tool always overrides other triggers if enabled and available.","Priority of triggers (if multiple are enabled):","Backticks.","Regular expressions.","Trigger phrases.","To discard all previous queries from processing, start the user message with an exclamation mark, for example, a user message !Now let's talk about... will discard this and every message above it.","This extension also provides a /websearch slash command to use in STscript. More info here: STscript Language Reference"]},{"l":"What can be included in the search result?","p":["Thesaurus:","Answer box: Direct answer to the question.","Knowledge graph: Encyclopedic knowledge about the topic.","Page snippets: Relevant extracts from the web pages.","Relevant questions: Questions and answers to similar topics.","Images: Relevant images."]},{"i":"serpapi-1","l":"SerpApi","p":["Answer box.","Knowledge graph.","Page snippets (max 10).","Relevant questions (max 10).","Images (max 10)."]},{"l":"Selenium Plugin and Extras API","p":["Google - answer box, knowledge graph, page snippets.","DuckDuckGo - page snippets.","Selenium Plugin can additionaly provide images."]},{"i":"searxng-1","l":"SearXNG","p":["Infobox.","Page snippets.","Images."]},{"i":"tavily-ai-1","l":"Tavily AI","p":["Answer.","Page contents.","Images (up to 5)."]},{"i":"koboldcpp-1","l":"KoboldCpp","p":["Page titles.","Page snippets."]},{"i":"serper-1","l":"Serper","p":["Answer box.","Knowledge graph.","Page snippets.","Relevant questions.","Images."]}],[{"l":"MiniMax TTS","p":["This page will teach you how to properly use the MiniMax TTS provider."]},{"l":"Prerequisites","p":["MiniMax account with API access","Valid API Key and Group ID from MiniMax"]},{"l":"Getting API Credentials"},{"l":"1. Create a MiniMax Account","p":["Visit the MiniMax website (International)","Click \"Sign Up\" or \"Login\"","Complete the account registration process","MiniMax has separate Chinese and International versions. Please note:","The Chinese version does not support voice cloning features","The Chinese version only supports the api.minimax.chat API host"]},{"l":"2. Obtain API Key and Group ID","p":["Log into the MiniMax console (International)","You can find your GroupId on the Basic Information page","Go to Settings → API Keys on the left sidebar to create and obtain your API Key"]},{"l":"Configuration in SillyTavern"},{"l":"1. Basic Setup","p":["Open SillyTavern","Navigate to \"Extensions\" → \"TTS\"","Select \"MiniMax\" as your TTS provider","Configure the following settings:","API Key: Your MiniMax API key","Group ID: Your MiniMax Group ID","API Host: Choose the appropriate server based on your region:","api.minimax.io(Official international server)","api.minimaxi.chat(Another international server host)","api.minimax.chat(China mainland server)"]},{"l":"2. Model Selection","p":["Available models include:","Speech-02-HD: High-quality voice synthesis (recommended)","Speech-02-Turbo: Fast voice synthesis","Speech-01: Legacy model","Speech-01-240228: Legacy model (specific version)"]},{"l":"3. Voice Parameters","p":["Adjust the following parameters to customize voice output:","Speed: 0.5 - 2.0 (1.0 = normal speed)","Volume: 0.1 - 2.0 (1.0 = normal volume)","Pitch: 0.5 - 2.0 (1.0 = normal pitch)","Audio Format: MP3, WAV, FLAC"]},{"l":"Custom Voices"},{"l":"1. Obtaining Voice IDs","p":["Access the MiniMax TTS page (International)","Click \"Voice\" on the right side to enter the Voice Selection interface","Find the voice you want to use","Click the copy button next to the voice name to copy the Voice ID"]},{"l":"2. Adding Custom Voices","p":["In the MiniMax TTS settings, locate the \"Custom Voice Management\" section","Fill in the following information:","Voice Name: Choose any name for identification","Voice ID: The voice ID obtained from the MiniMax platform","Language: Select the corresponding language for the voice","Click \"Add Custom Voice\""]},{"l":"Custom Models"},{"l":"1. Adding Custom Models","p":["In the \"Custom Model Management\" section","Fill in:","Model ID: Model identifier","Model Name: Display name for the model","Click \"Add Custom Model\""]},{"l":"2. Obtaining Model IDs","p":["Check the model list in the official MiniMax documentation","Or view available custom models in the console","Copy the corresponding Model ID"]},{"l":"Troubleshooting"},{"l":"Common Issues","p":["API Authentication Failed","Verify that the API Key corresponds to the correct API Host","Confirm that the Group ID is correct","Check if your account has sufficient balance","Voice Generation Failed","Verify that the selected Voice ID is valid","Ensure the voice is compatible with your selected model","Connection Timeout","Try switching to a different API Host","Check your network connection","Verify firewall settings","Audio Quality Issues","Try using a different model (Speech-02-HD for best quality)","Adjust voice parameters (speed, pitch, volume)","Check audio format compatibility"]}],[{"l":"Extras","p":["The Extras project was discontinued in April 2024 and won't receive any new updates or modules. The vast majority of modules are available natively in the main SillyTavern application. You may still install and use it but don't expect to get immediate support if you face any issues."]}],[{"l":"Extras Installation","p":["This page contains instructions for installing SillyTavern Extras on your local device.","The Extras project was discontinued in April 2024 and won't receive any new updates or modules. The vast majority of modules are available natively in the main SillyTavern application. You may still install and use it but don't expect to get immediate support if you face any issues.","Local installation of Extras can be difficult or impossible on your OS (especially Termux)."]},{"l":"Use the Official Extras Colab","p":["Simple to setup","Free to use","No Colab GPU credits required (use the use_cpu options)","See the Colab Guide Page for details."]},{"l":"Running Extras in Colab","p":["API key will appear in the colab's console output, for example: Your API key is fee2f3f559","Click \"Connect\"","Click the Start button on the left (looks like a triangle 'play' button)","Copy the API URL link that is listed under that line. ( DO NOT copy the 'localhost' URL, use the other one)","If you have enabled the secure option, paste the generated API key into the API Key box.","If you have NOT enabled the secure option, make sure the API Key box is completely empty when using the official colab.","It will start with the text Running on","Look for the trycloudflare.com link at the bottom of the output. Ignore the localhost link, it won't work (we tried!).","Navigate to SillyTavern's Extensions menu (click the 'stacked blocks' icon at the top of the page).","Not required, but recommended: select the secure option to generate the API key to protect your shared instance.","Open the Official Extras Colab","Paste the API URL into the box at the top. ( NOT the API Key box)","Select the desired \"Extra\" options","select use_cpu to run Extras without requiring GPU credit","Start SillyTavern with extensions support: (set enableExtensions to true in your config.yaml if necessary)","this will make Stable Diffusion slower, but everything else will run normally","Wait for it to finish loading everything"]},{"l":"Local Installation Methods"},{"l":"MiniConda (recommended)","p":["(Chads who installed SillyTavern with git to begin with can skip this step!)","(Important!) Read how to use Conda","Activate the new environment","After you have both of them installed...","cd SillyTavern-extras","Clone the Extras GitHub repo","conda activate extras(you should see (extras) pop up on the left side of your command prompt)","conda create -n extras","conda install python=3.11 git","Create a new Conda environment (let's call it extras):","git clone https://github.com/SillyTavern/SillyTavern-extras","Install Extras' requirements by using one of the following commands (will take time, again):","Install git","Install Miniconda","Install the required system packages (this will take some time)","Navigate to your cloned Extras repo","pip install -r requirements-coqui.txt- for Coqui TTS (not recommended)","pip install -r requirements-rvc.txt- for real-time voice cloning","pip install -r requirements.txt- for basic features","See below 'Running Extras After Install'","See the Common Problems page if you get errors at this step!","This method is recommended because Conda makes a 'virtual environment' for the Extras requirement packages to live inside, so they do not affect your system-wide Python setup.","Type/paste the commands below ONE BY ONE IN THE CONDA COMMAND PROMPT WINDOW and hit Enter after each one."]},{"l":"System-Wide Installation","p":["This is easier, but will affect your system-wide Python installation.","This can cause conflicts if you work with many Python programs that have different requirements.","If this is your first time touching anything Python-related, that should not be a problem.","Install Python 3.11: https://www.python.org/downloads/release/python-3115/","Install git: https://git-scm.com/downloads","Open a command prompt window and go to a folder in which you have complete access permissions.","Clone the repo: git clone https://github.com/SillyTavern/SillyTavern-extras, hit Enter.","After the clone has finished, type cd SillyTavern-extras, hit Enter.","Type python -m pip install -r requirements.txt","See below 'Running Extras After Install'"]},{"l":"Running Extras After Install"},{"l":"Confirm extensions are enabled","p":["Open the file called config.yaml in a text editor. The file is located in ST's base install folder.","Look for the line that reads enableExtensions.","Make sure that line has true, and not false."]},{"l":"Decide which module to use","p":["(This only needs to be done once)","Below is a table that describes each module.","caption","chromadb","classify","Coqui TTS","coqui-tts","Decide which modules you want to add to your Python command line.","Description","edge-tts","Example: python server.py --enable-modules=caption,summarize,classify","Extras is always started with a Python command line.","Image captioning","Microsoft Edge TTS client","Name","NOTE: There must be no spaces at all in your Python command's module list!","python server.py is the bare minimum, but it does not enable any useful modules.","Real-time voice cloning","rvc","sd","Silero TTS server","silero-tts","Stable Diffusion image generation","summarize","Text sentiment classification","Text summarization","They will be used in the next step.","This would enable Image Captioning, Chat Summary, and live updating Character Expressions.","to enable modules you must use the --enable-modules= modifier, with a comma-separated list of module names","Vector storage server"]},{"l":"Start Extras Server","p":["While still in your command prompt window inside the Extras installation folder...","Make sure your conda environment is active (if you used the Conda install method)","Type activate extras if the environment is not active.","Type python server.py --enable-modules=YOUR,SELECTED,MODULE,LIST,HERE","The extras server will load.","After a while it will show you a URL at the end. For local installs, this defaults to http://localhost:5100.","Copy the API URL."]},{"l":"Connect ST to the Extras server","p":["Start your SillyTavern server, and view the SillyTavern interface in your browser.","Open the Extensions panel (via the 'Stacked Blocks' icon at the top of the page)","Paste the API URL into the input box.","Click Connect.","To run Extras again, simply activate the environment and run these commands in a command prompt.","conda activate extras, Hit Enter. python server.py, Hit Enter.","Be sure to the additional options for server.py (see below) that your setup requires."]},{"l":"Make a .bat File for Easy Startup","p":["This is Optional and only applies to Windows, but something similar should be possible on MacOS.","View your Windows Desktop","Right-click, select New, and then click Text Document","A new file will appear on your Desktop, asking for a name.","Name the file STExtras.txt","Open the newly created file in a text editor.","Paste the following code into it:","Replace the placeholder folder path with your actual Extras install folder path.","Replace the python command line with your actual command line","Save the file with a new name STExtras.bat(Use File>> Save As in most text editors)","You can now simply double-click on this .bat file to easily start Extras.","If you ever want to change the module list (or any other command line modifiers for the extras server), simply edit the python command inside the .bat file."]},{"l":"Extras Install Common Problems","p":["This section lists common questions and problems encountered while installing SillyTavern Extras."]},{"l":"Error: Could not import the 'talkinghead' module on Linux","p":["It requires the installation of an additional package because it's not installed automatically due to incompatibility with Colab. Run this after you install other requirements:","pip install wxpython"]},{"l":"Extras server can't connect to AUTOMATIC1111's Stable Diffusion Web UI","p":["Could not connect to remote SD backend at http://127.0.0.1:7860! Disabling SD module...","Make sure webui-user.bat that you start Stable Diffusion with contains --api command line option in the COMMANDLINE_ARGS variable.","Find and replace that line in your \"webui-user.bat\": set COMMANDLINE_ARGS=--api","How it should look","If the API mode is disabled for SD Web UI, the Extras server won't be able to make a connection and you won't be able to generate images!"]},{"l":"Still doesn't work?","p":["Ensure that you start everything in the proper order, waiting for every program to finish loading before proceeding to the next step:","Stable Diffusion Web UI","SillyTavern Extras","SillyTavern","The extras server can't reconnect to the Stable Diffusion API if it was loaded after."]},{"l":"hnswlib wheel building error when installing ChromaDB","p":["ERROR: Could not build wheels for hnswlib, which is required to install pyproject.toml-based projects","Before installing the ChromaDB module you must first do one of the following:","Install Visual C++ build tools: https://visualstudio.microsoft.com/visual-cpp-build-tools/","Install the hnswlib package with conda: conda install -c conda-forge hnswlib"]},{"l":"Error when installing Python requirements on Mac","p":["ERROR: No matching distribution found for torch== 2.0.0+cu117","Mac does not support CUDA, so torch packages should be installed without CUDA support.","Install the requirements using the requirements-silicon.txt file instead."]},{"l":"Missing modules?","p":["You must specify a list of module names in your Python command line, with the --enable-modules modifier.","See Modules section."]},{"l":"What is the API Key box for?","p":["The API Key box in SillyTavern's Extensions panel is only used when you have:","created a text file named api_key.txt in your Extras install folder, which contains your chosen Extras 'password'.","started extras with the --secure commandline argument.","This makes the Extras API 'password locked', so only users who have that key in their API Key box can access it.","This is mainly useful for people who want to make their own public deployment of Extras (colab, etc).","Users running Extras on their own PC for personal use should not type anything into the API Key box."]},{"l":"What about mobile/Android/Termux? \uD83E\uDD14","p":["There are some folks in the community having success running Extras on their phones via Ubuntu on Termux.","However, Extras were not made with mobile support in mind.","No support will be provided for people running Extras on their Android devices.","Direct all your questions to the creator of the guide linked below instead."]},{"l":"❗ This is UNSUPPORTED","p":["https://rentry.org/STAI-Termux#downloading-and-running-tai-extras"]}],[{"l":"Smart Context"},{"l":"THIS EXTENSION IS NO LONGER MAINTAINED AND NOT RECOMMENDED TO USE. CONSIDER CHAT VECTORIZATION AS A POSSIBLE ALTERNATIVE.","p":["The use of this extension does not guarantee a better chatting experience or improved memory of any sort. Only use if you understand all the implications of vector database utilization."]},{"l":"What is it?","p":["Smart Context is a SillyTavern extension that uses the ChromaDB library to give your AI characters access to information that exists outside the normal chat history context limit."]},{"l":"How is that useful?","p":["If you have a very long chat, the majority of the contents are outside the usual context window and thus unavailable to the AI when it comes to writing a response.","Smart Context automatically takes the entire history of the chat file and puts it into a vector database. This database is then searched each time you input something new into the chat, and if messages with matching keywords are found, those chat messages are placed into the context so the AI can see them when writing its next reply."]},{"l":"Setup Instructions","p":["Update SillyTavern to at least version 1.10.6.","Install the \"Smart Context\" extension from the \"Download Extensions & Assets\" menu in the Extensions panel (stacked blocks icon).","Install or Update Extras to the latest version. Alternatively, use the Colab notebook.","Local installs only: Install requirements-complete.txt for Extras (even if you did it once before in a prior install).","Run Extras with the chromadb module enabled: python server.py --enable-modules=chromadb"]},{"l":"Getting an error when installing ChromaDB?","p":["Installing chromadb package requires one of the following:","Have Visual C++ build tools installed: https://visualstudio.microsoft.com/visual-cpp-build-tools/","Installing hnswlib from conda: conda install -c conda-forge hnswlib"]},{"l":"Configuration","p":["Once Smart Context is enabled, you should configure it in the SillyTavern UI. Smart Context configuration can be done from within the Extensions menu STExtensionMenuIcon","Smart Context Config Panel","There are 4 main concepts to be aware of:","Chat History Preservation","Memory Injection Amount","Individual Memory Length","Injection Strategy"]},{"l":"SmartContext only starts after 10 mesages are in the chat history","p":["At the start of a new chat, ChromaDB is inactive.","Once the chat has accumulated 10 messages, it will begin recording all messages into the database, and recalling messages as needed."]},{"l":"Chat History Preservation ('kept mesages')","p":["By default, ChromaDB will keep as many recent natural chat history messages as specified in the slider. Any messages beyond this amount will be removed from your sent prompt, and if 'memories' exist in the database they will be added in place of the older chat history messages (see Strategy below)."]},{"l":"Memory Injection Amount","p":["The maximum number of 'memories' Smart Context will insert into the context. Not every injection attempt will get this full amount. If you send an input related to 'dogs' and only one other message in the DB is related to dogs, then only 1 item will be inserted."]},{"l":"Individual Memory Length","p":["This is the maximum length allowed for each injected 'memory'. This is in CHARACTERS(not tokens). If set too small, the memory could be cut off midway.","Example:","Ross: I like dogs with long fur and fluffy tails. I dislike dogs with short fur and short tails.","This database 'memory' is 103 characters long, so you would need to set the slider to at least 103 in order to pull it entirely into the context.","If the slider is less than 103, the message would be cut off and injected like that."]},{"l":"Injection Strategy"},{"l":"Replace oldest history","p":["This strategy keeps X recent messages, removes all message before that, and replaces them with 'memories'.","Advantage","less likely to overflow your context limit","memories existing near the top of the context will have less immediate impact on the response while still providing 'background information'.","Disadvantage","old messages are inserted directly into the chat history with no special demarcation, and usually have no immediate natural relevance to the preserved natural chat history messages. This can confuse less intelligent AI models."]},{"l":"Add to Bottom","p":["This strategy leaves the chat history in its natural state and adds 'memories' after it inside a formatted [bracket header]. This means the 'kept messages' sliders is effectively disabled.","Advantage","does not shorten or alter the current natural chat history","'memories' exist after chat and have a stronger impact on the next AI response","Disadvantage","because no chat items are being removed/replaced, there is a higher chance you will overflow your context limit.","because the memories exist very close to the end of the prompt they can have TOO MUCH effect on the AI's response."]},{"l":"Custom Depth","p":["This strategy leaves the chat history in its natural state and adds 'memories' at the depth you determine within the template you specify. This means the 'kept messages' slider is effectively disabled. The custom injection message should include the `` template word which is where all queried memories will be placed.","Advantage","flexibility to experiment with memory placement","customizable introductions to memory within context","Disadvantage","because no chat items are being removed/replaced, there is a higher chance you will overflow your context limit."]},{"l":"Use % Strategy","p":["Note: This is not compatible with the 'Add to Bottom' strategy, which does not remove any messages at all.","While using the 'Replace Oldest History' strategy, checking this box will enable the slider for selecting a percentage of the in-context chat history to replace with SmartContext memories. It will also disable the two sliders for manually selecting the number of messages.","This strategy automatically calculates a percentage of the chat history to be replaced with SmartContext memories, instead of a fixed number of messages.","Advantage","easier than manually calculating the number of messages yourself","adjusts with the available context size, applying the same percentage to small and large prompt spaces","Disadvantage","calculations for how much history to remove can be slightly innacurate as they are based on estimated tokens per message","it rounds the number of messages to remove to the nearest number divisible by 5 (0, 5, 10, 15, 20, etc), so it is not as fine grained as manual numeric selection."]},{"l":"Memory Recall Strategy"},{"l":"Recall only from this chat","p":["This is the default behavior of smart-context and pulls 'memories' only from the ChromaDB collection for this specific chat."]},{"l":"Recall from all character chats","p":["This is an experimental behavior of smart-context which pulls 'memories' from all ChromaDB collections for the selected character. Hypothetically this should allow for the development of a more robust memory set spanning many interactions. Reccomended that this be used with 'Add to Bottom' or 'Custom Depth' strategies and 'kept messages' set to a low number so that ChromaDB will pull from memory sooner."]},{"l":"Using Smart Context","p":["Once it is enabled and configured, Smart Context happens automatically.","ChromaDB makes a new database for each chat that is opened inside SillyTavern. This database is automatically filled with the entire chat history.","You can also manually insert text files into the database.","These text files do not have to be chats. They can be anything (wikipedia entries, fanfic, etc)."]},{"l":"Purging the Database","p":["You can use the 'Purge DB' button to clear the database for the current chat.","This can be helpful if you find inaccurate memories have been stored (such as chat message you have since deleted or edited)."]},{"l":"FAQ"},{"l":"What happens to the databases when I'm done chatting? Can I save them?","p":["For locally installed Extras servers, Smart Context saves the databases. There is no need to save them manually in usual use cases.","For colab users, the databases are wiped when the extras server shuts down. Use the export button to save the database as a JSON file, and import it next time you want to use it.","Usually there is no need to save Smart Context databases.","Currently we have an Import/Export feature, which allows you to save the chat's DB and use it again at a later date."]},{"l":"Can I make one big database for all of my chats to reference?","p":["This would not be a good use of Smart Context's capabilities. We recommend using World Info for this purpose."]}],[{"l":"talkinghead","p":["THE SUPPORT FOR TALKGINHEAD WAS DROPPED IN SILLYTAVERN 1.12.13. THIS PAGE IS KEPT FOR HISTORICAL PURPOSES."]},{"l":"What is it?","p":["An implementation of Talking Head Anime 3 Demo for AITuber. It possesses the following features:","Generates random Live 2D-like motion actions from a single static image.","Lip-syncs to the sound output from any TTS output.","This extension contains the original demo programs for the Talking Head(?) Anime from a Single Image 3: Now the Body Too project. As the name implies, the project allows you to animate anime characters, and you only need a single image of that character to do so. There are two demo programs:","The manual_poser lets you manipulate a character's facial expression, head rotation, body rotation, and chest expansion due to breathing through a graphical user interface, so you can save them as default expressions IE Happy, sad, joy, etc. ifacialmocap_puppeteer lets you transfer your facial motion to an anime character."]},{"l":"Hardware Requirements","p":["You can use either CPU or GPU Modes (CPU is default). However, in CPU mode expect about 1 FPS, and in GPU mode on an RTX3060 I am getting about 9-10 FPS.","The ifacialmocap_puppeteer requires an iOS device that is capable of computing blend shape parameters from a video feed. This means that the device must be able to run iOS 11.0 or higher and must have a TrueDepth front-facing camera. (See this page for more info.) In other words, if you have the iPhone X or something better, you should be all set."]},{"l":"How to use","p":["You must launch extras with the following modules for talkinghead to work: classify and talkinghead! classify is required for the handling of the talkinghead.png file. Additionally, you may also use --talkinghead-gpu to load the blend models into GPU memory and make the animations 10x faster. It is highly recommended to use GPU acceleration! By default, once the program starts it will load a default image SillyTavern-extras\\talkinghead\\tha3\\images\\lambda_00.png. You can verify it is working by going to http://localhost:5100/api/talkinghead/result_feed or YOUR EXT URL:PORT/api/talkinghead/result_feed.","Once the server has started go to the Extension API tab and connect. Then simply select a character card to load. (--enable-modules=classify,talkinghead --talkinghead-gpu when starting server.py)","Now select the Character Expressions, if you check the image type talkinghead box the script will replace your current character expression with the result of YOUR EXT URL:PORT/api/talkinghead/result_feed unchecking the box SHOULD return the image back to the original expression, however sometimes you have to send a new message to the chat to \"reload\" the image.","If you do not have a talkinghead.png file in the character directory it will simply show either the default image or the last character card that had a talkinghead.png file. The animation source image is changed when the character card is changed.","Now open the character expressions scroll down to the talkinghead image and upload an image file that meets the requirements in the section below called \"Constraints on Input Images\".","Then check and uncheck the talkinghead box to reload the character. If the image is funny looking it is probably because it is not transparent / has no alpha layer. Otherwise, follow the instructions and template below."]},{"l":"Constraints on Input Images","p":["In order for the system to work well, the input image must obey the following constraints:","It should be of resolution 512 x 512. (If the program receives an input image of any other size, it will resize the image to this resolution and also output at this resolution.) It must have an alpha channel. It must contain only one humanoid character. The character should be standing upright and facing forward. The character's hands should be below and far from the head. The head of the character should roughly be contained in the 128 x 128 box in the middle of the top half of the image. The alpha channels of all pixels that do not belong to the character (i.e., background pixels) must be 0.","Input Constraints"]},{"l":"ADVANCED SECTION"},{"l":"Python Environment","p":["In addition to the base feature (app.py), both manual_poser and ifacialmocap_puppeteer are available as desktop applications. To run them, you need to set up an environment for running programs written in the Python language. The environment needs to have the following software packages:","Python >= 3.8","PyTorch >= 1.11.0 with CUDA support","SciPY >= 1.7.3","wxPython >= 4.1.1","Matplotlib >= 3.5.1","One way to do so is to install Anaconda and run the following commands in your shell:","conda create -n talking-head-anime-3-demo python=3.8 conda activate talking-head-anime-3-demo conda install pytorch torchvision torchaudio cudatoolkit=11.3 -c pytorch conda install scipy pip install wxpython conda install matplotlib"]},{"l":"Additional Blend Models","p":["There is only one (lightest) model included, if you want the additional blend models you need to download the model files from https://www.dropbox.com/s/y7b8jl4n2euv8xe/talking-head-anime-3-models.zip?dl=0 and unzip it to the SillyTavern-extras\\talkinghead\\tha3\\models folder. In the end, the data folder should look like:","tha3","models","separable_float","editor.pt","eyebrow_decomposer.pt","eyebrow_morphing_combiner.pt","face_morpher.pt","two_algo_face_body_rotator.pt","separable_half","standard_float","standard_half","The model files are distributed with the Creative Commons Attribution 4.0 International License, which means that you can use them for commercial purposes. However, Pramook Khungurn. Talking Head(?) Anime from a Single Image 3: Now the Body Too. https://github.com/pkhungurn/talking-head-anime-3-demo, is the creator."]},{"l":"Running the manual_poser Desktop Application","p":["Open a shell. Change your working directory to the repository's root directory. Then, run:","python tha3/app/manual_poser.py Note that before running the command above, you might have to activate the Python environment that contains the required packages.","conda activate extras if you have not already activated the environment."]}],[{"l":"Development and Automation","p":["SillyTavern's default package only provides a barebones platform that can be extended in a multitude of ways.","STscript","STscript is a powerful scripting language based on batched chat commands that can be approached without any prior coding knowledge.","Function Calling","Add more dynamic capabilities by letting the LLM use external sources of data or trigger specific functionality of the extension.","UI Extensions","UI extensions run in a browser environment and expand the functionality of SillyTavern by hooking into its events and API.","Server Plugins","Server plugins allow adding functionality such as new API endpoints by running code in the NodeJS environment.","Internationalization (i18n)","Learn how to translate SillTavern's UI into your language."]}],[{"l":"STscript Language Reference"},{"l":"What is STscript?","p":["It's a simple yet powerful scripting language that could be used to expand the functionality of SillyTavern without serious coding, allowing you to:","Create mini-games or speed run challenges","Build AI-powered chat insights","Unleash your creativity and share with others","STscript is built using the slash commands engine, utilizing command batching, data piping, macros, and variables. These concepts are going to be described in the following document."]},{"l":"Security precaution","p":["With great power comes great responsibility. Be careful and always inspect the scripts before executing them."]},{"l":"Hello, World!","p":["To run your first script, open any SillyTavern chat and type the following into the chat input bar:","Hello World","You should see the message in the toast on top of the screen. Now let's break it down bit by bit.","A script is a batch of commands, each one starting with the slash, with or without named and unnamed arguments, and terminated with the command separator character: |.","Commands are executed sequentially, one after another, and transfer data between each other.","The /pass command accepts a constant value of \"Hello, World!\" as an unnamed argument and writes it to the pipe.","The /echo command receives the value through the pipe from the previous command and displays it as a toast notification.","Hint: To see a list of all available commands, type /help slash into the chat.","As constant unnamed arguments and pipes are interchangeable, we could rewrite this script simply as:"]},{"l":"User input","p":["Now let's add a little bit of interactivity to the script. We will accept the input value from the user and display it in the notification.","The /input command is used to display an input box with the prompt specified in the unnamed argument and then writes the output to the pipe.","Because /echo already has an unnamed argument that sets the template for the output, we use the {{pipe}} macro to specify a place where the pipe value will be rendered.","Slim Shady Input","Slim Shady Output"]},{"l":"Other input/output commands","p":["/popup (text)— shows a blocking popup, supports lite HTML formatting, e.g: /popup font color=redI'm red!/font.","/setinput (text)— replaces the contents of the user input bar with the provided text.","/speak voice=name (text)— narrates the text using the selected TTS engine and the character name from the voice map, e.g. /speak name=Donald Duck Quack!.","/buttons labels=[a,b] (text)— shows a blocking popup with the specified text and button labels. labels must be a JSON-serialized array of strings or a variable name containing such an array. Returns the clicked button label into the pipe or empty string if canceled. The text supports lite HTML formatting."]},{"l":"Arguments for /popup and /input","p":["/popup and /input support the following additional named arguments:","large=on/off- increases the vertical size of the popup. Default: off.","wide=on/off- increases the horizontal size of the popup. Default: off.","okButton=string- adds ability to customize the text on the \"Ok\" button. Default: Ok.","rows=number- (only for /input) increases the size of the input control. Default: 1.","Example:"]},{"l":"Arguments for /echo","p":["/echo supports the following values for the additional severity argument that sets the style of the displayed message.","warning","error","info(default)","success","Example:"]},{"l":"Variables","p":["/addglobalvar key=name or {{addglobalvar::name:increment}}— adds the increment to the value of the global variable.","/addvar key=name increment or {{addvar::name::increment}}— adds the increment to the value of the local variable.","/decglobalvar name or {{decglobalvar::name}}— decrements a value of the global variable by 1.","/decvar name or {{decvar::name}}— decrements a value of the local variable by 1.","/flushglobalvar name— deletes the value of the global variable.","/flushvar name— deletes the value of the local variable.","/getglobalvar name or {{getglobalvar::name}}— gets the value of the global variable.","/getvar name or {{getvar::name}}— gets the value of the local variable.","/incglobalvar name or {{incglobalvar::name}}— increments a value of the global variable by 1.","/incvar name or {{incvar::name}}— increments a value of the local variable by 1.","/setglobalvar key=name or {{setglobalvar::name::value}}— sets the value of the global variable.","/setvar key=name value or {{setvar::name::value}}— sets the value of the local variable.","All slash commands for variable manipulation write the resulting value into the pipe for the next command to use.","For macros, only the \"get\", \"inc\", and \"dec\" type macro returns the value, \"add\" and \"set\" are replaced with an empty string instead.","Global variables — saved to the settings.json and exist everywhere across the app.","If a command argument accepts a variable name and both local and global variables exist with the same name, then the local variable takes priority.","Increment in the /addvar command performs an addition or subtraction of the value if both increment and the variable value can be converted to a number, or otherwise does the string concatenation.","Local variables — saved to the metadata of the current chat, and unique to it.","Now, let's consider the following example:","Since the variables are saved and not flushed between the script executions, you can reference the variable in other scripts and via macros, and it will resolve to the same value as during the execution of the example script. To guarantee that the value will be discarded, add the /flushvar command to the script.","The default value of previously undefined variables is an empty string or a zero of it is first used in the /addvar, /incvar, /decvar command.","The getvar command is used to retrieve the value of the variable and pass it through the pipe.","The getvar macro is used to display the value in the /echo command.","The value is passed to the /imagine command (provided by the Image Generation plugin) to be used as its input prompt.","The value of the user input is saved in the local variable named SDinput.","Variables are used to store and manipulate data in scripts, using either commands or macros. The variables could be one of the following types:"]},{"l":"Arrays and objects","p":["Variable values can contain JSON-serialized arrays or key-value pairs (objects).","Examples:","Array: [apple,banana,orange]","Object: {fruits:[apple,banana,orange]}","The following modifications can be applied to commands to work with these variables:","/len commands gets a number of items in the array.","index=number/string named argument can be added /getvar or /setvar and their global counterparts to get or set sub-values by either a zero-based index for arrays or a string key for objects.","If a numeric index is used on a nonexistent variable, the variable will be created as an empty array [].","If a string index is used on a nonexistent variable, the variable will be created as an empty object {}.","/addvar and /addglobalvar commands support pushing a new value to array-typed variables."]},{"l":"Flow control - conditionals","p":["You can use the /if command to create conditional expressions that branch the execution based on the defined rules.","Note that","syntax is also supported, however {: closures :} will help you write cleaner scripts.","Let's review the following example:","This script evaluates the user input against a required value and displays different messages, depending on the input value."]},{"l":"Arguments for /if","p":["left is the first operand. Let's call it A.","right is the second operand. Let's call it B.","rule is the operation to be applied to the operands.","else is the optional string of subcommands to be executed if the result of boolean comparison is false.","Unnamed argument is the subcommand to be executed if the result of boolean comparison is true.","The operand values are evaluated in the following order:","Numeric literals","Local variable names","Global variable names","String literals","String values of named arguments could be escaped with quotes to allow multi-word strings. Quotes are then discarded."]},{"l":"Boolean operations","p":["Supported rules for boolean comparison are the following. An operation applied to the operands results in either a true or false value.","eq(equals) => A = B","neq(not equals) => A != B","lt(less than) => A < B","gt(greater than) => A > B","lte(less than or equals) => A <= B","gte(greater than or equals) => A >= B","not(unary negation) => !A","in(includes substring) => A includes B, case insensitive","nin(not includes substring) => A not includes B, case insensitive"]},{"l":"Subcommands","p":["A subcommand is a string containing a list of slash commands to execute.","To use command batching in subcommands, the command separator character should be escaped (see below).","Since macro values are executed when the conditional is entered, not when the subcommand is executed, a macro could be additionally escaped to delay their evaluation to the subcommand execution time.","The result of the subcommands execution is piped to the command after /if.","The /abort command interrupts the script execution when encountered.","/if commands can be used as a ternary operator. The following example will pass a \"true\" string to the next command the variable a equals 5, and a \"false\" string otherwise."]},{"l":"Escape Sequences"},{"l":"Macros","p":["Escaping of macros works just like before. However, with closures, you will need to escape macros a lot less often than before. Either escape the two opening curly braces, or both the opening and closing pair."]},{"l":"Pipes","p":["Pipes don't need to be escaped in closures (when used as command separators). Everywhere where you want to use a literal pipe character instead of a command separator, you need to escape it.","With the parser flag STRICT_ESCAPING you don't need to escape pipes in quoted values."]},{"l":"Quotes","p":["To use a literal quote-character inside a quoted value, the character must be escaped."]},{"l":"Spaces","p":["To use space in the value of a named argument, you either have to surround the value in quote, or escape the space character."]},{"l":"Closure Delimiters","p":["If you want to use the character combinations used to mark the beginning or end of a closure, you have to escape the sequence with a single backslash."]},{"l":"Pipe Breakers","p":["To prevent the previous command's output from being automatically injected as the unnamed argument into the next command, put double pipes between the two commands."]},{"l":"Closures","p":["Closures (block statements, lambdas, anonymous functions, whatever you want to call them) are a series of commands wrapped between {: and :}, that are only evaluated once that part of the code is executed."]},{"l":"Sub-Commands","p":["Closures make using sub-commands a lot easier and get rid of the need to escape pipes and macros."]},{"l":"Scopes","p":["Closures have their own scope and support scoped variables. Scoped variables are declared with /let, their values set and retrieved with /var. Another way to get a scoped variable is the {{var::}} macro.","Within a closure, you have access to all variables declared within that same closure or in one of its ancestors. You don't have access to variables declared in a closure's descendants. If a variable is declared with the same name as a variable that was declared in one of the closure's ancestors, you don't have access to the ancestor variable in this closure and its descendants."]},{"l":"Named Closures","p":["Closures can be assigned to variables (only scoped variables) to be called at a later point or to be used as sub-commands.","/: can also be used to execute Quick Replies, as it is just a shorthand for /run."]},{"l":"Closure Arguments","p":["Named closures can take named arguments, just like slash commands. The arguments can have default values."]},{"l":"Closures and Piped Arguments","p":["The piped value from a parent closure will not be automatically injected into the first command of a child closure. You can still explicitly reference the parent's piped value with {{pipe}}, but if you leave the unnamed argument of the first command inside a closure blank, the value will not be automatically injected."]},{"l":"Immediately Executed Closures","p":["Closures can be immediately executed, meaning they will be replaced with their return value. This is helpful in places where no explicit support for closures exists, and to shorten some commands that would otherwise require a lot of intermediate variables.","In addition to running named closures saved inside scoped variables, the /run command can also be used to execute closures immediately."]},{"l":"Comments","p":["A comment is a human-readable explanation or annotation in the script code. Comments don't break pipes."]},{"l":"Block Comments","p":["Block comments can be used to quickly comment out multiple commands at once. They will not terminate on a pipe."]},{"l":"Flow Control"},{"l":"Loops: /while and /times","p":["If you need to run some command in a loop until a certain condition is met, use the /while command.","On each step of the loop it compares the value of variable A with the value of variable B, and if the condition yields true, then executes any valid slash command enclosed in quotes, otherwise exists the loop. This command doesn't write anything to the output pipe."]},{"l":"Arguments for /while","p":["The set of available boolean comparisons, handing of variables, literal values, and subcommands is the same as for the /if command.","The optional guard named argument ( on by default) is used to protect against endless loops, limiting the number of iterations to 100. To disable and allow endless loops, set guard=off.","This example adds 1 to the value of i until it reaches 10, then outputs the resulting value (10 in this case)."]},{"l":"Arguments for /times","p":["Runs a subcommand a specified number of times.","/times (repeats) (command)– any valid slash command enclosed in quotes repeats a number of times, e.g. /setvar key=i 1 | /times 5 /addvar key=i 1 adds 1 to the value of \"i\" 5 times.","{{timesIndex}} is replaced with the iteration number (zero-based), e.g. /times 4 {:/echo {{timesIndex}}:} echoes the numbers 0 through 4.","Loops are limited to 100 iterations by default, pass guard=off to disable."]},{"l":"Breaking out of Loops and Closures","p":["The /break command can be used to break out of a loop (/while or /times) or a closure early. The unnamed argument of /break can be used to pass a value different from the current pipe along./break is currently implemented in the following commands:","/while- exits the loop early","/times- exits the loop early","/run(with a closure or closure via variable) - exits the closure early","/:(with a closure) - exits the closure early"]},{"l":"Math operations","p":["/abs (a)– performs an absolute value operation of a value, e.g. /abs -10","/add (a b c d)– performs an addition of the set of values, e.g. /add 10 i 30 j","/cos (a)– performs a cosine operation of a value, e.g. /cos i","/div (a b)– performs a division of two values, e.g. /div 10 i","/log (a)– performs a natural logarithm operation of a value, e.g. /log i","/max (a b c d)– returns a maximum from the set of values, e.g. /max 1 0 4 k","/min (a b c d)– return a minimum from the set of values, e.g. /min 5 4 i 2","/mod (a b)– performs a modulo operation of two values, e.g. /mod i 2","/mul (a b c d)– performs a multiplication of the set of values, e.g. /mul 10 i 30 j","/pow (a b)– performs a power operation of two values, e.g. /pow i 2","/rand (round=round|ceil|floor from=number=0 to=number=1)– returns a random number between from and to, e.g. /rand or /rand 10 or /rand from=5 to=10. Ranges are inclusive. The returned value will contain a fractional part. Use round named argument to get an integral value, e.g. /rand round=ceil to round up, round=floor to round down, and round=round to round to nearest.","/round (a)– performs a rounding to the nearest integer operation of a value, e.g. /round 3.14","/sin (a)– performs a sine operation of a value, e.g. /sin i","/sqrt (a)– performs a square root operation of a value, e.g. /sqrt 9","/sub (a b)– performs a subtraction of two values, e.g. /sub i 5","All of the following operations accept a series of numbers or variable names and output the result to the pipe.","Invalid operations (such as division by zero), and operations that result in a NaN value or infinity return zero.","List of operations:","Multiplication, addition, minimum and maximum accept an unlimited number of arguments separated by spaces.","Sine, cosine, natural logarithm, square root, absolute value, and rounding accept one argument.","Subtraction, division, exponentiation, and modulo accept two arguments separated by spaces."]},{"l":"Example 1: get an area of a circle with a radius of 50."},{"l":"Example 2: calculate a factorial of 5."},{"l":"Using the LLM","p":["Scripts can make requests to your currently connected LLM API using the following commands:","/gen (prompt)— generates text using the provided prompt for the selected character and including chat messages.","/genraw (prompt)— generates text using just the provided prompt, ignoring the current character and chat.","/trigger— triggers a normal generation (equivalent to clicking a \"Send\" button). If in group chat, you can optionally provide a 1-based group member index or a character name to have them reply, otherwise triggers a group round according to the group settings."]},{"l":"Arguments for /gen and /genraw","p":["lock— can be on or off. Specifies whether a user input should be blocked while the generation is in progress. Default: off.","stop— JSON-serialized array of strings. Adds a custom stop string (if the API supports it) just for this generation. Default: none.","instruct(only /genraw) — can be on or off. Allows to use instruct formatting on the input prompt (if instruct mode is enabled and the API supports it). Set to off to force pure prompts. Default: on.","as(for Text Completion APIs) — can be system(default) or char. Defines how the last prompt line will be formatted. char will use a character name, system will use no or neutral name.","The generated text is then passed through the pipe to the next command and can be saved to a variable or displaced using the I/O capabilities:","Cthulhu Says","or to insert the generated message as a response from your character:"]},{"l":"Temporal character","p":["If you are not in a group chat, scripts may temporarily make a request to the currently connected LLM as a different character.","/ask (prompt)— generates text using the provided prompt for a specified character and including chat messages. Please note that swipes of the response from this character will revert back to the current character."]},{"l":"Arguments for /ask","p":["name— Required. The name of the character to ask (or a unique character identifier, such as an avatar key). This must be provided as a named argument.","return— Specifies how the return value should be provided. Defaults to pipe(output via the command pipe). Other options can be specified if supported by the API."]},{"l":"Prompt injections","p":["Scripts can add custom LLM prompt injections, making it essentially an equivalent of unlimited Author's Notes.","/inject (text)— inserts any text into the normal LLM prompt for the current chat, and requires a unique identifier. Saved to chat metadata.","/listinjects— shows a list of all prompt injections added by scripts for the current chat in a system message.","/flushinjects— deletes all prompt injections added by scripts for the current chat.","/note (text)— sets the Author's Note value for the current chat. Saved to chat metadata.","/interval— sets the Author's Note insertion interval for the current chat.","/depth— sets the Author's Note insertion depth for the in-chat position.","/position— sets the Author's Note position for the current chat."]},{"l":"Arguments for /inject","p":["id— an identifier string or a reference to a variable. Consequent calls of /inject with the same ID will overwrite the previous text injection. Required argument.","position— sets a position for the injection. Default: after. Possible values:","after: after the main prompt.","before: before main prompt.","chat: in-chat.","depth— sets an injection depth for the in-chat position. 0 means insertion after the last message, 1 - before the last message, etc. Default: 4.","Unnamed argument is a text to be injected. An empty string will unset the previous value for the provided identifier."]},{"l":"Access chat messages"},{"l":"Read messages","p":["You can access messages in the currently selected chat using the /messages command.","The names argument is used to specify whether you want to include character names or not, default: on.","In an unnamed argument, it accepts a message index or range in the start-finish format. Ranges are inclusive!","If the range is unsatisfiable, i.e. an invalid index or more messages than exist are requested, then an empty string is returned.","Messages that are hidden from the prompt (denoted by the ghost icon) are excluded from the output.","If you want to know the index of the latest message, use the {{lastMessageId}} macro, and {{lastMessage}} will get you the message itself.","To calculate the start index for a range, for example, when you need to get the last N messages, use variable subtraction. This example will get you 3 last messages in the chat:"]},{"l":"Send messages","p":["A script can send messages as either a user, character, persona, neutral narrator, or add comments.","/send (text)— adds a message as the currently selected persona.","/sendas name=charname (text)— adds a message as any character, matching by their name. name argument is required. Use the {{char}} macro to send as the current character.","/sys (text)— adds a message from the neutral narrator that doesn't belong to the user or character. The displayed name is purely cosmetic and can be customized with the /sysname command.","/comment (text)— adds a hidden comment that is displayed in the chat but is not visible to the prompt.","/addswipe (text)— adds a swipe to the last character message. Can't add a swipe to the user or hidden messages.","/hide (message id or range)— hides one or several messages from the prompt based on the provided message index or inclusive range in the start-finish format.","/unhide (message id or range)— returns one or several messages to the prompt based on the provided message index or inclusive range in the start-finish format.","/send, /sendas, /sys, and /comment commands optionally accept a named argument at with a zero-based numeric value (or a variable name that contains such a value) that specifies an exact position of message insertion. By default new messages are inserted at the end of the chat log.","This will insert a user message at the beginning of the conversation history:"]},{"l":"Delete messages","p":["These commands are potentially destructive and have no \"undo\" function. Check the /backups/ folder if you accidentally deleted something important.","/cut (message id or range)— cuts one or several messages from the chat based on the provided message index or inclusive range in the start-finish format.","/del (number)— deletes last N messages from the chat.","/delswipe (1-based swipe id)— deletes a swipe from the last character message based on the provided 1-based swipe ID.","/delname (character name)— deletes all messages in the current chat that belong to a character with the specified name.","/delchat— deletes the current chat."]},{"l":"World Info commands","p":["World Info (also known as Lorebook) is a highly utilitarian tool for dynamically inserting data into the prompt. See the dedicated page for more detailed explanation: World Info.","/getchatbook– gets a name of the chat-bound World Info file or create a new one if was unbound, and pass it down the pipe.","/findentry file=bookName field=fieldName [text]– finds a UID of the record from the specified file (or a variable pointing to a file name) using fuzzy matching of a field value with the provided text (default field: key) and passes the UID down the pipe, e.g. /findentry file=chatLore field=key Shadowfang.","/getentryfield file=bookName field=field [UID]– gets a field value (default field: content) of the record with the UID from the specified World Info file (or a variable pointing to a file name) and passes the value down the pipe, e.g. /getentryfield file=chatLore field=content 123.","/setentryfield file=bookName uid=UID field=field [text]– sets a field value (default field: content) of the record with the UID (or a variable pointing to UID) from the specified World Info file (or a variable pointing to a file name). To set multiple values for key fields, use a comma-delimited list as a text value, e.g. /setentryfield file=chatLore uid=123 field=key Shadowfang,sword,weapon.","/createentry file=bookName key=keyValue [content text]– creates a new record in the specified file (or a variable pointing to a file name) with the key and content (both of these arguments are optional) and passes the UID down the pipe, e.g. /createentry file=chatLore key=Shadowfang The sword of the king."]},{"l":"Valid entry fields","p":["(see below)","0 = AND ANY","0 = before main prompt","0 = System","1 = after main prompt","1 = NOT ALL","1 = User","2 = Assistant","2 = NOT ANY","2 = top of Author's Note","3 = AND ALL","3 = bottom of Author's Note","4 = in-chat at depth","5 = top of example messages","6 = bottom of example messages","Automation ID","automationId","Boolean (1/0)","Case-Sensitive","caseSensitive","Character Filter Exclude Mode","Character Filter Names","Character Filter Tags","characterFilterExclude","characterFilterNames","characterFilterTags","comment","constant","Constant Status","content","depth","Depth Role","disable","Disabled Status","excludeRecursion","Field","group","Group Scoring","groupOverride","groupWeight","Inclusion Group","Inclusion Group Prioritize","Inclusion Group Weight","key","keysecondary","List of strings","Logic","Logic values","Match Character Depth Prompt","Match Character Description","Match Character Personality","Match Creator Notes","Match Persona Description","Match Scenario","Match Whole Words","matchCharacterDepthPrompt","matchCharacterDescription","matchCharacterPersonality","matchCreatorNotes","matchPersonaDescription","matchScenario","matchWholeWords","Non-recursable","Number","Number (0-100)","Number (0-999)","Optional Filter","order","position","Position values","Primary Keywords","probability","role","Role values(Position = 4 only)","Scan Depth","scanDepth","selectiveLogic","String","Title / Memo","Trigger%","UI element","useGroupScoring","Value type","vectorized","Vectorized Status"]},{"l":"Example 1: Read a content from the chat lorebook by key"},{"l":"Example 2: Create a chat lorebook entry with key and content"},{"l":"Example 3: Expand an existing lorebook entry with new information from the chat"},{"l":"Text manipulation","p":["There's a variety of useful text manipulation utility commands to be used in various script scenarios.","/trimtokens— trims the input to the specified number of text tokens from the start or from the end and outputs the result to the pipe.","/trimstart— trims the input to the start of the first complete sentence and outputs the result to the pipe.","/trimend— trims the input to the end of the last complete sentence and outputs the result to the pipe.","/fuzzy— performs fuzzy matching of the input text to the list of strings, outputting the best string match to the pipe.","/regex name=scriptName [text]— executes a regex script from the Regex extension for the specified text. The script must be enabled."]},{"l":"Arguments for /trimtokens","p":["direction sets the direction for trimming, which can be either start or end. Default: end.","limit sets the amount of tokens to left in the output. Can also specify a variable name containing the number. Required argument.","Unnamed argument is the input text to be trimmed."]},{"l":"Arguments for /fuzzy","p":["list is a JSON-serialized array of strings containing the candidates. Can also specify a variable name containing the list. Required argument.","Unnamed argument is the input text to be matched. Output is one of the candidates matching the input most closely."]},{"l":"Autocomplete","p":["Autocomplete is enabled both on the chat input, and the large Quick Reply editor.","Autocomplete works anywhere in your input. Even with multiple piped commands and nested closures.","Autocomplete supports three ways of looking up matching commands ( User Settings-> STscript Matching).","Starts with The \"old\" way. Only commands that begin exactly with the typed value will show up.","Includes All commands that include the type value will show up. Example: When entering /delete, the commands /qr-delete and /qr-set-delete will show up in the autocomplete list (/qr- delete, /qr-set- delete).","Fuzzy All commands that can be fuzzy-matched against the typed value will show up. Example: When entering /seas, the command /sendas will show up in the autocomplete list (/ se nd as).","Command arguments are supported by autocomplete as well. The list will show up for required arguments automatically. For optional arguments, press Ctrl+ Space to open the list of available options.","When entering /: to execute a closure or QR, autocomplete will show a list of scoped variables and QRs.","Autocomplete has limited support for macros (in slash commands). Type {{ to get a list of available macros.","Use the up and down arrow keys to select an option from the list of autocomplete options.","Press Enter or Tab or click on an option to place the option at the cursor.","Press Escape to close the autocomplete list.","Press Ctrl+ Space to open the autocomplete list or toggle the selected option's details."]},{"l":"Parser Flags","p":["The parser accepts flags to modify its behavior. These flags can be toggled on and off at any point in a script and all following input will be evaluated accordingly. You can set your default flags in user settings."]},{"l":"Strict Escaping","p":["Changes with STRICT_ESCAPING enabled are as follows."]},{"i":"pipes-1","l":"Pipes","p":["Pipes don't need to be escaped in quoted values."]},{"l":"Backslashes","p":["A backslash in front of a symbol can be escaped to provide the literal backslash followed by the functional symbol."]},{"l":"Replace Variable Macros","p":["This flag helps to avoid double-substitutions when the variable values contain text that could be interpreted as macros. The {{var::}} macros get substituted last and no further substitutions happen on the resulting text / variable value.","Replaces all {{getvar::}} and {{getglobalvar::}} macros with {{var::}}. Behind the scenes, the parser will insert a series of command executors before the command with the replaced macros:","call /let to save the current {{pipe}} to a scoped variable","call /getvar or /getglobalvar to get the variable used in the macro","call /let to save the retrieved variable to a scoped variable","call /return with the saved {{pipe}} value to restore the correct piped value for the next command"]},{"l":"Quick Replies: script library and auto-execution","p":["Quick Replies is a built-in SillyTavern extension that provides an easy way to store and execute your scripts."]},{"l":"Configuring Quick Replies","p":["In order to get started, enable open the extensions panel (stacked blocks icon), and expand the Quick Replies menu.","Quick Reply","Quick Replies are disabled by default, you need to enable them first. Then you will see a bar appearing above your chat input bar.","You can set the displayed button text label (we recommend using emojis for brevity) and the script that will be executed when you click the button.","The number of buttons is controlled by the Number of slots settings (max = 100), adjust it according to your needs and click \"Apply\" when done.","Inject user input automatically recommended to be disabled when using STscript, otherwise it may interfere with your inputs, use the {{input}} macro to get the current value of the input bar in scripts instead.","Quick Reply presets allow to have multiple sets of predefined Quick Replies and switch between manually or by using the /qrset (name of set) command. Don't forget to click \"Update\" before switching to a different set to write your changes to the currently used preset!"]},{"l":"Manual execution","p":["Now you can add your first script to the library. Pick any free slot (or create one), type \"Click me\" into the left box to set the label, then paste this into the right box:","Then click 5 times on the button that appeared above the chat bar. Every click increments the variable clicks by one and displays a different message when the value equals 5 and resets the variable."]},{"l":"Automatic execution","p":["Open the modal menu by clicking the ⋮ button for the created command.","In this menu you can do the following:","Edit the script in a convenient full-screen editor","Hide the button from the chat bar, making it accessible only for auto-execution.","Enable automatic execution on one or more of the following conditions:","App startup","Sending a user message to the chat","Receiving an AI message in the chat","Opening a character or group chat","Triggering a reply from a group member","Activating a World Info entry using the same Automation ID","Provide a custom tool tip for the quick reply (text displayed when hovering over the quick reply in your UI)","Execute the script for test purposes","Commands are executed automatically only if the Quick Replies extension is enabled.","For example, you can display a message after sending five user messages by adding the following script and setting it to auto-execute on the user message."]},{"l":"Debugger","p":["A basic debugger exists inside the expanded Quick Reply editor. Set breakpoints with /breakpoint | anywhere in your script. When executing the script from the QR editor, the execution will be interrupted at that point, allowing you to examine the currently available variables, pipe, command arguments, and more, and to step through the rest of the code one by one.","QR Editor Debugger"]},{"l":"Calling procedures","p":["A /run command can call scripts defined in the Quick Replies by their label, basically providing the ability to define procedures and return results from them. This allows to have reusable script blocks that other scripts could reference. The last result from the procedure's pipe is passed to the next command after it.","Let's create two Quick Replies:","Label:","GetRandom","Command:","GetMessage","Clicking on the GetMessage button will call the GetRandom procedure which will resolve the {{roll}} macro and pass the number to the caller, displaying it to the user.","Procedures do not accept named or unnamed arguments, but can reference the same variables as the caller.","Avoid recursion when calling procedures as it may produce the \"call stack exceeded\" error if handled unadvisedly."]},{"l":"Calling procedures from a different Quick Reply preset","p":["You can call a procedure from a different quick reply preset using the a.b syntax, where a = QR preset name and b = QR label name","By default, the system will first look for a quick reply label a.b, so if one of your labels is literally \"QRpreset1.QRlabel1\" it will try to run that. If no such label is found, it will search for a QR preset name \"QRpreset1\" with a QR labeled \"QRlabel1\"."]},{"l":"Quick Replies management commands"},{"l":"Create Quick Reply","p":["/qr-create (arguments, [message])– creates a new Quick Reply, example: /qr-create set=MyPreset label=MyButton /echo 123","Arguments:","label- string - text on the button, e.g., label=MyButton","set- string - name of the QR set, e.g., set=PresetName1","hidden- bool - whether the button should be hidden, e.g., hidden=true","startup- bool - auto execute on app startup, e.g., startup=true","user- bool - auto execute on user message, e.g., user=true","bot- bool - auto execute on AI message, e.g., bot=true","load- bool - auto execute on chat load, e.g., load=true","title- bool - title / tooltip to be shown on button, e.g., title=My Fancy Button"]},{"l":"Delete Quick Reply","p":["/qr-delete (set=string [label])– deletes Quick Reply"]},{"l":"Update Quick Reply","p":["/qr-update (arguments, [message])– updates Quick Reply, example: /qr-update set=MyPreset label=MyButton newlabel=MyRenamedButton /echo 123","Arguments:","newlabel- string - new text fort the button, e.g. newlabel=MyRenamedButton","label- string - text on the button, e.g., label=MyButton","set- string - name of the QR set, e.g., set=PresetName1","hidden- bool - whether the button should be hidden, e.g., hidden=true","startup- bool - auto execute on app startup, e.g., startup=true","user- bool - auto execute on user message, e.g., user=true","bot- bool - auto execute on AI message, e.g., bot=true","load- bool - auto execute on chat load, e.g., load=true","title- bool - title / tooltip to be shown on button, e.g., title=My Fancy Button"]},{"i":"#","p":["qr-get- retrieves all of a Quick Reply's properties, eample: /qr-get set=myQrSet id=42"]},{"l":"Create or update QR preset","p":["/qr-presetupdate (arguments [label]) or /qr-presetadd (arguments [label])","Arguments:","enabled- bool - enable or disable the preset","nosend- bool - disable send / insert in user input (invalid for slash commands)","before- bool - place QR before user input","slots- int - number of slots","inject- bool - inject user input automatically (if disabled use {{input}})","Create a new preset (overrides existing ones), example: /qr-presetadd slots=3 MyNewPreset"]},{"l":"Add QR context menu","p":["/qr-contextadd (set=string label=string chain=bool [preset name])– add context menu preset to a QR, example: /qr-contextadd set=MyPreset label=MyButton chain=true MyOtherPreset"]},{"l":"Remove all context menus","p":["/qr-contextclear (set=string [label])– remove all context menu presets from a QR, example: /qr-contextclear set=MyPreset MyButton"]},{"l":"Remove one context menu","p":["/qr-contextdel (set=string label=string [preset name])– remove context menu preset from a QR, example: /qr-contextdel set=MyPreset label=MyButton MyOtherPreset"]},{"l":"Quick Reply value escaping","p":["|{} can be escaped with backslash in the QR message / command.","For example, use /qr-create label=MyButton /getvar myvar \\| /echo \\{\\{pipe\\}\\} to create a QR that calls /getvar myvar | /echo {{pipe}}."]},{"l":"Extension commands","p":["SillyTavern extensions (both built-in, downloadable and third-party) can add their own slash command. Below is just an example of the capabilities in the official extensions. The list may be incomplete, make sure to check /help slash for the most complete list of available commands.","/websearch (query)— searches snippets of the web pages online for the specified query and returns the result into the pipe. Provided by the Web Search extension.","/imagine (prompt)— generates an image using the provided prompt. Provided by the Image Generation extension.","/emote (sprite)— sets a sprite for the active character by fuzzy matching its name. Provided by the Character Expressions extension.","/costume (subfolder)— sets a sprite set override for the active character. Provided by the Character Expressions extension.","/music (name)— force changes a played background music file by its name. Provided by the Dynamic Audio extension.","/ambient (name)— force changes a played ambient sound file by its name. Provided by the Dynamic Audio extension.","/roll (dice formula)— adds a hidden message to the chat with the result of a dice roll. Provided by the D&D Dice extension."]},{"l":"UI interaction","p":["Scripts can also interact with SillyTavern's UI: navigate through the chats or change styling parameters."]},{"l":"Character navigation","p":["/random— opens a chat with the random character.","/go (name)— opens a chat with the character of the specified name. First, searches for the exact name match, then by a prefix, then by a substring."]},{"l":"UI styling","p":["/bubble— sets the message style to the \"bubble chat\" style.","/flat— sets the message style to the \"flat chat\" style.","/single— sets the message style to the \"single document\" style.","/movingui (name)— activates a MovingUI preset by name.","/resetui— resets the MovingUI panels state to their original positions.","/panels— toggles the UI panels visibility: top bar, left and right drawers.","/bg (name)— finds and sets a background using fuzzy names matching. Respect the chat background lock state.","/lockbg— locks the background image for the current chat.","/unlockbg— unlocks the background image for the current chat."]},{"l":"More examples"},{"l":"Generate chat summary (by @IkariDevGIT)"},{"l":"Buttons popup usage"},{"l":"Get Nth Fibonacci's number (using Binet's formula)","p":["Hint: Set value of fib_no to the desired number"]},{"l":"Recursive Factorial (using closures)"}],[{"l":"Function Calling","p":["Function Calling allows adding dynamic functionality to your extensions by letting the LLM use structured data that you then can use to trigger a specific functionality of the extension."]},{"l":"Example use cases","p":["Query external APIs for additional information (news, weather, web search, etc.).","Perform calculations or conversions based on user input.","Store and recall important memories or facts, including RAG and database queries.","Introduce true randomness into the conversation (dice rolls, coin flips, etc.)."]},{"l":"Officially supported extensions using function calling","p":["Image Generation(built-in) - generate images based on user prompts.","Web Search- trigger a web search for a query.","RSS- fetch the latest news from RSS feeds.","AccuWeather- fetch the weather information from AccuWeather.","D&D Dice- roll dice for D&D games."]},{"l":"Prerequisites and limitations","p":["This feature is only available for certain Chat Completion sources: OpenAI, Claude, MistralAI, Groq, Cohere, OpenRouter, AI21, Google AI Studio, Google Vertex AI, DeepSeek, AI/ML API and Custom API sources.","Text Completion APIs don't support function calls, but some locally-hosted backends like Ollama and TabbyAPI may run in Custom OpenAI-compatible mode under Chat Completion.","The support for function calling must be explicitly allowed by the user first. This is done by enabling the \"Enable function calling\" option in the AI Response Configuration panel.","There is no guarantee that an LLM will perform any function calls at all. Most of them require an explicit \"activation\" through the prompt (e.g., the user asking to \"Roll a dice\", \"Get the weather\", etc.).","Not all prompts can trigger a tool call. Continuations, impersonation, background ('quiet') prompts are not allowed to trigger a tool call. They can still use past successful tool calls in their responses."]},{"l":"How to make a function tool"},{"l":"Check if the feature is supported","p":["To determine if the function tool calling feature is supported, you can call isToolCallingSupported from the SillyTavern.getContext() object. This will check if the current API supports function tool calling and if it's enabled in the settings. Here is an example of how to check if the feature is supported:"]},{"l":"Register a function","p":["To register a function tool, you need to call the registerFunctionTool function from the SillyTavern.getContext() object and pass the required parameters. Here is an example of how to register a function tool:"]},{"l":"Unregister a function","p":["To deactivate a function tool, you need to call the unregisterFunctionTool function from the SillyTavern.getContext() object and pass the name of the function tool to disable. Here is an example of how to unregister a function tool:"]},{"l":"Tips and tricks","p":["Successful tool calls are saved as a part of the visible history and will be displayed in the chat UI, so you can inspect the actual parameters and results. If that is not desirable, set the stealth: true flag when registering a function tool.","If you don't want to see the tool call in the chat history. If you want to stylize or hide them with custom CSS, target a toolCall class on .mes elements, i.e. .mes.toolCall { display: none; } or .mes.toolCall { color: #999; }."]}],[{"l":"UI Extensions","p":["UI extensions expand SillyTavern's functionality by hooking into its events and API. They run in a browser context and have practically unrestricted access to the DOM, JavaScript APIs, and the SillyTavern context. Extensions can modify the UI, call internal APIs, and interact with chat data. This guide explains how to create your own extensions (JavaScript knowledge is required).","Go here: Extensions.","To extend the functionality of the Node.js server, see the Server Plugins page.","Can't write JavaScript?","Consider STscript as a simpler alternative to writing a full-fledged extension.","Go through the MDN Course and come back when you're done."]},{"l":"Extension submissions","p":["Want to contribute your extensions to the official content repository? Contact us!","To ensure that all extensions are safe and easy to use, we have a few requirements:","Your extension must be open-source and have a libre license (see Choose a License). If you are unsure, AGPLv3 is a good choice.","Extensions must be compatible with the latest release version of SillyTavern. Please be ready to update your extension if something in the core changes.","Extensions must be well-documented. This includes a README file with installation instructions, usage examples, and a list of features.","Extensions that have a server plugin requirement to function will not be accepted."]},{"l":"Examples","p":["See live examples of simple SillyTavern extensions:","https://github.com/city-unit/st-extension-example- basic extension template. Showcases manifest creation, local script imports, adding a settings UI panel, and persistent extension settings usage.","https://github.com/search?q=topic%3Aextension+org%3ASillyTaverntype=Repositories- a list of all official SillyTavern extensions on GitHub."]},{"l":"Bundling","p":["Extensions can also utilize bundling to isolate themselves from the rest of the modules and use any dependencies from NPM, including UI frameworks like Vue, React, etc.","https://github.com/SillyTavern/Extension-WebpackTemplate- template repository of an extension using TypeScript and Webpack (no React).","https://github.com/SillyTavern/Extension-ReactTemplate- template repository of a bare-bones extension using React and Webpack.","To use relative imports from the bundle, you may need to create an import wrapper. Here's an example for Webpack:"]},{"l":"manifest.json","p":["Every extension must have a folder in data/user-handle/extensions and a manifest.json file, which contains metadata about the extension and a path to a JS script file that is the entry point of the extension.","Downloadable extensions are mounted into the /scripts/extensions/third-party folder when serving over HTTP, so relative imports should be used based on that. To ease local development, consider placing your extension repository in the /scripts/extensions/third-party folder (the \"Install for all users\" option)."]},{"l":"Manifest fields","p":["display_name is required. It is displayed in the \"Manage Extensions\" menu.","loading_order is optional. A higher number loads later.","js is the main JS file reference and is required.","css is an optional style file reference.","author is required. It should contain the name or contact info of the author(s).","auto_update is set to true if the extension should auto-update when the version of the ST package changes.","i18n is an optional object that specifies the supported locales and their corresponding JSON files (see below).","dependencies is an optional array of strings specifying other extensions that this extension depends on.","generate_interceptor is an optional string that specifies the name of a global function called on text generation requests.","minimum_client_version is an optional string that specifies the minimum SillyTavern version required for this extension to work."]},{"l":"Dependencies","p":["Extensions can also depend on other SillyTavern extensions. The extension will not load if any of these dependencies are missing or disabled.","Dependencies are specified by their folder name as it appears in the public/extensions directory.","Examples:","Built-in extensions: vectors, caption","Third-party extensions: third-party/Extension-WebLLM, third-party/Extension-Mermaid"]},{"l":"Deprecated fields","p":["requires is an optional array of strings specifying required Extras modules. The extension won't be loaded if the connected Extras API doesn't provide all listed modules.","optional is an optional array of strings specifying optional Extras modules. The extension will still load if these are missing, and the extension should handle their absence gracefully.","To check which modules are currently provided by the connected Extras API, import the modules array from scripts/extensions.js."]},{"l":"Scripting"},{"l":"Using getContext","p":["The getContext() function in the SillyTavern global object gives you access to the SillyTavern context, which is a collection of all the main app state objects, useful functions, and utilities.","You can find the full list of available properties and functions in the SillyTavern source code.","If you're missing any of the functions/properties in getContext, please get in touch with the developers or send us a pull request!"]},{"l":"Shared libraries","p":["Most of the npm libraries used internally by the SillyTavern frontend are shared in the libs property of the SillyTavern global object.","lodash- Utility library. Docs.","localforage- Browser storage library. Docs.","Fuse- Fuzzy search library. Docs.","DOMPurify- HTML sanitization library. Docs.","Handlebars- Templating library. Docs.","moment- Date/time manipulation library. Docs.","showdown- Markdown converter library. Docs.","You can find the full list of exported libraries in the SillyTavern source code.","Example: Using the DOMPurify library."]},{"l":"TypeScript notice","p":["If you want access to autocomplete for all methods in the SillyTavern global object (and you probably do), including getContext() and libs, you should add a TypeScript .d.ts module declaration. This declaration should import global types from SillyTavern's source, depending on your extension's location. Below is an example that works for both installation types: \"all users\" and \"current user.\"","global.d.ts- place this file in the root of your extension directory (next to manifest.json):"]},{"l":"Importing from other files","p":["Using imports from SillyTavern code is unreliable and can break at any time if the internal structure of ST's modules changes. getContext provides a more stable API.","Unless you're building a bundled extension, you can import variables and functions from other JS files.","For example, this code snippet will generate a reply from the currently selected API in the background:"]},{"l":"State management"},{"l":"Persistent settings","p":["When an extension needs to persist its state, it can use the extensionSettings object from the getContext() function to store and retrieve data. An extension can store any JSON-serializable data in the settings object and must use a unique key to avoid conflicts with other extensions.","To persist the settings, use the saveSettingsDebounced() function, which will save the settings to the server."]},{"l":"Chat metadata","p":["To bind some data to a specific chat, you can use the chatMetadata object from the getContext() function. This object allows you to store arbitrary data associated with a chat, which can be useful for storing extension-specific state.","To persist the metadata, use the saveMetadata() function, which will save the metadata to the server.","Do not save the reference to chatMetadata in a long-lived variable, as the reference will change when the chat is switched. Always use SillyTavern.getContext().chatMetadata to access the current chat metadata.","The CHAT_CHANGED event is emitted when the chat is switched, so you can listen to this event to update your extension's state accordingly. See more in the Listening to events section."]},{"l":"Character cards","p":["SillyTavern fully supports Character Cards V2 Specification, which allows to store arbitrary data in the character card JSON data.","This is useful for extensions that need to store additional data associated with the character and make it shareable when exporting the character card.","To write data to the character card extensions data field, use the writeExtensionField function from the getContext() function. This function takes a character ID, a string key, and a value to write. The value must be JSON-serializable.","Despite being called characterId, it's not a \"real\" unique identifier but rather an index of the character in the characters array.","The index of the current character is provided by the characterId property in the context. If you want to write data to the currently selected character, use SillyTavern.getContext().characterId. If you need to store data for another character, find the index by searching for the character in the characters array.","Caution: characterId is undefined in group chats or when no character is selected!"]},{"l":"Settings presets","p":["Arbitrary JSON data can be stored in the settings presets of the main API types. It will be exported and imported along with the preset JSON, so you can use it to store extension-specific settings for the preset. The following API types support data extensions in settings presets:","Chat Completion","Text Completion","NovelAI","KoboldAI / AI Horde","To read or write the data, you first need to get the PresetManager instance from the context:","The PRESET_CHANGED and MAIN_API_CHANGED events are emitted when the preset is changed or the main API is switched, so you can listen to these events to update your extension's state accordingly. See more in the Listening to events section."]},{"l":"Internationalization","p":["For general information on providing translations, see the Internationalization page.","Extensions can provide additional localized strings for use with the t, translate functions and the data-i18n attribute in HTML templates.","See the list of supported locales here ( lang key): https://github.com/SillyTavern/SillyTavern/blob/release/public/locales/lang.json"]},{"l":"Direct addLocaleData call","p":["Pass a locale code and an object with the translations to the addLocaleData function. Overrides of existing keys are NOT allowed. If the passed locale code is not a currently chosen locale, the data will be silently ignored."]},{"l":"Via the extension manifest","p":["Add an i18n object with a list of supported locales and their corresponding JSON file paths (relative to your extension's directory) to the manifest."]},{"l":"Registering slash commands (new way)","p":["While registerSlashCommand still exists for backward compatibility, new slash commands should now be registered through SlashCommandParser.addCommandObject() to provide extended details about the command and its parameters to the parser (and, in turn, to autocomplete and the command help).","All registered commands can be used in STscript in any possible way."]},{"l":"Events"},{"l":"Listening to events","p":["Use eventSource.on(eventType, eventHandler) to listen for events:","The main event types are:","APP_READY: the app is fully loaded and ready to use. It will auto-fire every time a new listener is attached after the app is ready.","MESSAGE_RECEIVED: the LLM message is generated and recorded into the chat object but not yet rendered in the UI.","MESSAGE_SENT: the message is sent by the user and recorded into the chat object but not yet rendered in the UI.","USER_MESSAGE_RENDERED: the message sent by a user is rendered in the UI.","CHARACTER_MESSAGE_RENDERED: the generated LLM message is rendered in the UI.","CHAT_CHANGED: the chat has been switched (e.g., switched to another character, or another chat was loaded).","GENERATION_AFTER_COMMANDS: the generation is about to start after processing slash commands.","GENERATION_STOPPED: the generation was stopped by the user.","GENERATION_ENDED: the generation has been completed or has errored out.","SETTINGS_UPDATED: the application settings have been updated.","The rest can be found in the source.","The way each event passes its data to the listener is not uniform. Some events don't emit any data; some pass an object or a primitive value. Please refer to the source code where the event is emitted to see what data it passes, or check with the debugger."]},{"l":"Emitting events","p":["You can produce any application events from extensions, including custom events, by calling eventSource.emit(eventType, ...eventData):"]},{"l":"Prompt Interceptors","p":["Prompt Interceptors provide a way for extensions to perform any activity such as modifying the chat data, adding injections, or aborting the generation before a text generation request is made.","Interceptors from different extensions are run sequentially. The order is determined by the loading_order field in their respective manifest.json files. Extensions with lower loading_order values run earlier. If loading_order is not specified, display_name is used as a fallback. If neither is specified, the order is undefined."]},{"l":"Registering an Interceptor","p":["To define a prompt interceptor, add a generate_interceptor field to your extension's manifest.json file. The value should be the name of a global function that will be called by SillyTavern."]},{"l":"Interceptor Function","p":["The generate_interceptor function is a global function that will be called upon generation requests that are not dry runs. It must be defined in the global scope (e.g., globalThis.myCustomInterceptorFunction = async function(...) { ... }) and can return a Promise if it needs to perform any asynchronous operations.","The interceptor function receives the following arguments:","chat: An array of message objects representing the chat history that will be used for prompt building. You can modify this array directly (e.g., add, remove, or alter messages). Please note that messages are mutable, so any changes you make to the array will be reflected in the actual chat history. If you want the changes to be ephemeral, use structuredClone to create a deep copy of the message object.","contextSize: A number indicating the current context size (in tokens) calculated for the upcoming generation.","abort: A function that, when called, will signal to prevent the text generation from proceeding. It accepts a boolean parameter that prevents any subsequent interceptors from running if true.","type: A string indicating the type or trigger of the generation (e.g., 'quiet', 'regenerate', 'impersonate', 'swipe', etc.). This helps the interceptor apply logic conditionally based on how the generation was initiated.","Example Implementation:"]},{"l":"Generating text","p":["SillyTavern provides several functions to generate text in different contexts using the currently chosen LLM API. These functions allow you to generate text in the context of a chat, raw generation without any context, or with structured outputs."]},{"l":"Within a chat context","p":["The generateQuietPrompt() function is used to generate text in the context of a chat with an added \"quiet\" prompt (post-history instruction) in the background (the output is not rendered in the UI). This is useful for generating text without interrupting the user experience while also keeping the relevant chat and character data intact, such as generating a summary or an image prompt."]},{"l":"Raw generation","p":["The generateRaw() function is used to generate text without any chat context. It is useful when you want to fully control the prompt-building process.","It accepts a prompt as a Text Completion string or an array of Chat Completion objects, constructing the request with an appropriate format depending on the selected API type, e.g., converting between chat/text modes, applying instruct formatting, etc. You can also pass an additional systemPrompt and a prefill to the function for even more control over the generation process."]},{"l":"Structured Outputs","p":["Currently only supported by the Chat Completion API. The availability varies based on the selected source and model. If the selected model does not support structured outputs, the generation will either fail or will return an empty object ('{}'). Check the documentation for the specific API you are using to see if structured outputs are supported.","You can use the structured outputs feature to ensure the model produces a valid JSON object that adheres to a provided JSON Schema. This is useful for extensions that require structured data, such as state tracking, data classification, etc.","To use structured outputs, you must pass a JSON schema object to generateRaw() or generateQuietPrompt(). The model will then generate a response that matches the schema, and it will be returned as a stringified JSON object.","The outputs are not validated against the schema, you must handle the parsing and validation of the generated output yourself. If the model fails to generate a valid JSON object, the function will return an empty object ('{}').","Zod is a popular library to generate and validate JSON schemas. Its use will not be covered here."]},{"l":"Registering custom macros","p":["You can register custom macros that can be used anywhere where macro substitutions are supported, e.g. in the character card fields, STscript commands, prompt templates, etc.","To register a macro, use the registerMacro() function from the SillyTavern.getContext() object. The function accepts a macro name that should be a unique string, and a string or a function that returns a string. The function will be called with a unique nonce string that will be different between each substituteParams call.","When a custom macro is no longer needed, remove it using the unregisterMacro() function:","Important details and known limitations regarding custom macros:","Currently only simple string replacement macros are supported. We're working on adding support for more complex macros in the future.","Macros that use functions to provide a value must be synchronous. Returning a Promise will not work.","You do not need to wrap the macro name in double curly braces ({{ }}) when registering it. SillyTavern will do that for you.","Since macros are plain regular expression substitutions, registering a lot of macros will cause performance issues, so use them sparingly."]},{"l":"Do Extras request","p":["The Extras API is deprecated. It's not recommended to use it in new extensions.","The doExtrasFetch() function allows you to make requests to your SillyTavern Extras API server.","For example, to call the /api/summarize endpoint:","getApiUrl() returns the base URL of the Extras server.","The doExtrasFetch() function:","Adds the Authorization and Bypass-Tunnel-Reminder headers","Handles fetching the result","Returns the result (the response object)","This makes it easy to call your Extras API from your extension.","You can specify:","The request method: GET, POST, etc.","Additional headers","The body for POST requests","Any other fetch options"]}],[{"l":"Server Plugins","p":["These plugins allow for adding functionality that is impossible to achieve using UI extensions alone, such as creating new API endpoints or using Node.JS packages that are unavailable in a browser environment.","Plugins are contained in the plugins directory of SillyTavern and are loaded on server startup, but only if enableServerPlugins is set to true in the config.yaml file.","Server Plugins are not sandboxed. This means they can potentially gain access to your entire file system, or introduce a wide range of security vulnerabilities in a way that normal UI extensions cannot. Only install server plugins from developers you trust!","For a list of all official server plugins, see the GitHub organization list: https://github.com/search?q=topic%3Aplugin+org%3ASillyTaverntype=Repositories"]},{"l":"Types of plugins"},{"l":"Files","p":["An executable JavaScript file with a \".js\" (for CommonJS modules) or \".mjs\" (for ES modules) extension containing a module that exports an init function. This function accepts an Express router (created specifically for your plugin) as an argument and returns a Promise.","The module should also export an info object containing information about the plugin ( id, name, and description strings). This will provide information about the plugin to the loader.","You can register routes via the router that will be registered under the /api/plugins/{id}/{route} path. For example, router.get('/foo') for the example plugin will produce a route like this: /api/plugins/example/foo.","A plugin can also optionally export an exit function that performs clean-up when shutting down the server. It should have no arguments and must return a Promise.","TypeScript contract for plugin exports:","See below for a \"Hello world!\" plugin example:"]},{"l":"Directories","p":["You can load a plugin from a subdirectory in the plugins directory in one of the following ways (in order of precedence):","A package.json file that contains a path to an executable file in the \"main\" field.","An index.js file for CommonJS modules.","An index.mjs file for ES modules.","A resulting file must export an init function and an info object with the same requirements as for individual files.","Example of a directory plugin (with an index.js file): https://github.com/SillyTavern/SillyTavern-DiscordRichPresence-Server"]},{"l":"Bundling","p":["It is preferable to use a bundler (such as Webpack or Browserify) that will package all the requirements into one file. Make sure to set \"Node\" as a build target.","Template repository for plugins using Webpack and TypeScript: https://github.com/SillyTavern/Plugin-WebpackTemplate"]}],[{"l":"Internationalization (i18n)","p":["SillyTavern supports multiple languages. This guide explains how to add and manage translations.","You're probably here because some piece of text is untranslated in your language, and it's driving you nuts. First I'll show you how I fixed some missing translations in the Chinese (Traditional) locale. Each was missing for a different reason, so you'll get a good idea of how to fix your own missing translations.","In the second half, we look at","how i18n works in SillyTavern,","writing translations and code to use them,","debug functions to find missing translations,","adding a new language,","and contributing your changes.","If you're developing an extension or modifying the core code, write your HTML and JavaScript with i18n in mind. This way your work is ready for other people to translate it into their language.","Nobody knows 15 languages by themselves. We work together to make SillyTavern accessible to everyone.","Everyone in the world should be able to use their own language on phones and computers."]},{"l":"Let's fix some missing translations!","p":["All 3 of these issues required code changes to fix. If you're adding a new translation, you might not need to touch the code at all. Just add the translation to the JSON file. It just so happens that somebody recently added a large number of missing translations to the Chinese (Traditional) JSON file, so the remaining issues were all in the code. In other locales there are plenty of missing translations you can fix without touching the code."]},{"l":"Generate Image","p":["... which we can add to the JSON file just after the \"Generate Image\" translation.","After some discussion with Claude, we're actually going to go with the following translations:","But while we have the HTML open, what's with Stop Image Generation just under it? The HTML doesn't look right.","First fix the HTML:","generate-image-lang.png","generate-image-post.png","generate-image-pre.png","If we generate an image and then open the wand menu while it's generating, we see untranslated text.","Japanese: \"Stop Image Generation\": \"画像生成を停止\"","Now it works! Reload the page and see.","Right-click on the element and inspect it. You'll see the HTML:","Simplified Chinese: \"Stop Image Generation\": \"中止图像生成\"","stop-generating-image-pre.png","stop-generating-post-2.png","The text \"Generate Image\" is untranslated in the Chinese (Traditional) locale. Why?","This isn't enough to fix the issue. There are no translations for \"Stop Image Generation\" in the Chinese (Traditional) file. We can add it! Here's one possible translation:","Traditional Chinese: \"Stop Image Generation\": \"終止圖片生成\"","We are in luck, that string Generate Image is in many of the language files, including in Chinese (Traditional).","Where is its data-i18n attribute? It's missing! Let's add it. We find it in the source code:","Why isn't it showing up? We have to wire the element up correctly:"]},{"l":"Generate Caption","p":["\"Generate Caption\" is untranslated in the Chinese (Traditional) locale. Let's fix it!","generate-image-post.png","Where is it? Inspect the element.","Turns out that this HTML is produced by JavaScript. Let's find the source code.","We will first have to fix the code:","There are also no translations for \"Generate Caption\" in the Chinese (Traditional) file. Let's add it!","We will use the following translations:","Traditional Chinese: \"Generate Caption\": \"生成圖片說明\"","Simplified Chinese: \"Generate Caption\": \"生成图片说明\"","Japanese: \"Generate Caption\": \"画像説明を生成\"","generate-caption-post.png"]},{"l":"Inspect Prompts","p":["The text \"Inspect Prompts\" is untranslated in the Chinese (Traditional) locale. Why? This one is a bit more complicated. The text is generated by JavaScript, and the translation is missing.","Well wouldn't you know it... neither phrase is in the i18n files. Let's add them.","Now we have to fix the JavaScript code. It has to use the t function to get the translation.","We got these suggestions from Claude. Keep the strings, ignore the code. They have to be added to the JSON files.","We will merge those into the JSON files.","toggle-prompt-inspection-post-tt.png","A pity about that tooltip. The problem is that the code doesn't use the t function.","We will have to fix that in the extension code.","We also need to add the translations to the JSON files.","Prompt inspector is a separate extension, so we will PR the code fixes to that repo: https://github.com/SillyTavern/Extension-PromptInspector/pull/1","The translations will be added to the main SillyTavern repo. https://github.com/SillyTavern/SillyTavern/pull/3198","start-inspecting-post.png"]},{"l":"Language files","p":["Each language has a JSON file in public/locales/ named with its language code (e.g., ru-ru.json).","The file contains key-value pairs where:","Keys are either the original English text or unique identifiers","Values are the translated text","Example:"]},{"l":"How translations work","p":["There are two ways translations are used in the application:","HTML Elements: Using data-i18n attributes","The default text in the HTML will be replaced with the translated text if available.","Template Strings: In the JavaScript code using the t function","These strings should be translated keeping the ${0}, ${1}, etc. placeholders intact.","SillyTavern uses HTML elements with data-i18n attributes to mark translatable content. There are several ways to use this:"]},{"l":"1. Translating Element Text","p":["For simple text content:","This replaces the element's text content with the translation of \"Role:\"."]},{"l":"2. Translating Attributes","p":["To translate an attribute like a title or placeholder:","The [title] prefix indicates which attribute to translate. The rest of the attribute value is the text that will be used as a lookup key in the JSON file. It is common for coders to use the English text as the key, but it is not required. The key can be any unique identifier.","The original English text must be present in the corresponding attribute ( title=Insert prompt) though. It's used as a fallback if the translation is missing. Most notably, there is no translation file for English.","Here is an example of using a unique identifier no_items_text as the key, rather than the English text:"]},{"l":"3. Multiple Translations Per Element","p":["Some elements need both content and attribute translations, separated by semicolons. The most common pattern is translating both the element's text content and its title attribute:","This translates:","The element's text content using the key \"Authorize\"","The title attribute using the key \"Get your OpenRouter API token using OAuth flow. You will be redirected to openrouter.ai\"","Note that both the title attribute and the element's text content are provided in English as fallbacks.","You can also translate multiple attributes:","The corresponding translations in your language file would look like:","When the page loads, the system:","Finds all elements with data-i18n attributes","Parses any attribute prefixes like [title] or [placeholder]","Looks up each key in your language's JSON file","Replaces the element's content or attributes with the translated text"]},{"l":"Dynamic Text","p":["For dynamic text in JavaScript code, translations use either:","Template literals with the t function:","Direct translation function:"]},{"l":"Variable Placeholders","p":["Some strings contain placeholders for dynamic values using ${0}, ${1}, etc:","Keep the placeholders the same for key and translation. The system will replace ${0} with the value of presetName, etc."]},{"l":"Finding missing translations","p":["Let's say you don't just want to fix one annoying missing translation, you want to find them all.","That's a big ambition! Even fixing one translation is worth it. But if you want to catch 'em all, you need a tool."]},{"l":"SillyTavern-i18n","p":["https://github.com/SillyTavern/SillyTavern-i18n","Tools for working with frontend localization files.","Features:","Automatically add new keys to translate from HTML files.","Prune missing keys from localization files.","Use automatic Google translation to auto-populate missing values.","Sort JSON files by keys."]},{"l":"Inbuilt debug functions","p":["These are under User Settings> Debug Menu."]},{"l":"Get missing translations","p":["Detects missing localization data in the current locale and dumps the data into the browser console. If the current locale is English, searches all other locales.","The console will show a table of missing translations with:","key: The text or identifier needing translation","language: Your current language code","value: The English text to translate"]},{"l":"Apply locale","p":["Reapplies the currently selected locale to the page","they don't catch missing translations in JavaScript code","they don't catch missing data-i18n attributes in HTML, they just catch untranslated keys","there are bugs in the code for getMissingTranslations: keys should not be prefixed with [title] or [placeholder]"]},{"l":"Adding a new language","p":["To add support for a new language:","Add your language to public/locales/lang.json:","Create public/locales/xx-xx.json with your translations"]},{"l":"Contributing","p":["When your translations are ready:","Verify your JSON file is valid","Test thoroughly in the application","Submit via GitHub pull request"]}],[{"l":"Administration","p":["Despite following many security best practices, the SillyTavern server is not secure enough for public internet exposure.","NEVER HOST ANY INSTANCES TO THE OPEN INTERNET WITHOUT ENSURING PROPER SECURITY MEASURES FIRST.","WE ARE NOT RESPONSIBLE FOR ANY DAMAGE OR LOSSES IN CASES OF UNAUTHORIZED ACCESS DUE TO IMPROPER OR INADEQUATE SECURITY IMPLEMENTATION.","config.yaml","The main configuration file for SillyTavern that contains various settings, such as the network settings, security settings, and backend-specific options.","Multi-user","To share your SillyTavern instance with others, you can create multiple user accounts. Each user has their own settings, extensions, and data. User accounts can also be password-protected.","Remote access","You can access your SillyTavern instance from your phone, tablet, or another computer.","VPNs and Tunneling","To access your SillyTavern instance from the internet, you can use a VPN or a tunneling service like Cloudflare Zero Trust, ngrok, or Tailscale.","Reverse proxying","For enthusiasts, you can set up a reverse proxy to access your SillyTavern instance from the internet."]},{"l":"Security checklist","p":["This is just a recommendation. Please consult a web application security specialist before making your ST instance live.","Keep your operating system and runtime software like Node.js updated. This will ensure that your system is up-to-date with the latest security patches and fixes which can help prevent potential vulnerabilities.","Use a whitelist and a network firewall. Only allow trusted IP ranges to access the server.","Enable basic authentication. It acts as a \"master password\" before you can proceed to the front-end app.","Alternatively, configure external authentication. Some known services for that are Authelia and authentik. See more in the SSO guide.","Never leave admin accounts passwordless. A server will warn you upon the startup if you have any unprotected admin accounts.","Use the discreet login setting outside of the local network. This will hide the user list from any potential outsiders.","Check the access logs often. They are written to the server console and the access.log file and provide information on incoming connections, such as IP address and user agent.","Configure HTTPS. For a localhost server, you can generate and use a self-signed certificate. Otherwise, you may need to deploy a proxying web server like Traefik or Caddy.","Find more on secure proxying in the following guide: Reverse Proxying SillyTavern."]}],[{"l":"Configuration File","p":["This documentation may be obsolete, incomplete, or incorrect. Please refer to the default config.yaml in your installation for the most up-to-date list of settings.","WARNING: DO NOT EDIT THE DEFAULT CONFIG DIRECTLY. THIS WON'T HAVE ANY POSITIVE EFFECT. EDIT ITS COPY IN THE REPOSITORY ROOT INSTEAD.","config.yaml is the main configuration file for the SillyTavern server that you can find in the repository root directory after completing the installation. It is a YAML file that contains various settings, such as the network settings, security settings, and backend-specific options. The changes made to this file will take effect after restarting the server.","New settings that added to the upstream version will be automatically populated with the default values when you run npm install(or specifically, the post-install.js script) after updating the repository. You can then modify these settings as needed.","For nested settings, dot notation is used to indicate the hierarchy. For example, protocol.ipv6: false refers to the ipv6 setting under the protocol section with a value of false."]},{"l":"Command-Line Arguments","p":["You can pass command-line arguments to SillyTavern server startup to override some settings in config.yaml."]},{"l":"Examples"},{"l":"Supported arguments","p":["--basicAuthMode","--browserLaunchAvoidLocalhost","--browserLaunchEnabled","--browserLaunchHostname","--browserLaunchPort","--certPath","--configPath","--corsProxy","--dataRoot","--disableCsrf","--dnsPreferIPv6","--enableIPv4","--enableIPv6","--global","--keyPath","--listen","--listenAddressIPv4","--listenAddressIPv6","--port","--requestProxyBypass","--requestProxyEnabled","--requestProxyUrl","--ssl","--version","--whitelist","array","Automatically launches SillyTavern in the browser","Avoids using 'localhost' for browser launch in auto mode","boolean","Description","Disables CSRF protection (NOT RECOMMENDED)","Enables basic authentication","Enables SSL","Enables the CORS proxy","Enables the IPv4 protocol","Enables the IPv6 protocol","Enables the use of a proxy for outgoing requests","Enables whitelist mode","Forces the use of system-wide paths for application data","Makes SillyTavern listen on all network interfaces","None of the arguments are required. If you don't provide them, SillyTavern will use the settings in config.yaml.","number","Option","Overrides the path to the config.yaml file (standalone mode only)","Overrides the port for browser launch","Prefers IPv6 for DNS","Sets the browser launch hostname","Sets the path to your certificate file","Sets the path to your private key file","Sets the port under which SillyTavern will run","Sets the request proxy bypass list (space-separated list of hosts)","Sets the request proxy URL (HTTP or SOCKS protocols)","Sets the root directory for data storage (standalone mode only)","Shows the version number","Specifies the IPv4 address to listen on","Specifies the IPv6 address to listen on","string","Type"]},{"l":"Environment Variables","p":["Configuration may also be set via environment variables which will override the values in the config.yaml file.","The environment variables should be prefixed with SILLYTAVERN_ and use uppercase letters for the setting names. For example, the dataRoot setting can be overridden with the SILLYTAVERN_DATAROOT environment variable.","The nested settings should be separated by underscores. For example, protocol.ipv6 can be overridden with the SILLYTAVERN_PROTOCOL_IPV6 environment variable.","Configurations that expect arrays or objects should be JSON-stringified. For example, to override the whitelist setting with the SILLYTAVERN_WHITELIST environment variable, you should set it as a JSON string: SILLYTAVERN_WHITELIST='[127.0.0.1, ::1]'.","If using Node.js >= 20, you can also store the environment variables in a .env file and pass it to the server using the --env-file flag. For example, to use the .env file located in the repository root, you can start the server with the following command:","Alternatively, pass the environment variables directly via the command line:","See more on using environment variables in the Node.js documentation."]},{"l":"Data Configuration","p":["./data","Any valid directory path","dataRoot","Default","Description","Enable on-demand tokenizer downloads","enableDownloadableTokenizers","false","Permitted Values","Root directory for user data storage (standalone mode only)","Setting","Skip new default content checks","skipContentCheck","true","true, false"]},{"l":"Logging Configuration","p":["Setting","Description","Default","Permitted Values","logging.minLogLevel","Minimum log level to display in the terminal","0(DEBUG)","(DEBUG = 0, INFO = 1, WARN = 2, ERROR = 3)","logging.enableAccessLog","Write server access log to file and console","true","true, false"]},{"l":"Network Configuration","p":["'[::]'","0.0.0.0","8000","Any valid port number (1-65535)","Default","Description","dnsPreferIPv6","Enable listening for incoming connections","Enable listening on IPv4 protocol","Enable listening on IPv6 protocol","false","listen","Listen on specific IPv4 address","Listen on specific IPv6 address","listenAddress.ipv4","listenAddress.ipv6","Permitted Values","port","Prefer IPv6 for DNS resolution","protocol.ipv4","protocol.ipv6","Server listening port","Setting","true","true, false","true, false, auto","Valid IPv4 address","Valid IPv6 address"]},{"l":"SSL Configuration","p":["./certs/cert.pem","./certs/privkey.pem","Default","Description","Enable SSL/TLS","false","Path to SSL certificate","Path to SSL private key","Permitted Values","Setting","ssl.certPath","ssl.enabled","ssl.keyPath","true, false","Valid file path"]},{"l":"Security Configuration","p":["[::1, 127.0.0.1]","Allow API keys exposure in the UI","allowKeysExposure","Array of valid IP addresses","Automatically whitelist Docker host IPs","Check forwarded headers for whitelisted IPs","Default","Description","Disable CSRF protection (not recommended)","Disable startup security checks (not recommended)","disableCsrfProtection","Enable CORS proxy middleware","Enable IP whitelist filtering","enableCorsProxy","enableForwardedWhitelist","false","List of allowed IP addresses","Permitted Values","securityOverride","Setting","true","true, false","whitelist","whitelistDockerHosts","whitelistMode"]},{"l":"User Authentication","p":["-1(disabled)","Any number (-1 to disable, 0 for browser close, >0 for timeout)","Any string","autheliaAuth","Basic auth password","Basic auth username","basicAuthMode","basicAuthUser.password","basicAuthUser.username","Default","Description","Enable Authelia-based auto login. See: SSO","Enable basic authentication","Enable multi-user mode","enableDiscreetLogin","enableUserAccounts","false","Hide user list on login screen","password","Permitted Values","perUserBasicAuth","sessionTimeout","Setting","true, false","Use account credentials for basic auth","user","User session timeout in seconds"]},{"l":"Rate Limiting Configuration","p":["Setting","Description","Default","Permitted Values","rateLimiting.preferRealIpHeader","Use X-Real-IP header instead of socket IP for rate limiting","false","true, false"]},{"l":"Request Proxy Configuration","p":["[localhost, 127.0.0.1]","Array of hostnames/IPs","Default","Description","Enable proxy for outgoing requests","false","Hosts to bypass proxy","null","Permitted Values","Proxy server URL","requestProxy.bypass","requestProxy.enabled","requestProxy.url","Setting","true, false","Valid proxy URL (e.g., socks5://username:password@example.com:1080)"]},{"l":"Browser Launch Configuration","p":["-1","-1(use server port), any valid port number","auto","auto, any valid hostname (e.g., localhost, st.example.com)","Avoid using 'localhost' in a launch URL","Browser to use for opening the URL","browserLaunch.avoidLocalhost","browserLaunch.browser","browserLaunch.enabled","browserLaunch.hostname","browserLaunch.port","Default","default, chrome, firefox, edge, brave","Description","false","Open the browser automatically on server startup","Override the hostname for browser launch","Override the port for browser launch","Permitted Values","Previously known as \"Autorun\" settings.","Setting","true","true, false"]},{"l":"Performance Configuration","p":["Setting","Description","Default","Permitted Values","performance.lazyLoadCharacters","Lazy-load character data","true","true, false","performance.useDiskCache","Enables disk caching for character cards","performance.memoryCacheCapacity","Maximum memory cache capacity","100mb","Human-readable size (e.g., 100mb, 1gb)"]},{"l":"Cache Buster Configuration","p":["Requires localhost or a domain with HTTPS, otherwise will not work!","Setting","Description","Default","Permitted Values","cacheBuster.enabled","Clear browser cache on first load or after uploading image files","false","true, false","cacheBuster.userAgentPattern","Only clear cache for the specified user agent regex pattern. Example: 'firefox'(case-insensitive)","''","Any valid regex string"]},{"l":"Thumbnailing Configuration","p":["[160, 90]","[96, 144]","0-100","95","Array of two numbers (width, height)","Avatar thumbnails size","Background thumbnails size","Default","Description","Enable thumbnail generation","Image format for thumbnails","JPEG thumbnail quality","jpg","jpg, png","Permitted Values","Persona thumbnails size","Setting","thumbnails.dimensions.avatar","thumbnails.dimensions.bg","thumbnails.dimensions.persona","thumbnails.enabled","thumbnails.format","thumbnails.quality","true","true, false"]},{"l":"Backup Configuration","p":["-1","10000","50","Any positive integer","Any positive integer or -1","Backup throttle interval (ms)","backups.chat.checkIntegrity","backups.chat.enabled","backups.chat.maxTotalBackups","backups.chat.throttleInterval","backups.common.numberOfBackups","Default","Description","Enable automatic chat backups","Maximum total chat backups to keep","Number of backups to keep","Permitted Values","Setting","true","true, false","Verify integrity of chat files before saving"]},{"l":"Extensions Configuration","p":["Auto-update extensions (if enabled by the extension manifest)","Cohee/distilbert-base-uncased-go-emotions-onnx","Cohee/jina-embeddings-v2-base-en","Default","Description","Enable automatic model downloads","Enable UI extensions","extensions.autoUpdate","extensions.enabled","extensions.models.autoDownload","extensions.models.captioning","extensions.models.classification","extensions.models.embedding","extensions.models.speechToText","extensions.models.textToSpeech","HuggingFace model ID for classification","HuggingFace model ID for embeddings","HuggingFace model ID for image captioning","HuggingFace model ID for speech-to-text","HuggingFace model ID for text-to-speech","Permitted Values","Setting","true","true, false","Valid model ID","Xenova/speecht5_tts","Xenova/vit-gpt2-image-captioning","Xenova/whisper-small"]},{"l":"Server Plugins","p":["Setting","Description","Default","Permitted Values","enableServerPlugins","Enable server-side plugins","false","true, false","enableServerPluginsAutoUpdate","Attempt to automatically update server plugins on startup","true"]},{"l":"API Integration Settings"},{"l":"OpenAI Configuration","p":["Setting","Description","Default","Permitted Values","promptPlaceholder","Default message for empty prompts","[Start a new chat]","Any string","openai.randomizeUserId","Randomize user ID for API calls","false","true, false","openai.captionSystemPrompt","System message for caption completion"]},{"l":"MistralAI Configuration","p":["Setting","Description","Default","Permitted Values","mistral.enablePrefix","Enable reply prefilling. The prefix will be echoed in the response","false","true, false"]},{"l":"Ollama Configuration","p":["Setting","Description","Default","Permitted Values","ollama.keepAlive","Model keep-alive duration (seconds)","-1","-1(indefinite), 0(immediate unload), positive integer","ollama.batchSize","Controls the \"num_batch\" (batch size) parameter of the generation request","-1(model default), positive integer"]},{"l":"Claude Configuration","p":["-1","-1(disabled), 0 or positive integer","claude.cachingAtDepth","claude.enableSystemPromptCache","claude.extendedTTL","Default","Description","Enable message history caching","Enable system prompt caching","false","Permitted Values","See: Prompt Caching","Setting","true, false","Use 1h TTL instead of the default 5m. Note that this also increases the cost of the request.","Use with caution and only when the prompt prefix is static and doesn't change between requests. {{random}} macro, lorebooks, vectors, summaries, etc. will likely invalidate the cache and you'll just waste money on cache misses. Behavior may be unpredictable and no guarantees can or will be made."]},{"l":"Google AI Studio Configuration","p":["Setting","Description","Default","Permitted Values","gemini.apiVersion","API endpoint version","v1beta","v1beta, v1alpha"]},{"l":"DeepL Configuration","p":["Setting","Description","Default","Permitted Values","deepl.formality","Translation formality level","default, more, less, prefer_more, prefer_less"]}],[{"l":"Multi-user mode","p":["Multi-user mode allows several people to use one SillyTavern server. Each user has their own settings, extensions, and data. User accounts can also be password-protected.","User passwords provide basic privacy between users of a multi-user setup. They are not a security feature and should not be considered as such. All user data (including chat history, API keys, and other sensitive information) is stored in plain text on the server. It can be viewed and modified by anyone with access to the server's filesystem. Do not use SillyTavern on a public server or with untrusted users."]},{"l":"Configuration","p":["To enable and use the multi-user mode, edit the config.yaml file:","When the user account setting is disabled, a default-user fallback admin account is utilized for storing the user data.","When the discreet login setting is disabled, a list of active users is displayed on the login screen. If enabled, a user must enter their handle manually.","You can't delete the default-user account from the users list because it is used for serving the user data in case if enableUserAccounts is set to false. But you can disable it to hide it from the list and disallow logins."]},{"l":"User handles","p":["A handle is the unique identifier of a user. It can consist only of lowercase letters, numbers, and dashes.","A path to the user data directory assumes using the following pattern: %DATA_ROOT%/%USER_HANDLE%.","Examples of valid user handles:","default-user","juan555","flux-the-cat","cool-guy1337"]},{"l":"Roles","p":["Admin- can manage (create, delete, modify) other users. Can install extensions for all users.","User- can't manage other users. Can install extensions only for themselves.","Except for having admin panel access, both user roles are functionally identical and can use a full range of SillyTavern features without any restrictions. An implementation of user permissions is TBD.","All user accounts are created as regular users first, and then could be promoted to admins if needed."]},{"l":"Login screen","p":["There you can select a user account to use. Has two styles, depending on the enableDiscreetLogin config value.","The login screen is bypassed and not displayed when you have only one active user and it is not password protected."]},{"l":"User profile","p":["You can access an account self-management menu using an \"Account\" button under the \"User settings\" panel in the top menu bar.","Display name - used in the login screen, can be changed. Does not correlate with personas and is not visible for the AI APIs - you can still use as many personas as you want.","Profile picture - used in the login screen. You can either use a custom picture, the default persona picture (if set), or the last used persona otherwise.","Password - a lock icon reflects the account protection status (open lock = no password). A password can be set, changed, or removed using the \"Change Password\" button.","Settings Snapshots - access and review the backups of your settings.json file, with the ability to create or restore snapshots.","Download Backup - download an archive of your user data folder.","Reset Settings - reset factory default settings, while leaving other data (character, chats) intact."]},{"l":"Password recovery","p":["A password can be recovered from a login screen. You need access to the server console to get a one-time recovery code (consisting of 4 digits).","Alternatively, you can use a utility script in the SillyTavern server to reset a password by providing the user handle."]},{"l":"Content scaffolding","p":["To add custom content for users, you can use the content scaffolding feature. This feature allows you to define a set of files that will be copied to each user's data directory when the server starts up.","You must create an index.json file in the /default/scaffold directory for this feature to work. The syntax is the same as for default content. All file paths should be relative to the /default/scaffold directory, and you can organize files using subdirectories.","Scaffolded files are copied before default files, which means they will override any default files (presets/settings/etc.) that have the same file name.","Every user data directory has a content.log file that lists all files copied from the scaffold and default directories. Remove this file to force the server to sync the content again on the next restart."]},{"l":"Recognized content types","p":["'avatar'","'background'","'character'","'context'","'instruct'","'kobold_preset'","'moving_ui'","'novel_preset'","'openai_preset'","'quick_replies'","'reasoning'","'settings'","'sprites'","'sysprompt'","'textgen_preset'","'theme'","'workflow'","'world'","Background image","Character card","Character sprites","Chat Completion preset","ComfyUI workflow","Context Formatting template","Instruct Mode template","KoboldAI Classic preset","MovingUI preset","NovelAI preset","Persona avatar","Quick Replies set","Reasoning Formatting template","settings.json","System Prompt template","Text Completion preset","Type","UI theme","Value","World Info file"]},{"l":"Example (/default/scaffold/index.json)"}],[{"l":"Single Sign-On (SSO)","p":["SSO allows you to create users and secure many different pages using a login portal presented on sites you want to secure. While it is complex to setup, it is a good way to both learn SSO and secure your ST instance out on the internet more.","Authelia and Authentik are open-source SSO providers that can be used with SillyTavern."]},{"l":"Sign in with SSO","p":["If your SSO-provided username exactly matches the username of a SillyTavern user account, you can sign in to SillyTavern as that user by SSO.","To do this, enable autheliaAuth in config.yaml.","This augments or replaces the built-in password management component of a multi-user mode setup."]},{"l":"Replacing HTTP BA","p":["SSO can also replace HTTP Basic Authentication as an access control mechanism for remote connections.","This is recommended because SSO provides better security and functionality than HTTP BA.","To use an SSO provider in place of HTTP BA, enable securityOverride in config.yaml. Otherwise, SillyTavern will refuse to start."]}],[{"l":"Remote connections","p":["Most often this is for people who want to use SillyTavern on their mobile phones while their PC runs the ST server within the same WiFi network.","It is also the first step for allowing remote connections from outside the local network.","You should not use port forwarding to expose your ST server to the internet. Instead, use a VPN or a tunneling service like Cloudflare Zero Trust, ngrok, or Tailscale. See the VPN and Tunneling guide for more information.","NEVER HOST ANY INSTANCES TO THE OPEN INTERNET WITHOUT ENSURING PROPER SECURITY MEASURES FIRST.","WE ARE NOT RESPONSIBLE FOR ANY DAMAGE OR LOSSES IN CASES OF UNAUTHORIZED ACCESS DUE TO IMPROPER OR INADEQUATE SECURITY IMPLEMENTATION."]},{"l":"Allowing remote connections","p":["By default, the ST server only accepts connections from the machine that it's running on (localhost). To allow it to listen for connections from other devices, set the listen option in config.yaml to true.","All modifications to config.yaml in this document refer to the one in the SillyTavern root directory (/SillyTavern/config.yaml), not /SillyTavern/default/config.yaml.","When ST is listening for remote connections, you should see this message in the console:","and some explanation about what that means.","When ST is not listening for remote connections, you should see this message in the console:"]},{"l":"Access control configuration","p":["After enabling remote connection listening, you must configure at least one access control method. Otherwise, the server will not start."]},{"l":"Whitelist-Based access control","p":["To enable access control via a whitelist, edit the config.yaml file in the SillyTavern root directory (/SillyTavern/config.yaml):","Start SillyTavern at least once to generate the necessary configuration files.","Open /SillyTavern/config.yaml in a text editor.","Find the whitelist section and add the IP addresses you wish to allow:","List each IP address separately.","Ensure 127.0.0.1 is included, or you will be unable to connect from the host machine.","Supports individual IPs, CIDR masks (e.g., 10.0.0.0/24), and wildcard (*) ranges.","Save the config.yaml file.","Restart your SillyTavern server."]},{"l":"Example config.yaml whitelist configuration","p":["Allow any device on the local network:","If unsure about your local network's address range, use the whitelist above.","Allows two specific devices to connect:","Allows any device on the 192.168.0.* subnet to connect:","Allow network connections for all IPv4 devices:"]},{"l":"Disabling whitelist-based access control","p":["To disable access control via a whitelist:","Set whitelistMode to false in /SillyTavern/config.yaml.","Remove or rename whitelist.txt(if it exists) in the SillyTavern base installation folder.","Restart your SillyTavern server."]},{"l":"Not recommended: using whitelist.txt","p":["If whitelist.txt exists, it takes precedence over the whitelist settings in config.yaml.","However, since all other configurations are managed within config.yaml, and whitelist.txt may encounter permission issues or become locked, the system could silently revert to using the config.yaml whitelist.","Editing config.yaml directly is both simpler and more reliable.","If you still prefer using whitelist.txt:","Create a new text file named whitelist.txt in the SillyTavern base installation folder.","Open it in a text editor and add the allowed IP addresses.","Save the file and restart your SillyTavern server."]},{"l":"Example whitelist.txt configuration","p":["This allows any device on the local network to connect."]},{"l":"Access control by HTTP Basic Authentication","p":["HTTP Basic Authentication does not provide strong security.","There is no rate-limiting to prevent brute-force attacks. If this is a concern, it is recommended to use a reverse proxy with TLS and rate-limiting, and a dedicated authentication service.","The server will ask for username and password whenever a client connects via HTTP. This only works if the Remote connections (listen: true) are enabled.","To enable HTTP BA, Open config.yaml in the SillyTavern base directory and search for basicAuthMode Set basicAuthMode to true and set username and password. Note: config.yaml will only exist if ST has been executed before at least once.","Alternatively you can enable basic auth as follows:","In this perUserBasicAuth mode the basic auth's username and password will be the same as any valid multi user account that has a password. Additionally SillyTavern will login directly to that account. Ensure you have an account with a password prior to enabling perUserBasicAuth.","Save the file and restart SillyTavern if it was already running. You should be prompted for username and password when connecting to your ST. Both username and password are transmitted in plain text. If you are concerned about this, you can serve ST via HTTPS."]},{"l":"Connecting to your SillyTavern instance"},{"l":"Getting the IP address for the ST host machine","p":["After the whitelist has been setup, you'll need the IP of the ST-hosting device.","If the ST-hosting device is on the same wifi network, you will use the ST-host's internal wifi IP:","For Windows: windows button > type cmd.exe in the search bar > type ipconfig in the console, hit Enter > look for IPv4 listing.","If you (or someone else) wants to connect to your hosted ST while not being on the same network, you will need the public IP of your ST-hosting device.","While using the ST-hosting device, access this page and look for for IPv4. This is what you would use to connect from the remote device."]},{"l":"Connecting to the ST server","p":["Whatever IP you ended up with for your situation, you will put that IP address and port number into the remote device's web browser.","A typical address for an ST host on the same wifi network would look like:","http://192.168.0.5:8000","Use http:// NOT https://"]},{"l":"Connection logging","p":["New connections to the server are displayed in the console window and logged in the access.log file in the SillyTavern base directory.","A console message for a browser on the same machine as the server looks like:","A console message for a browser on a different machine on the same network as the server might look like:","If a connection is refused, the console message will look like:","access.log will contain the connection information, with timestamps, but not whether the connection was accepted or refused."]},{"l":"Troubleshooting","p":["Still unable to connect?","If the connection attempt appears in the console, but is forbidden, it is a whitelist issue.","If ST is listening for remote connections but the connection attempt does not appear in the console, it is a network issue.","If ST is not listening for remote connections, it is a reading issue."]},{"l":"Network issues","p":["On Windows, the application may be blocked by the application firewall. The quickest way to fix this is to uninstall and reinstall node.js, and when prompted by the firewall, allow it to access the network. Otherwise, you will need to manually allow the node.js application through the Windows application firewall.","On Windows 11, enable the Private Network profile type in Settings > Network and Internet > Ethernet. This is VERY important for Windows 11, otherwise, you would be unable to connect even with the aforementioned firewall rules.","On Linux, you may need to allow the port through the firewall. The command to do this is sudo ufw allow 8000. This will allow traffic on port 8000.","Do not modify the port forwarding settings on your router. This is not necessary for accessing ST within your local network, and can expose your server to the internet.","If you are trying to access your ST server from outside your local network, and it's not working, identify whether the problem is between the remote device and the tunnel/VPN endpoint, or between the tunnel endpoint on the server and the ST service. Otherwise you will spend a lot of time troubleshooting the wrong thing."]},{"l":"HTTPS"},{"l":"Start SillyTavern with TLS/SSL","p":["To encrypt traffic from and to your ST instance, start the server with the --ssl flag.","Example:","As per default, ST will search for your certificates inside the certs folder. If your files are located elsewhere, you can use the --keyPath and --certPath arguments.","The user you're running SillyTavern with requires read permissions on the certificate files."]},{"l":"How to get a certificate","p":["The simplest, quickest way to get a certificate is by using certbot."]}],[{"l":"VPNs and Tunneling","p":["VPNs and tunnels are a secure way to access your home network from anywhere in the world. This guide will show you how to use a VPN or a tunnel to access your SillyTavern instance from anywhere."]},{"l":"Methods","p":["Use a home-made VPN.","Several routers come with the ability to host a VPN server (primarily OpenVPN or WireGuard) in the router administration page. Refer to your router's manual to setup a VPN and add your devices to the VPN. Once connected, just go to the private IP you have set for SillyTavern and you can connect just fine. Easier for users and for Windows use.","Use Cloudflare Zero Trust.","Cloudflare Zero Trust is a free organizational feature in Cloudflare that allows you to add 50 users. This will proxy your traffic through Cloudflare and by adding your ST PC as a tunnel using cloudflared, you can connect to your ST instance as if you were home.","Do note that after making a tunnel, you will have to add a route to your router's private IP addresses and calculate IP CIDR values to have full local access on the go using Cloudflare Zero Trust.","Use a standalone Cloudflare or ngrok tunnel.","Similar to how AI backends can connect, you can also connect your ST instance via a Cloudflare Tunnel and open the Cloudflare Tunnel page. However, you will have to copy and paste each new link generated by Cloudflare/NGROK each time you want to use ST on-the-go.","Use Tailscale.","Tailscale is a VPN provider enabling a secure remote connection to your PC."]},{"l":"Tailscale setup","p":["Tailscale is a VPN provider enabling a secure remote connection to your PC. An open-source implementation of the Tailscale server exists and you can also host the server using Headscale, but that is outside of the scope of this tutorial."]},{"l":"1. Creating an account","p":["Go to Tailscale's website and create a new account.","NOTE: For everyday use by a single person Tailscale will be permanently free. If you fear hidden costs, just don't add any payment options."]},{"l":"2. Setting up clients","p":["Go to Tailscale's download page and download the client/app on the device you have SillyTavern running on and on the device you want to use from a remote location.","Log in on both devices with your previously created account.","Go to Tailscale's admin page and approve both devices.","Take note of both of the connected devices' names."]},{"l":"3. Adding your devices to the whitelist","p":["Add your connecting device's machine name (the one you want to use SillyTavern with) to SillyTavern's whitelist by following Managing whitelisted IPs."]},{"l":"4. Connecting","p":["Now whenever you want to use SillyTavern from anywhere all you have to do is:","Have Tailscale turned on on both the PC hosting SillyTavern and your device that wants to use it remotely.","Open a browser on the device that wants to connect and go to http://machine name of PC running st:8000/"]},{"l":"5. Sharing SillyTavern instance with a friend (optional)","p":["Tell your friend to create their own Tailscale account and download the client on their device.","Go to Tailscale's admin page.","Hover over the three-dot button on your PC hosting SillyTavern and press \"Share...\" or press the three-dot button and press \"Sharing settings...\".","Uncheck \"Allow use as an exit node\" (unless you want your friend to be able to route all their internet traffic through your PC).","Either send the link as an email or change the tab to \"Copy share link\", press the big blue button with the same text, and send it to your friend in any other way.","After clicking your share link, your friend will see your PC pop up in their Tailscale network.","Send your friend the same link you use to access SillyTavern as explained in the last step.","NOTE: This will give your friend full access to any services running locally on your PC like SillyTavern, automatic1111, etc. Only do this if you truly trust your friend."]}],[{"l":"Reverse proxying","p":["This section does not refer to OpenAI/Claude reverse proxies. This refers exclusively to HTTP/HTTPS Reverse Proxies.","Is Termux confusing to setup? Are you tired of updating and installing ST on every device you have? Want organization of your chats and characters? Well you are in luck. This guide will hopefully cover how to host SillyTavern on your PC where you can connect from anywhere and chat to your bots on the same PC you use to run AI models!","This guide is not meant for beginners. This will be very technical."]},{"l":"Fair Warning","p":["This guide is not for Windows users. We recommend using a Linux VM or WSL2 to follow this guide.","You must have prior knowledge of","Linux console commands","DNS Records","Public IP addresses","Docker","You will have to buy a domain for yourself and configure a CNAME for your SillyTavern page. We suggest adding or buying the domain on Cloudflare as this guide will cover how to do this with Cloudflare itself."]},{"l":"Installation"},{"l":"Linux (Bare-Metal SillyTavern)","p":["A","Auto","Before enabling perUserBasicAuth ensure you have a valid multi-user setup with working passwords.","cd into appdata/traefik and using nano or a similar editor, create a file name config.yml and paste the following. Replace PRIVATE_IP with the private IP you obtained, and silly.DOMAIN.com with the name of your subdomain and domain page, then save the file.","cd into secrets/cloudflare and using nano or a similar editor, create a file named CF_DNS_API_KEY and paste your key inside.","Click on Continue to summary followed by Create Token.","Click on Create Token then Create Custom Token and make sure you give your token the following permissions.","CNAME","Copy the Token Key given to you and store it somewhere secure.","Create a acme.json file using touch and set the permissions of it to 600.","Create another record of the CNAME type, then click Save. Here is an example on how it should appear on the Cloudflare dashboard.","Do not install Docker Desktop.","DOMAIN.com","Enjoy! :D","Execute chown, replacing with your Linux username to set the permissions in the docker folder.","Follow the steps in Manage Docker as a non-root user in the Docker post-installation guide here.","For Linux, we will reverse proxying SillyTavern through Traefik. There are other options such as NGINX or Caddy, but for this guide, we will use Traefik as it is what we use ourselves.","Get the private IP of your computer using ifconfig or from your router.","Get your public IP of your modem by Googling what's my ip.","Go to your root folder in Linux and make a new folder named docker.","Go to your SillyTavern folder and edit config.yaml to enable listen mode and basic authentication, whilst disabling whitelistMode.","If nothing happens after several minutes, check the container logs for Traefik for any possible errors.","Install Docker by following the Docker installation guide here.","It is recommended to set your private IP to a Static IP. Refer to your router's manual or Google to configure static IPs.","Login to Cloudflare and click on your Domain, followed by Get your API token.","Make a folder inside the docker folder, that being appdata and inside appdata being traefik. Enter the appdata/traefik folder afterwards.","Make a folder inside the docker folder, that being secrets and inside secrets being cloudflare.","Make sure to change the default username and password to something strong that you can remember.","Most residential/home networks use Dynamic IPs which are renewed after months of use. If you have a dynamic IP, use either DDClient or remember to check and change your public IP ever so often on the Cloudflare Dashboard.","N/A","Name (required)","Or to use the SillyTavern accounts as usernames and passwords:","Proxied","Proxy Status","PUBLIC_IP","Return back to the docker folder.","Return to your domain page and go to DNS. Create a new record using Add record and create two A type keys like the ones below. Replace PUBLIC_IP with your own public IP, then click Save.","Run Docker Compose using the following commands:","silly","Target (required)","TTL","Type","Using nano or a similar editor, create a file name docker-compose.yaml and paste the following. Save the file afterwards.","Using nano or a similar editor, create a file name traefik.yml and paste the following. Replace the template email with your own, then save the file.","Wait a few minutes, then open your domain page you made for ST. At the end of it, you should be able to open SillyTavern from anywhere you go just with one URL and one account.","www","Zone -> DNS -> Edit","Zone -> Zone -> Read"]},{"l":"Linux (Docker SillyTavern)","p":["A","Auto","cd into secrets/cloudflare and using nano or a similar editor, create a file named CF_DNS_API_KEY and paste your key inside.","Click on Continue to summary followed by Create Token.","Click on Create Token then Create Custom Token and make sure you give your token the following permissions.","CNAME","Copy the Token Key given to you and store it somewhere secure.","Create another record of the CNAME type, then click Save. Here is an example on how it should appear on the Cloudflare dashboard.","Do note that we run SillyTavern on bare-metal over Docker. This is a rough idea of what we would do on Docker with other Docker containers we tend to use with ST.","DOMAIN.com","Enjoy! :D","Follow Steps 1-11 of Linux (Bare-Metal SillyTavern).","Git clone SillyTavern into the docker folder.","Go to your SillyTavern folder ( appdata/sillytavern/config) and edit config.yaml to enable listen mode and basic authentication, whilst disabling whitelistMode.","If nothing happens after several minutes, check the container logs for Traefik for any possible errors.","Login to Cloudflare and click on your Domain, followed by Get your API token.","Make sure to change the default username and password to something strong that you can remember.","N/A","Name (required)","Proxied","Proxy Status","PUBLIC_IP","Return to your domain page and go to DNS. Create a new record using Add record and create two A type keys like the ones below. Replace PUBLIC_IP with your own public IP and the example domain with your domain, then click Save.","Run Docker Compose using the following commands:","silly","Start the SillyTavern Docker container again.","Stop the SillyTavern Docker container.","Target (required)","TTL","Type","Using nano or a similar editor, create a file name docker-compose.yaml and paste the following. Replace silly.DOMAIN.com with the subdomain you added above, the save the file afterwards.","Wait a few minutes, then open your domain page you made for ST. At the end of it, you should be able to open SillyTavern from anywhere you go just with one URL and one account.","www","Zone -> DNS -> Edit","Zone -> Zone -> Read"]},{"l":"Updating your Cloudflare DNS","p":["DDClient allows you to sync your public IP to Cloudflare in the situation that your ISP changes it, allowing you to continue accessing your ST instance as if nothing ever happened."]}],[{"l":"License and credits","p":["This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.","See the GNU Affero General Public License for more details.","Original TavernAI 1.2.8 by Humi: MIT License"]},{"l":"Pre-v1.9.0 Contributors","p":["The git commit history was squashed to the state of release 1.9.0.","Unfortunately, losing commit history also means losing the code contribution history. If you contributed to the SillyTavern development and want to see yourself credited in the README file and Docs website, please get in touch with us!"]},{"l":"Documentation Contributors","p":["Click the image below to see the full list of SillyTavern documentation contributors.","Contributors"]}]]